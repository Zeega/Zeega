/*!
 * Popcorn.sequence
 *
 * Copyright 2011, Rick Waldron
 * Licensed under MIT license.
 *
 */
function addGlobal(layerId,event,elementId){LayerGlobals[layerId]||(LayerGlobals[layerId]={}),eval("LayerGlobals[layerId]."+event+'= function(data){$("#'+elementId+'").trigger("'+event+'",data);}')}function getHost(){return window.location.protocol+"//"+window.location.host}function getBaseURL(){var a=window.location.pathname.split("/"),b=a.indexOf("/web/"),c=window.location.pathname.substring(0,b+4);return c}function convertTime(a){var b=Math.floor(a/60),c=Math.floor(a%60);return c<10&&(c="0"+c),b+":"+c}function deconvertTime(a,b){return 60*a+parseInt(b)}function getMinutes(a){return Math.floor(parseInt(a)/60)}function getSeconds(a){var b=Math.floor(a%60*10)/10;return b<10&&(b="0"+b),b}function isInt(a){var b=parseInt(a);return isNaN(b)?!1:a==b&&a.toString()==b.toString()}function isPercent(a){return isInt(a)&&parseInt(a)<=100}function deepCopy(a,b){var b=b||{};for(var c in a)typeof a[c]=="object"?(b[c]=a[c].constructor===Array?[]:{},deepCopy(a[c],b[c])):b[c]=a[c];return b}function rgbToHex(a,b,c){return toHex(a)+toHex(b)+toHex(c)}function toHex(a){return a=parseInt(a,10),isNaN(a)?"00":(a=Math.max(0,Math.min(a,255)),"0123456789ABCDEF".charAt((a-a%16)/16)+"0123456789ABCDEF".charAt(a%16))}function convertTime(a,b){var c=Math.floor(a/60);if(b&&!1)var d=Math.floor(a%600)/10;else var d=Math.floor(a%60);return d<10&&(d="0"+d),c+":"+d}(function(){function A(a,b,c){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual&&w.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&w.isFunction(b.isEqual))return b.isEqual(a);var d=i.call(a);if(d!=i.call(b))return!1;switch(d){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var e=c.length;while(e--)if(c[e]==a)return!0;c.push(a);var f=0,g=!0;if(d=="[object Array]"){f=a.length,g=f==b.length;if(g)while(f--)if(!(g=f in a==f in b&&A(a[f],b[f],c)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var h in a)if(w.has(a,h)){f++;if(!(g=w.has(b,h)&&A(a[h],b[h],c)))break}if(g){for(h in b)if(w.has(b,h)&&!(f--))break;g=!f}}return c.pop(),g}var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.slice,h=d.unshift,i=e.toString,j=e.hasOwnProperty,k=d.forEach,l=d.map,m=d.reduce,n=d.reduceRight,o=d.filter,p=d.every,q=d.some,r=d.indexOf,s=d.lastIndexOf,t=Array.isArray,u=Object.keys,v=f.bind,w=function(a){return new E(a)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=w),exports._=w):a._=w,w.VERSION="1.3.1";var x=w.each=w.forEach=function(a,b,d){if(a==null)return;if(k&&a.forEach===k)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e,a)===c)return}else for(var g in a)if(w.has(a,g)&&b.call(d,a[g],g,a)===c)return};w.map=w.collect=function(a,b,c){var d=[];return a==null?d:l&&a.map===l?a.map(b,c):(x(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),a.length===+a.length&&(d.length=a.length),d)},w.reduce=w.foldl=w.inject=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(m&&a.reduce===m)return d&&(b=w.bind(b,d)),e?a.reduce(b,c):a.reduce(b);x(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},w.reduceRight=w.foldr=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduceRight===n)return d&&(b=w.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=w.toArray(a).reverse();return d&&!e&&(b=w.bind(b,d)),e?w.reduce(f,b,c,d):w.reduce(f,b)},w.find=w.detect=function(a,b,c){var d;return y(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},w.filter=w.select=function(a,b,c){var d=[];return a==null?d:o&&a.filter===o?a.filter(b,c):(x(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},w.reject=function(a,b,c){var d=[];return a==null?d:(x(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},w.every=w.all=function(a,b,d){var e=!0;return a==null?e:p&&a.every===p?a.every(b,d):(x(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c}),e)};var y=w.some=w.any=function(a,b,d){b||(b=w.identity);var e=!1;return a==null?e:q&&a.some===q?a.some(b,d):(x(a,function(a,f,g){if(e||(e=b.call(d,a,f,g)))return c}),!!e)};w.include=w.contains=function(a,b){var c=!1;return a==null?c:r&&a.indexOf===r?a.indexOf(b)!=-1:(c=y(a,function(a){return a===b}),c)},w.invoke=function(a,b){var c=g.call(arguments,2);return w.map(a,function(a){return(w.isFunction(b)?b||a:a[b]).apply(a,c)})},w.pluck=function(a,b){return w.map(a,function(a){return a[b]})},w.max=function(a,b,c){if(!b&&w.isArray(a))return Math.max.apply(Math,a);if(!b&&w.isEmpty(a))return-Infinity;var d={computed:-Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},w.min=function(a,b,c){if(!b&&w.isArray(a))return Math.min.apply(Math,a);if(!b&&w.isEmpty(a))return Infinity;var d={computed:Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},w.shuffle=function(a){var b=[],c;return x(a,function(a,d,e){d==0?b[0]=a:(c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a)}),b},w.sortBy=function(a,b,c){return w.pluck(w.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},w.groupBy=function(a,b){var c={},d=w.isFunction(b)?b:function(a){return a[b]};return x(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},w.sortedIndex=function(a,b,c){c||(c=w.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},w.toArray=function(a){return a?a.toArray?a.toArray():w.isArray(a)?g.call(a):w.isArguments(a)?g.call(a):w.values(a):[]},w.size=function(a){return w.toArray(a).length},w.first=w.head=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},w.initial=function(a,b,c){return g.call(a,0,a.length-(b==null||c?1:b))},w.last=function(a,b,c){return b!=null&&!c?g.call(a,Math.max(a.length-b,0)):a[a.length-1]},w.rest=w.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},w.compact=function(a){return w.filter(a,function(a){return!!a})},w.flatten=function(a,b){return w.reduce(a,function(a,c){return w.isArray(c)?a.concat(b?c:w.flatten(c)):(a[a.length]=c,a)},[])},w.without=function(a){return w.difference(a,g.call(arguments,1))},w.uniq=w.unique=function(a,b,c){var d=c?w.map(a,c):a,e=[];return w.reduce(d,function(c,d,f){if(0==f||(b===!0?w.last(c)!=d:!w.include(c,d)))c[c.length]=d,e[e.length]=a[f];return c},[]),e},w.union=function(){return w.uniq(w.flatten(arguments,!0))},w.intersection=w.intersect=function(a){var b=g.call(arguments,1);return w.filter(w.uniq(a),function(a){return w.every(b,function(b){return w.indexOf(b,a)>=0})})},w.difference=function(a){var b=w.flatten(g.call(arguments,1));return w.filter(a,function(a){return!w.include(b,a)})},w.zip=function(){var a=g.call(arguments),b=w.max(w.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=w.pluck(a,""+d);return c},w.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=w.sortedIndex(a,b),a[d]===b?d:-1;if(r&&a.indexOf===r)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===b)return d;return-1},w.lastIndexOf=function(a,b){if(a==null)return-1;if(s&&a.lastIndexOf===s)return a.lastIndexOf(b);var c=a.length;while(c--)if(c in a&&a[c]===b)return c;return-1},w.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f};var z=function(){};w.bind=function(b,c){var d,e;if(b.bind===v&&v)return v.apply(b,g.call(arguments,1));if(!w.isFunction(b))throw new TypeError;return e=g.call(arguments,2),d=function(){if(this instanceof d){z.prototype=b.prototype;var a=new z,f=b.apply(a,e.concat(g.call(arguments)));return Object(f)===f?f:a}return b.apply(c,e.concat(g.call(arguments)))}},w.bindAll=function(a){var b=g.call(arguments,1);return b.length==0&&(b=w.functions(a)),x(b,function(b){a[b]=w.bind(a[b],a)}),a},w.memoize=function(a,b){var c={};return b||(b=w.identity),function(){var d=b.apply(this,arguments);return w.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},w.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},w.defer=function(a){return w.delay.apply(w,[a,1].concat(g.call(arguments,1)))},w.throttle=function(a,b){var c,d,e,f,g,h=w.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var i=function(){e=null,g&&a.apply(c,d),h()};e||(e=setTimeout(i,b)),f?g=!0:a.apply(c,d),h(),f=!0}},w.debounce=function(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}},w.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},w.wrap=function(a,b){return function(){var c=[a].concat(g.call(arguments,0));return b.apply(this,c)}},w.compose=function(){var a=arguments;return function(){var b=arguments;for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},w.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}},w.keys=u||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)w.has(a,c)&&(b[b.length]=c);return b},w.values=function(a){return w.map(a,w.identity)},w.functions=w.methods=function(a){var b=[];for(var c in a)w.isFunction(a[c])&&b.push(c);return b.sort()},w.extend=function(a){return x(g.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},w.defaults=function(a){return x(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},w.clone=function(a){return w.isObject(a)?w.isArray(a)?a.slice():w.extend({},a):a},w.tap=function(a,b){return b(a),a},w.isEqual=function(a,b){return A(a,b,[])},w.isEmpty=function(a){if(w.isArray(a)||w.isString(a))return a.length===0;for(var b in a)if(w.has(a,b))return!1;return!0},w.isElement=function(a){return!!a&&a.nodeType==1},w.isArray=t||function(a){return i.call(a)=="[object Array]"},w.isObject=function(a){return a===Object(a)},w.isArguments=function(a){return i.call(a)=="[object Arguments]"},w.isArguments(arguments)||(w.isArguments=function(a){return!!a&&!!w.has(a,"callee")}),w.isFunction=function(a){return i.call(a)=="[object Function]"},w.isString=function(a){return i.call(a)=="[object String]"},w.isNumber=function(a){return i.call(a)=="[object Number]"},w.isNaN=function(a){return a!==a},w.isBoolean=function(a){return a===!0||a===!1||i.call(a)=="[object Boolean]"},w.isDate=function(a){return i.call(a)=="[object Date]"},w.isRegExp=function(a){return i.call(a)=="[object RegExp]"},w.isNull=function(a){return a===null},w.isUndefined=function(a){return a===void 0},w.has=function(a,b){return j.call(a,b)},w.noConflict=function(){return a._=b,this},w.identity=function(a){return a},w.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},w.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},w.mixin=function(a){x(w.functions(a),function(b){G(b,w[b]=a[b])})};var B=0;w.uniqueId=function(a){var b=B++;return a?a+b:b},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/.^/,D=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};w.template=function(a,b){var c=w.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape||C,function(a,b){return"',_.escape("+D(b)+"),'"}).replace(c.interpolate||C,function(a,b){return"',"+D(b)+",'"}).replace(c.evaluate||C,function(a,b){return"');"+D(b).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);return b?e(b,w):function(a){return e.call(this,a,w)}},w.chain=function(a){return w(a).chain()};var E=function(a){this._wrapped=a};w.prototype=E.prototype;var F=function(a,b){return b?w(a).chain():a},G=function(a,b){E.prototype[a]=function(){var a=g.call(arguments);return h.call(a,this._wrapped),F(b.apply(w,a),this._chain)}};w.mixin(w),x(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];E.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;return(a=="shift"||a=="splice")&&d===0&&delete c[0],F(c,this._chain)}}),x(["concat","join","slice"],function(a){var b=d[a];E.prototype[a]=function(){return F(b.apply(this._wrapped,arguments),this._chain)}}),E.prototype.chain=function(){return this._chain=!0,this},E.prototype.value=function(){return this._wrapped}}).call(this),define("web/js/lib/underscore",function(){}),function(){var a=this,b=a.Backbone,c=Array.prototype.slice,d=Array.prototype.splice,e;typeof exports!="undefined"?e=exports:e=a.Backbone={},e.VERSION="0.9.1";var f=a._;!f&&typeof require!="undefined"&&(f=require("underscore"));var g=a.jQuery||a.Zepto||a.ender;e.setDomLibrary=function(a){g=a},e.noConflict=function(){return a.Backbone=b,this},e.emulateHTTP=!1,e.emulateJSON=!1,e.Events={on:function(a,b,c){var d;a=a.split(/\s+/);var e=this._callbacks||(this._callbacks={});while(d=a.shift()){var f=e[d]||(e[d]={}),g=f.tail||(f.tail=f.next={});g.callback=b,g.context=c,f.tail=g.next={}}return this},off:function(a,b,c){var d,e,f;if(!a)delete this._callbacks;else if(e=this._callbacks){a=a.split(/\s+/);while(d=a.shift()){f=e[d],delete e[d];if(!b||!f)continue;while((f=f.next)&&f.next){if(f.callback===b&&(!c||f.context===c))continue;this.on(d,f.callback,f.context)}}}return this},trigger:function(a){var b,d,e,f,g,h,i;if(!(e=this._callbacks))return this;h=e.all,(a=a.split(/\s+/)).push(null);while(b=a.shift()){h&&a.push({next:h.next,tail:h.tail,event:b});if(!(d=e[b]))continue;a.push({next:d.next,tail:d.tail})}i=c.call(arguments,1);while(d=a.pop()){f=d.tail,g=d.event?[d.event].concat(i):i;while((d=d.next)!==f)d.callback.apply(d.context||this,g)}return this}},e.Events.bind=e.Events.on,e.Events.unbind=e.Events.off,e.Model=function(a,b){var c;a||(a={}),b&&b.parse&&(a=this.parse(a));if(c=u(this,"defaults"))a=f.extend({},c,a);b&&b.collection&&(this.collection=b.collection),this.attributes={},this._escapedAttributes={},this.cid=f.uniqueId("c");if(!this.set(a,{silent:!0}))throw new Error("Can't create an invalid model");delete this._changed,this._previousAttributes=f.clone(this.attributes),this.initialize.apply(this,arguments)},f.extend(e.Model.prototype,e.Events,{idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;var c=this.attributes[a];return this._escapedAttributes[a]=f.escape(c==null?"":""+c)},has:function(a){return this.attributes[a]!=null},set:function(a,b,c){var d,g,h;f.isObject(a)||a==null?(d=a,c=b):(d={},d[a]=b),c||(c={});if(!d)return this;d instanceof e.Model&&(d=d.attributes);if(c.unset)for(g in d)d[g]=void 0;if(!this._validate(d,c))return!1;this.idAttribute in d&&(this.id=d[this.idAttribute]);var i=this.attributes,j=this._escapedAttributes,k=this._previousAttributes||{},l=this._setting;this._changed||(this._changed={}),this._setting=!0;for(g in d){h=d[g],f.isEqual(i[g],h)||delete j[g],c.unset?delete i[g]:i[g]=h,this._changing&&!f.isEqual(this._changed[g],h)&&(this.trigger("change:"+g,this,h,c),this._moreChanges=!0),delete this._changed[g];if(!f.isEqual(k[g],h)||f.has(i,g)!=f.has(k,g))this._changed[g]=h}return l||(!c.silent&&this.hasChanged()&&this.change(c),this._setting=!1),this},unset:function(a,b){return(b||(b={})).unset=!0,this.set(a,null,b)},clear:function(a){return(a||(a={})).unset=!0,this.set(f.clone(this.attributes),a)},fetch:function(a){a=a?f.clone(a):{};var b=this,c=a.success;return a.success=function(d,e,f){if(!b.set(b.parse(d,f),a))return!1;c&&c(b,d)},a.error=e.wrapError(a.error,b,a),(this.sync||e.sync).call(this,"read",this,a)},save:function(a,b,c){var d,g;f.isObject(a)||a==null?(d=a,c=b):(d={},d[a]=b),c=c?f.clone(c):{},c.wait&&(g=f.clone(this.attributes));var h=f.extend({},c,{silent:!0});if(d&&!this.set(d,c.wait?h:c))return!1;var i=this,j=c.success;c.success=function(a,b,e){var g=i.parse(a,e);c.wait&&(g=f.extend(d||{},g));if(!i.set(g,c))return!1;j?j(i,a):i.trigger("sync",i,a,c)},c.error=e.wrapError(c.error,i,c);var k=this.isNew()?"create":"update",l=(this.sync||e.sync).call(this,k,this,c);return c.wait&&this.set(g,h),l},destroy:function(a){a=a?f.clone(a):{};var b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(this.isNew())return d();a.success=function(e){a.wait&&d(),c?c(b,e):b.trigger("sync",b,e,a)},a.error=e.wrapError(a.error,b,a);var g=(this.sync||e.sync).call(this,"delete",this,a);return a.wait||d(),g},url:function(){var a=u(this.collection,"url")||u(this,"urlRoot")||v();return this.isNew()?a:a+(a.charAt(a.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(a){if(this._changing||!this.hasChanged())return this;this._changing=!0,this._moreChanges=!0;for(var b in this._changed)this.trigger("change:"+b,this,this._changed[b],a);while(this._moreChanges)this._moreChanges=!1,this.trigger("change",this,a);return this._previousAttributes=f.clone(this.attributes),delete this._changed,this._changing=!1,this},hasChanged:function(a){return arguments.length?this._changed&&f.has(this._changed,a):!f.isEmpty(this._changed)},changedAttributes:function(a){if(!a)return this.hasChanged()?f.clone(this._changed):!1;var b,c=!1,d=this._previousAttributes;for(var e in a){if(f.isEqual(d[e],b=a[e]))continue;(c||(c={}))[e]=b}return c},previous:function(a){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return f.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(a,b){if(b.silent||!this.validate)return!0;a=f.extend({},this.attributes,a);var c=this.validate(a,b);return c?(b&&b.error?b.error(this,c,b):this.trigger("error",this,c,b),!1):!0}}),e.Collection=function(a,b){b||(b={}),b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,{silent:!0,parse:b.parse})},f.extend(e.Collection.prototype,e.Events,{model:e.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,b){var c,e,g,h,i,j,k={},l={};b||(b={}),a=f.isArray(a)?a.slice():[a];for(c=0,g=a.length;c<g;c++){if(!(h=a[c]=this._prepareModel(a[c],b)))throw new Error("Can't add an invalid model to a collection");if(k[i=h.cid]||this._byCid[i]||(j=h.id)!=null&&(l[j]||this._byId[j]))throw new Error("Can't add the same model to a collection twice");k[i]=l[j]=h}for(c=0;c<g;c++)(h=a[c]).on("all",this._onModelEvent,this),this._byCid[h.cid]=h,h.id!=null&&(this._byId[h.id]=h);this.length+=g,e=b.at!=null?b.at:this.models.length,d.apply(this.models,[e,0].concat(a)),this.comparator&&this.sort({silent:!0});if(b.silent)return this;for(c=0,g=this.models.length;c<g;c++){if(!k[(h=this.models[c]).cid])continue;b.index=c,h.trigger("add",h,this,b)}return this},remove:function(a,b){var c,d,e,g;b||(b={}),a=f.isArray(a)?a.slice():[a];for(c=0,d=a.length;c<d;c++){g=this.getByCid(a[c])||this.get(a[c]);if(!g)continue;delete this._byId[g.id],delete this._byCid[g.cid],e=this.indexOf(g),this.models.splice(e,1),this.length--,b.silent||(b.index=e,g.trigger("remove",g,this,b)),this._removeReference(g)}return this},get:function(a){return a==null?null:this._byId[a.id!=null?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var b=f.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(b):this.models.sort(b),a.silent||this.trigger("reset",this,a),this},pluck:function(a){return f.map(this.models,function(b){return b.get(a)})},reset:function(a,b){a||(a=[]),b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);return this._reset(),this.add(a,{silent:!0,parse:b.parse}),b.silent||this.trigger("reset",this,b),this},fetch:function(a){a=a?f.clone(a):{},a.parse===undefined&&(a.parse=!0);var b=this,c=a.success;return a.success=function(d,e,f){b[a.add?"add":"reset"](b.parse(d,f),a),c&&c(b,d)},a.error=e.wrapError(a.error,b,a),(this.sync||e.sync).call(this,"read",this,a)},create:function(a,b){var c=this;b=b?f.clone(b):{},a=this._prepareModel(a,b);if(!a)return!1;b.wait||c.add(a,b);var d=b.success;return b.success=function(e,f,g){b.wait&&c.add(e,b),d?d(e,f):e.trigger("sync",a,f,b)},a.save(null,b),a},parse:function(a,b){return a},chain:function(){return f(this.models).chain()},_reset:function(a){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(a,b){if(a instanceof e.Model)a.collection||(a.collection=this);else{var c=a;b.collection=this,a=new this.model(c,b),a._validate(a.attributes,b)||(a=!1)}return a},_removeReference:function(a){this==a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){if((a=="add"||a=="remove")&&c!=this)return;a=="destroy"&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments)}});var h=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];f.each(h,function(a){e.Collection.prototype[a]=function(){return f[a].apply(f,[this.models].concat(f.toArray(arguments)))}}),e.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};var i=/:\w+/g,j=/\*\w+/g,k=/[-[\]{}()+?.,\\^$|#\s]/g;f.extend(e.Router.prototype,e.Events,{initialize:function(){},route:function(a,b,c){return e.history||(e.history=new e.History),f.isRegExp(a)||(a=this._routeToRegExp(a)),c||(c=this[b]),e.history.route(a,f.bind(function(d){var f=this._extractParameters(a,d);c&&c.apply(this,f),this.trigger.apply(this,["route:"+b].concat(f)),e.history.trigger("route",this,b,f)},this)),this},navigate:function(a,b){e.history.navigate(a,b)},_bindRoutes:function(){if(!this.routes)return;var a=[];for(var b in this.routes)a.unshift([b,this.routes[b]]);for(var c=0,d=a.length;c<d;c++)this.route(a[c][0],a[c][1],this[a[c][1]])},_routeToRegExp:function(a){return a=a.replace(k,"\\$&").replace(i,"([^/]+)").replace(j,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}}),e.History=function(){this.handlers=[],f.bindAll(this,"checkUrl")};var l=/^[#\/]/,m=/msie [\w.]+/,n=!1;f.extend(e.History.prototype,e.Events,{interval:50,getFragment:function(a,b){if(a==null)if(this._hasPushState||b){a=window.location.pathname;var c=window.location.search;c&&(a+=c)}else a=window.location.hash;return a=decodeURIComponent(a),a.indexOf(this.options.root)||(a=a.substr(this.options.root.length)),a.replace(l,"")},start:function(a){if(n)throw new Error("Backbone.history has already been started");this.options=f.extend({},{root:"/"},this.options,a),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var b=this.getFragment(),c=document.documentMode,d=m.exec(navigator.userAgent.toLowerCase())&&(!c||c<=7);d&&(this.iframe=g('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(b)),this._hasPushState?g(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!d?g(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=b,n=!0;var e=window.location,h=e.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!h)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&h&&e.hash&&(this.fragment=e.hash.replace(l,""),window.history.replaceState({},document.title,e.protocol+"//"+e.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){g(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),n=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();b==this.fragment&&this.iframe&&(b=this.getFragment(this.iframe.location.hash));if(b==this.fragment||b==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(b),this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(a){var b=this.fragment=this.getFragment(a),c=f.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0});return c},navigate:function(a,b){if(!n)return!1;if(!b||b===!0)b={trigger:b};var c=(a||"").replace(l,"");if(this.fragment==c||this.fragment==decodeURIComponent(c))return;this._hasPushState?(c.indexOf(this.options.root)!=0&&(c=this.options.root+c),this.fragment=c,window.history[b.replace?"replaceState":"pushState"]({},document.title,c)):this._wantsHashChange?(this.fragment=c,this._updateHash(window.location,c,b.replace),this.iframe&&c!=this.getFragment(this.iframe.location.hash)&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,c,b.replace))):window.location.assign(this.options.root+a),b.trigger&&this.loadUrl(a)},_updateHash:function(a,b,c){c?a.replace(a.toString().replace(/(javascript:|#).*$/,"")+"#"+b):a.hash=b}}),e.View=function(a){this.cid=f.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()};var o=/^(\S+)\s*(.*)$/,p=["model","collection","el","id","attributes","className","tagName"];f.extend(e.View.prototype,e.Events,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(a,b,c){var d=document.createElement(a);return b&&g(d).attr(b),c&&g(d).html(c),d},setElement:function(a,b){return this.$el=g(a),this.el=this.$el[0],b!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=u(this,"events")))return;this.undelegateEvents();for(var b in a){var c=a[b];f.isFunction(c)||(c=this[a[b]]);if(!c)throw new Error('Event "'+a[b]+'" does not exist');var d=b.match(o),e=d[1],g=d[2];c=f.bind(c,this),e+=".delegateEvents"+this.cid,g===""?this.$el.bind(e,c):this.$el.delegate(g,e,c)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=f.extend({},this.options,a));for(var b=0,c=p.length;b<c;b++){var d=p[b];a[d]&&(this[d]=a[d])}this.options=a},_ensureElement:function(){if(!this.el){var a=u(this,"attributes")||{};this.id&&(a.id=this.id),this.className&&(a["class"]=this.className),this.setElement(this.make(this.tagName,a),!1)}else this.setElement(this.el,!1)}});var q=function(a,b){var c=t(this,a,b);return c.extend=this.extend,c};e.Model.extend=e.Collection.extend=e.Router.extend=e.View.extend=q;var r={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};e.sync=function(a,b,c){var d=r[a],h={type:d,dataType:"json"};return c.url||(h.url=u(b,"url")||v()),!c.data&&b&&(a=="create"||a=="update")&&(h.contentType="application/json",h.data=JSON.stringify(b.toJSON())),e.emulateJSON&&(h.contentType="application/x-www-form-urlencoded",h.data=h.data?{model:h.data}:{}),e.emulateHTTP&&(d==="PUT"||d==="DELETE")&&(e.emulateJSON&&(h.data._method=d),h.type="POST",h.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",d)}),h.type!=="GET"&&!e.emulateJSON&&(h.processData=!1),g.ajax(f.extend(h,c))},e.wrapError=function(a,b,c){return function(d,e){e=d===b?e:d,a?a(b,e,c):b.trigger("error",b,e,c)}};var s=function(){},t=function(a,b,c){var d;return b&&b.hasOwnProperty("constructor")?d=b.constructor:d=function(){a.apply(this,arguments)},f.extend(d,a),s.prototype=a.prototype,d.prototype=new s,b&&f.extend(d.prototype,b),c&&f.extend(d,c),d.prototype.constructor=d,d.__super__=a.prototype,d},u=function(a,b){return!a||!a[b]?null:f.isFunction(a[b])?a[b]():a[b]},v=function(){throw new Error('A "url" property or function must be specified')}}.call(this),define("web/js/lib/backbone",function(){}),function(a){var b={VERSION:"0.2",ROOT_URL:function(){for(var a=document.getElementsByTagName("script"),b=/^(.*\/)leaflet-?([\w-]*)\.js.*$/,c=0,d=a.length;c<d;c++){var e=a[c].src;if(e=e&&e.match(b)){if(e[2]=="include")break;return e[1]}}return"../../dist/"}(),noConflict:function(){return a.L=this._originalL,this},_originalL:a.L};window.L=b}(this),L.Util={extend:function(a){for(var b=Array.prototype.slice.call(arguments,1),c=0,d=b.length,e;c<d;c++){e=b[c]||{};for(var f in e)e.hasOwnProperty(f)&&(a[f]=e[f])}return a},bind:function(a,b){return function(){return a.apply(b,arguments)}},stamp:function(){var a=0;return function(b){return b._leaflet_id=b._leaflet_id||++a,b._leaflet_id}}(),requestAnimFrame:function(){function a(a){window.setTimeout(a,1e3/60)}var b=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||a;return function(c,d,e){c=d?L.Util.bind(c,d):d,e&&b===a?c():b(c)}}(),limitExecByInterval:function(a,b,c){function d(){e=!1,f&&(g.callee.apply(c,g),f=!1)}var e,f,g;return function(){g=arguments,e?f=!0:(e=!0,setTimeout(d,b),a.apply(c,g))}},falseFn:function(){return!1},formatNum:function(a,b){var c=Math.pow(10,b||5);return Math.round(a*c)/c},setOptions:function(a,b){a.options=L.Util.extend({},a.options,b)},getParamString:function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c+"="+a[c]);return"?"+b.join("&")}},L.Class=function(){},L.Class.extend=function(a){var b=function(){!L.Class._prototyping&&this.initialize&&this.initialize.apply(this,arguments)};L.Class._prototyping=!0;var c=new this;L.Class._prototyping=!1,c.constructor=b,b.prototype=c,c.superclass=this.prototype,a.statics&&(L.Util.extend(b,a.statics),delete a.statics),a.includes&&(L.Util.extend.apply(null,[c].concat(a.includes)),delete a.includes),a.options&&c.options&&(a.options=L.Util.extend({},c.options,a.options)),L.Util.extend(c,a),b.extend=arguments.callee,b.include=function(a){L.Util.extend(this.prototype,a)};for(var d in this)this.hasOwnProperty(d)&&d!="prototype"&&(b[d]=this[d]);return b},L.Mixin={},L.Mixin.Events={addEventListener:function(a,b,c){var d=this._leaflet_events=this._leaflet_events||{};return d[a]=d[a]||[],d[a].push({action:b,context:c}),this},hasEventListeners:function(a){return"_leaflet_events"in this&&a in this._leaflet_events&&this._leaflet_events[a].length>0},removeEventListener:function(a,b,c){if(!this.hasEventListeners(a))return this;for(var d=0,e=this._leaflet_events,f=e[a].length;d<f;d++)if(e[a][d].action===b&&(!c||e[a][d].context===c)){e[a].splice(d,1);break}return this},fireEvent:function(a,b){if(this.hasEventListeners(a)){for(var c=L.Util.extend({type:a,target:this},b),d=this._leaflet_events[a].slice(),e=0,f=d.length;e<f;e++)d[e].action.call(d[e].context||this,c);return this}}},L.Mixin.Events.on=L.Mixin.Events.addEventListener,L.Mixin.Events.off=L.Mixin.Events.removeEventListener,L.Mixin.Events.fire=L.Mixin.Events.fireEvent,function(){var a=navigator.userAgent.toLowerCase(),b=!!window.ActiveXObject,c=a.indexOf("webkit")!=-1,d=a.indexOf("mobi")!=-1,e=a.indexOf("android")!=-1,f=window.opera;L.Browser={ie:b,ie6:b&&!window.XMLHttpRequest,webkit:c,webkit3d:c&&"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,mobileWebkit:c&&(d||e),mobileOpera:d&&f,gecko:a.indexOf("gecko")!=-1,android:e},L.Browser.touch=L.Browser.mobileWebkit||L.Browser.mobileOpera}(),L.Point=function(a,b,c){this.x=c?Math.round(a):a,this.y=c?Math.round(b):b},L.Point.prototype={add:function(a){return this.clone()._add(a)},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(a)},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a,b){return new L.Point(this.x/a,this.y/a,b)},multiplyBy:function(a){return new L.Point(this.x*a,this.y*a)},distanceTo:function(a){var b=a.x-this.x,a=a.y-this.y;return Math.sqrt(b*b+a*a)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},clone:function(){return new L.Point(this.x,this.y)},toString:function(){return"Point("+L.Util.formatNum(this.x)+", "+L.Util.formatNum(this.y)+")"}},L.Bounds=L.Class.extend({initialize:function(a,b){if(a)for(var c=a instanceof Array?a:[a,b],d=0,e=c.length;d<e;d++)this.extend(c[d])},extend:function(a){!this.min&&!this.max?(this.min=new L.Point(a.x,a.y),this.max=new L.Point(a.x,a.y)):(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y))},getCenter:function(a){return new L.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},contains:function(a){var b;return a instanceof L.Bounds&&(b=a.min,a=a.max),b.x>=this.min.x&&a.x<=this.max.x&&b.y>=this.min.y&&a.y<=this.max.y}}),L.Transformation=L.Class.extend({initialize:function(a,b,c,d){this._a=a,this._b=b,this._c=c,this._d=d},transform:function(a,b){return this._transform(a.clone(),b)},_transform:function(a,b){return b=b||1,a.x=b*(this._a*a.x+this._b),a.y=b*(this._c*a.y+this._d),a},untransform:function(a,b){return b=b||1,new L.Point((a.x/b-this._b)/this._a,(a.y/b-this._d)/this._c)}}),L.LineUtil={simplify:function(a,b){return b?(a=this.reducePoints(a,b),a=this.simplifyDP(a,b)):a.slice()},pointToSegmentDistance:function(a,b,c){return Math.sqrt(this._sqPointToSegmentDist(a,b,c))},simplifyDP:function(a,b){for(var c=0,d=0,e=b*b,f=1,g=a.length,h;f<g-1;f++)h=this._sqPointToSegmentDist(a[f],a[0],a[g-1]),h>c&&(d=f,c=h);return c>=e?(c=a.slice(0,d),d=a.slice(d),g=this.simplifyDP(c,b).slice(0,g-2),d=this.simplifyDP(d,b),g.concat(d)):[a[0],a[g-1]]},reducePoints:function(a,b){for(var c=[a[0]],d=b*b,e=1,f=0,g=a.length;e<g;e++)this._sqDist(a[e],a[f])<d||(c.push(a[e]),f=e);return f<g-1&&c.push(a[g-1]),c},clipSegment:function(a,b,c,d){var d=d?this._lastCode:this._getBitCode(a,c),e=this._getBitCode(b,c);for(this._lastCode=e;;){if(!(d|e))return[a,b];if(d&e)return!1;var f=d||e,g=this._getEdgeIntersection(a,b,f,c),h=this._getBitCode(g,c);f==d?(a=g,d=h):(b=g,e=h)}},_getEdgeIntersection:function(a,b,c,d){var e=b.x-a.x,b=b.y-a.y,f=d.min,d=d.max;if(c&8)return new L.Point(a.x+e*(d.y-a.y)/b,d.y);if(c&4)return new L.Point(a.x+e*(f.y-a.y)/b,f.y);if(c&2)return new L.Point(d.x,a.y+b*(d.x-a.x)/e);if(c&1)return new L.Point(f.x,a.y+b*(f.x-a.x)/e)},_getBitCode:function(a,b){var c=0;return a.x<b.min.x?c|=1:a.x>b.max.x&&(c|=2),a.y<b.min.y?c|=4:a.y>b.max.y&&(c|=8),c},_sqDist:function(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d},_sqPointToSegmentDist:function(a,b,c){var d=c.x-b.x,e=c.y-b.y;if(!d&&!e)return this._sqDist(a,b);var f=((a.x-b.x)*d+(a.y-b.y)*e)/this._sqDist(b,c);return f<0?this._sqDist(a,b):f>1?this._sqDist(a,c):(b=new L.Point(b.x+d*f,b.y+e*f),this._sqDist(a,b))}},L.PolyUtil={},L.PolyUtil.clipPolygon=function(a,b){var c,d=[1,4,2,8],e,f,g,h,i,j,k=L.LineUtil;e=0;for(i=a.length;e<i;e++)a[e]._code=k._getBitCode(a[e],b);for(g=0;g<4;g++){j=d[g],c=[],e=0,i=a.length;for(f=i-1;e<i;f=e++)(h=a[e],f=a[f],h._code&j)?f._code&j||(f=k._getEdgeIntersection(f,h,j,b),f._code=k._getBitCode(f,b),c.push(f)):(f._code&j&&(f=k._getEdgeIntersection(f,h,j,b),f._code=k._getBitCode(f,b),c.push(f)),c.push(h));a=c}return a},L.DomEvent={addListener:function(a,b,c,d){function e(b){return c.call(d||a,b||L.DomEvent._getEvent())}var f=L.Util.stamp(c);if(L.Browser.touch&&b=="dblclick"&&this.addDoubleTapListener)this.addDoubleTapListener(a,e,f);else if("addEventListener"in a)if(b=="mousewheel")a.addEventListener("DOMMouseScroll",e,!1),a.addEventListener(b,e,!1);else if(b=="mouseenter"||b=="mouseleave"){var g=e,e=function(b){if(L.DomEvent._checkMouse(a,b))return g(b)};a.addEventListener(b=="mouseenter"?"mouseover":"mouseout",e,!1)}else a.addEventListener(b,e,!1);else"attachEvent"in a&&a.attachEvent("on"+b,e);a["_leaflet_"+b+f]=e},removeListener:function(a,b,c){var c=L.Util.stamp(c),d="_leaflet_"+b+c;handler=a[d],L.Browser.mobileWebkit&&b=="dblclick"&&this.removeDoubleTapListener?this.removeDoubleTapListener(a,c):"removeEventListener"in a?b=="mousewheel"?(a.removeEventListener("DOMMouseScroll",handler,!1),a.removeEventListener(b,handler,!1)):b=="mouseenter"||b=="mouseleave"?a.removeEventListener(b=="mouseenter"?"mouseover":"mouseout",handler,!1):a.removeEventListener(b,handler,!1):"detachEvent"in a&&a.detachEvent("on"+b,handler),a[d]=null},_checkMouse:function(a,b){var c=b.relatedTarget;if(!c)return!0;try{for(;c&&c!=a;)c=c.parentNode}catch(d){return!1}return c!=a},_getEvent:function(){var a=window.event;if(!a)for(var b=arguments.callee.caller;b;){if((a=b.arguments[0])&&Event==a.constructor)break;b=b.caller}return a},stopPropagation:function(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},disableClickPropagation:function(a){L.DomEvent.addListener(a,"mousedown",L.DomEvent.stopPropagation),L.DomEvent.addListener(a,"click",L.DomEvent.stopPropagation),L.DomEvent.addListener(a,"dblclick",L.DomEvent.stopPropagation)},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},stop:function(a){L.DomEvent.preventDefault(a),L.DomEvent.stopPropagation(a)},getMousePosition:function(a,b){var c=new L.Point(a.pageX?a.pageX:a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a.pageY?a.pageY:a.clientY+document.body.scrollTop+document.documentElement.scrollTop);return b?c.subtract(L.DomUtil.getCumulativeOffset(b)):c},getWheelDelta:function(a){var b=0;return a.wheelDelta&&(b=a.wheelDelta/120),a.detail&&(b=-a.detail/3),b}},L.Util.extend(L.DomEvent,{addDoubleTapListener:function(a,b,c){function d(a){if(a.touches.length==1){var b=Date.now(),c=b-(f||b);i=a.touches[0],g=c>0&&c<=h,f=b}}function e(){g&&(i.type="dblclick",b(i),f=null)}var f,g=!1,h=250,i;a["_leaflet_touchstart"+c]=d,a["_leaflet_touchend"+c]=e,a.addEventListener("touchstart",d,!1),a.addEventListener("touchend",e,!1)},removeDoubleTapListener:function(a,b){a.removeEventListener(a,a["_leaflet_touchstart"+b],!1),a.removeEventListener(a,a["_leaflet_touchend"+b],!1)}}),L.DomUtil={get:function(a){return typeof a=="string"?document.getElementById(a):a},getStyle:function(a,b){var c=a.style[b];!c&&a.currentStyle&&(c=a.currentStyle[b]);if(!c||c=="auto")c=(c=document.defaultView.getComputedStyle(a,null))?c[b]:null;return c=="auto"?null:c},getCumulativeOffset:function(a){var b=0,c=0;do b+=a.offsetTop||0,c+=a.offsetLeft||0,a=a.offsetParent;while(a);return new L.Point(c,b)},create:function(a,b,c){return a=document.createElement(a),a.className=b,c&&c.appendChild(a),a},disableTextSelection:function(){document.selection&&document.selection.empty&&document.selection.empty(),this._onselectstart||(this._onselectstart=document.onselectstart,document.onselectstart=L.Util.falseFn)},enableTextSelection:function(){document.onselectstart=this._onselectstart,this._onselectstart=null},CLASS_RE:/(\\s|^)'+cls+'(\\s|$)/,hasClass:function(a,b){return a.className.length>0&&RegExp("(^|\\s)"+b+"(\\s|$)").test(a.className)},addClass:function(a,b){L.DomUtil.hasClass(a,b)||(a.className+=(a.className?" ":"")+b)},setOpacity:function(a,b){L.Browser.ie?a.style.filter="alpha(opacity="+Math.round(b*100)+")":a.style.opacity=b},testProp:function(a){for(var b=document.documentElement.style,c=0;c<a.length;c++)if(a[c]in b)return a[c];return!1},getTranslateString:function(a){return L.DomUtil.TRANSLATE_OPEN+a.x+"px,"+a.y+"px"+L.DomUtil.TRANSLATE_CLOSE},getScaleString:function(a,b){return L.DomUtil.getTranslateString(b)+" scale("+a+") "+L.DomUtil.getTranslateString(b.multiplyBy(-1))},setPosition:function(a,b){a._leaflet_pos=b,L.Browser.webkit?a.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(b):(a.style.left=b.x+"px",a.style.top=b.y+"px")},getPosition:function(a){return a._leaflet_pos}},L.Util.extend(L.DomUtil,{TRANSITION:L.DomUtil.testProp(["transition","webkitTransition","OTransition","MozTransition","msTransition"]),TRANSFORM:L.DomUtil.testProp(["transformProperty","WebkitTransform","OTransform","MozTransform","msTransform"]),TRANSLATE_OPEN:"translate"+(L.Browser.webkit3d?"3d(":"("),TRANSLATE_CLOSE:L.Browser.webkit3d?",0)":")"}),L.Draggable=L.Class.extend({includes:L.Mixin.Events,statics:{START:L.Browser.touch?"touchstart":"mousedown",END:L.Browser.touch?"touchend":"mouseup",MOVE:L.Browser.touch?"touchmove":"mousemove",TAP_TOLERANCE:15},initialize:function(a,b){this._element=a,this._dragStartTarget=b||a},enable:function(){this._enabled||(L.DomEvent.addListener(this._dragStartTarget,L.Draggable.START,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(L.DomEvent.removeListener(this._dragStartTarget,L.Draggable.START,this._onDown),this._enabled=!1)},_onDown:function(a){if(!(a.shiftKey||a.which!=1&&a.button!=1&&!a.touches)&&!(a.touches&&a.touches.length>1)){var b=a.touches&&a.touches.length==1?a.touches[0]:a;L.DomEvent.preventDefault(a),L.Browser.mobileWebkit&&(b.target.className+=" leaflet-active"),this._moved=!1,L.DomUtil.disableTextSelection(),this._setMovingCursor(),this._startPos=this._newPos=L.DomUtil.getPosition(this._element),this._startPoint=new L.Point(b.clientX,b.clientY),L.DomEvent.addListener(document,L.Draggable.MOVE,this._onMove,this),L.DomEvent.addListener(document,L.Draggable.END,this._onUp,this)}},_onMove:function(a){a.touches&&a.touches.length>1||(L.DomEvent.preventDefault(a),a=a.touches&&a.touches.length==1?a.touches[0]:a,this._moved||(this.fire("dragstart"),this._moved=!0),this._newPos=this._startPos.add(new L.Point(a.clientX,a.clientY)).subtract(this._startPoint),L.Util.requestAnimFrame(this._updatePosition,this,!0),this.fire("drag"))},_updatePosition:function(){L.DomUtil.setPosition(this._element,this._newPos)},_onUp:function(a){if(a.changedTouches){var a=a.changedTouches[0],b=a.target,c=this._newPos&&this._newPos.distanceTo(this._startPos)||0;b.className=b.className.replace(" leaflet-active",""),c<L.Draggable.TAP_TOLERANCE&&this._simulateEvent("click",a)}L.DomUtil.enableTextSelection(),this._restoreCursor(),L.DomEvent.removeListener(document,L.Draggable.MOVE,this._onMove),L.DomEvent.removeListener(document,L.Draggable.END,this._onUp),this._moved&&this.fire("dragend")},_removeActiveClass:function(){},_setMovingCursor:function(){this._bodyCursor=document.body.style.cursor,document.body.style.cursor="move"},_restoreCursor:function(){document.body.style.cursor=this._bodyCursor},_simulateEvent:function(a,b){var c=document.createEvent("MouseEvent");c.initMouseEvent(a,!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null),b.target.dispatchEvent(c)}}),L.Transition=L.Class.extend({includes:L.Mixin.Events,statics:{CUSTOM_PROPS_SETTERS:{position:L.DomUtil.setPosition},implemented:function(){return L.Transition.NATIVE||L.Transition.TIMER}},options:{easing:"ease",duration:.5},_setProperty:function(a,b){var c=L.Transition.CUSTOM_PROPS_SETTERS;a in c?c[a](this._el,b):this._el.style[a]=b}}),L.Transition=L.Transition.extend({statics:function(){var a=L.DomUtil.TRANSITION;return{NATIVE:!!a,TRANSITION:a,PROPERTY:a+"Property",DURATION:a+"Duration",EASING:a+"TimingFunction",END:a=="webkitTransition"||a=="OTransition"?a+"End":"transitionend",CUSTOM_PROPS_PROPERTIES:{position:L.Browser.webkit?L.DomUtil.TRANSFORM:"top, left"}}}(),options:{fakeStepInterval:100},initialize:function(a,b){this._el=a,L.Util.setOptions(this,b),L.DomEvent.addListener(a,L.Transition.END,this._onTransitionEnd,this),this._onFakeStep=L.Util.bind(this._onFakeStep,this)},run:function(a){var b,c=[],d=L.Transition.CUSTOM_PROPS_PROPERTIES;for(b in a)a.hasOwnProperty(b)&&(b=d[b]?d[b]:b,b=b.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()}),c.push(b));this._el.style[L.Transition.DURATION]=this.options.duration+"s",this._el.style[L.Transition.EASING]=this.options.easing,this._el.style[L.Transition.PROPERTY]=c.join(", ");for(b in a)a.hasOwnProperty(b)&&this._setProperty(b,a[b]);this._inProgress=!0,this.fire("start"),L.Transition.NATIVE?this._timer=setInterval(this._onFakeStep,this.options.fakeStepInterval):this._onTransitionEnd()},_onFakeStep:function(){this.fire("step")},_onTransitionEnd:function(){this._inProgress&&(this._inProgress=!1,clearInterval(this._timer),this._el.style[L.Transition.PROPERTY]="none",this.fire("step"),this.fire("end"))}}),L.Transition=L.Transition.NATIVE?L.Transition:L.Transition.extend({statics:{getTime:Date.now||function(){return+(new Date)},TIMER:!0,EASINGS:{ease:[.25,.1,.25,1],linear:[0,0,1,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]},CUSTOM_PROPS_GETTERS:{position:L.DomUtil.getPosition},UNIT_RE:/^[\d\.]+(\D*)$/},options:{fps:50},initialize:function(a,b){this._el=a,L.Util.extend(this.options,b);var c=L.Transition.EASINGS[this.options.easing]||L.Transition.EASINGS.ease;this._p1=new L.Point(0,0),this._p2=new L.Point(c[0],c[1]),this._p3=new L.Point(c[2],c[3]),this._p4=new L.Point(1,1),this._step=L.Util.bind(this._step,this),this._interval=Math.round(1e3/this.options.fps)},run:function(a){this._props={};var b=L.Transition.CUSTOM_PROPS_GETTERS,c=L.Transition.UNIT_RE;this.fire("start");for(var d in a)if(a.hasOwnProperty(d)){var e={};if(d in b)e.from=b[d](this._el);else{var f=this._el.style[d].match(c);e.from=parseFloat(f[0]),e.unit=f[1]}e.to=a[d],this._props[d]=e}clearInterval(this._timer),this._timer=setInterval(this._step,this._interval),this._startTime=L.Transition.getTime()},_step:function(){var a=L.Transition.getTime()-this._startTime,b=this.options.duration*1e3;a<b?this._runFrame(this._cubicBezier(a/b)):(this._runFrame(1),this._complete())},_runFrame:function(a){var b=L.Transition.CUSTOM_PROPS_SETTERS,c,d;for(c in this._props)this._props.hasOwnProperty(c)&&(d=this._props[c],c in b?(d=d.to.subtract(d.from).multiplyBy(a).add(d.from),b[c](this._el,d)):this._el.style[c]=(d.to-d.from)*a+d.from+d.unit);this.fire("step")},_complete:function(){clearInterval(this._timer),this.fire("end")},_cubicBezier:function(a){var b=3*Math.pow(1-a,2)*a,c=3*(1-a)*Math.pow(a,2),d=Math.pow(a,3),a=this._p1.multiplyBy(Math.pow(1-a,3)),b=this._p2.multiplyBy(b),c=this._p3.multiplyBy(c),d=this._p4.multiplyBy(d);return a.add(b).add(c).add(d).y}}),L.LatLng=function(a,b,c){c!==!0&&(a=Math.max(Math.min(a,90),-90),b=(b+180)%360+(b<-180?180:-180)),this.lat=a,this.lng=b},L.Util.extend(L.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),L.LatLng.prototype={equals:function(a){return a instanceof L.LatLng?Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng))<=L.LatLng.MAX_MARGIN:!1},toString:function(){return"LatLng("+L.Util.formatNum(this.lat)+", "+L.Util.formatNum(this.lng)+")"}},L.LatLngBounds=L.Class.extend({initialize:function(a,b){if(a)for(var c=a instanceof Array?a:[a,b],d=0,e=c.length;d<e;d++)this.extend(c[d])},extend:function(a){!this._southWest&&!this._northEast?(this._southWest=new L.LatLng(a.lat,a.lng),this._northEast=new L.LatLng(a.lat,a.lng)):(this._southWest.lat=Math.min(a.lat,this._southWest.lat),this._southWest.lng=Math.min(a.lng,this._southWest.lng),this._northEast.lat=Math.max(a.lat,this._northEast.lat),this._northEast.lng=Math.max(a.lng,this._northEast.lng))},getCenter:function(){return new L.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new L.LatLng(this._northEast.lat,this._southWest.lng)},getSouthEast:function(){return new L.LatLng(this._southWest.lat,this._northEast.lng)},contains:function(a){var b=this._southWest,c=this._northEast,d;return a instanceof L.LatLngBounds?(d=a.getSouthWest(),a=a.getNorthEast()):d=a,d.lat>=b.lat&&a.lat<=c.lat&&d.lng>=b.lng&&a.lng<=c.lng}}),L.Projection={},L.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(a){var b=L.LatLng.DEG_TO_RAD,c=this.MAX_LATITUDE,d=a.lng*b,a=Math.max(Math.min(c,a.lat),-c)*b,a=Math.log(Math.tan(Math.PI/4+a/2));return new L.Point(d,a)},unproject:function(a,b){var c=L.LatLng.RAD_TO_DEG;return new L.LatLng((2*Math.atan(Math.exp(a.y))-Math.PI/2)*c,a.x*c,b)}},L.Projection.LonLat={project:function(a){return new L.Point(a.lng,a.lat)},unproject:function(a,b){return new L.LatLng(a.y,a.x,b)}},L.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.3142,R_MAJOR:6378137,project:function(a){var b=L.LatLng.DEG_TO_RAD,c=this.MAX_LATITUDE,d=this.R_MAJOR,e=a.lng*b*d,a=Math.max(Math.min(c,a.lat),-c)*b,b=this.R_MINOR/d,b=Math.sqrt(1-b*b),c=b*Math.sin(a),c=Math.pow((1-c)/(1+c),b*.5),a=-d*Math.log(Math.tan(.5*(Math.PI*.5-a))/c);return new L.Point(e,a)},unproject:function(a,b){for(var c=L.LatLng.RAD_TO_DEG,d=this.R_MAJOR,e=a.x*c/d,f=this.R_MINOR/d,f=Math.sqrt(1-f*f),d=Math.exp(-a.y/d),g=Math.PI/2-2*Math.atan(d),h=15,i=.1;Math.abs(i)>1e-7&&--h>0;)i=f*Math.sin(g),i=Math.PI/2-2*Math.atan(d*Math.pow((1-i)/(1+i),.5*f))-g,g+=i;return new L.LatLng(g*c,e,b)}},L.CRS={latLngToPoint:function(a,b){return this.transformation._transform(this.projection.project(a),b)},pointToLatLng:function(a,b,c){return this.projection.unproject(this.transformation.untransform(a,b),c)},project:function(a){return this.projection.project(a)}},L.CRS.EPSG3857=L.Util.extend({},L.CRS,{code:"EPSG:3857",projection:L.Projection.SphericalMercator,transformation:new L.Transformation(.5/Math.PI,.5,-0.5/Math.PI,.5),project:function(a){return this.projection.project(a).multiplyBy(6378137)}}),L.CRS.EPSG900913=L.Util.extend({},L.CRS.EPSG3857,{code:"EPSG:900913"}),L.CRS.EPSG4326=L.Util.extend({},L.CRS,{code:"EPSG:4326",projection:L.Projection.LonLat,transformation:new L.Transformation(1/360,.5,-1/360,.5)}),L.CRS.EPSG3395=L.Util.extend({},L.CRS,{code:"EPSG:3395",projection:L.Projection.Mercator,transformation:function(){var a=L.Projection.Mercator;return new L.Transformation(.5/(Math.PI*a.R_MAJOR),.5,-0.5/(Math.PI*a.R_MINOR),.5)}()}),L.LayerGroup=L.Class.extend({initialize:function(a){this._layers={};if(a)for(var b=0,c=a.length;b<c;b++)this.addLayer(a[b])},addLayer:function(a){return this._layers[L.Util.stamp(a)]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){return delete this._layers[L.Util.stamp(a)],this._map&&this._map.removeLayer(a),this},clearLayers:function(){return this._iterateLayers(this.removeLayer,this),this},onAdd:function(a){this._map=a,this._iterateLayers(a.addLayer,a)},onRemove:function(a){this._iterateLayers(a.removeLayer,a),delete this._map},_iterateLayers:function(a,b){for(var c in this._layers)this._layers.hasOwnProperty(c)&&a.call(b,this._layers[c])}}),L.FeatureGroup=L.LayerGroup.extend({includes:L.Mixin.Events,addLayer:function(a){this._initEvents(a),L.LayerGroup.prototype.addLayer.call(this,a),this._popupContent&&a.bindPopup&&a.bindPopup(this._popupContent)},bindPopup:function(a){this._popupContent=a;for(var b in this._layers)this._layers.hasOwnProperty(b)&&this._layers[b].bindPopup&&this._layers[b].bindPopup(a)},_events:["click","dblclick","mouseover","mouseout"],_initEvents:function(a){for(var b=0,c=this._events.length;b<c;b++)a.on(this._events[b],this._propagateEvent,this)},_propagateEvent:function(a){a.layer=a.target,a.target=this,this.fire(a.type,a)}}),L.TileLayer=L.Class.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",opacity:1,scheme:"xyz",noWrap:!1,unloadInvisibleTiles:L.Browser.mobileWebkit,updateWhenIdle:L.Browser.mobileWebkit},initialize:function(a,b){L.Util.setOptions(this,b),this._url=a,typeof this.options.subdomains=="string"&&(this.options.subdomains=this.options.subdomains.split(""))},onAdd:function(a){this._map=a,this._initContainer(),this._createTileProto(),a.on("viewreset",this._reset,this),this.options.updateWhenIdle?a.on("moveend",this._update,this):(this._limitedUpdate=L.Util.limitExecByInterval(this._update,100,this),a.on("move",this._limitedUpdate,this)),this._reset(),this._update()},onRemove:function(){this._map.getPanes().tilePane.removeChild(this._container),this._container=null,this._map.off("viewreset",this._reset,this),this.options.updateWhenIdle?this._map.off("moveend",this._update,this):this._map.off("move",this._limitedUpdate,this)},getAttribution:function(){return this.options.attribution},setOpacity:function(a){this.options.opacity=a,this._setOpacity(a);if(L.Browser.webkit)for(i in this._tiles)this._tiles[i].style.webkitTransform+=" translate(0,0)"},_setOpacity:function(a){a<1&&L.DomUtil.setOpacity(this._container,a)},_initContainer:function(){var a=this._map.getPanes().tilePane;if(!this._container||a.empty)this._container=L.DomUtil.create("div","leaflet-layer",a),this._setOpacity(this.options.opacity)},_reset:function(){this._tiles={},this._initContainer(),this._container.innerHTML=""},_update:function(){var a=this._map.getPixelBounds(),b=this.options.tileSize,c=new L.Point(Math.floor(a.min.x/b),Math.floor(a.min.y/b)),a=new L.Point(Math.floor(a.max.x/b),Math.floor(a.max.y/b)),c=new L.Bounds(c,a);this._addTilesFromCenterOut(c),this.options.unloadInvisibleTiles&&this._removeOtherTiles(c)},_addTilesFromCenterOut:function(a){for(var b=[],c=a.getCenter(),d=a.min.y;d<=a.max.y;d++)for(var e=a.min.x;e<=a.max.x;e++)e+":"+d in this._tiles||b.push(new L.Point(e,d));b.sort(function(a,b){return a.distanceTo(c)-b.distanceTo(c)}),this._tilesToLoad=b.length,a=0;for(d=this._tilesToLoad;a<d;a++)this._addTile(b[a])},_removeOtherTiles:function(a){var b,c,d;for(d in this._tiles)this._tiles.hasOwnProperty(d)&&(b=d.split(":"),c=parseInt(b[0],10),b=parseInt(b[1],10),c<a.min.x||c>a.max.x||b<a.min.y||b>a.max.y)&&(this._tiles[d].src="",this._tiles[d].parentNode==this._container&&this._container.removeChild(this._tiles[d]),delete this._tiles[d])},_addTile:function(a){var b=this._getTilePos(a),c=this._map.getZoom(),d=a.x+":"+a.y,e=1<<c;this.options.noWrap||(a.x=(a.x%e+e)%e);if(!(a.y<0||a.y>=e)){var f=this._createTile();L.DomUtil.setPosition(f,b),this._tiles[d]=f,this.options.scheme=="tms"&&(a.y=e-a.y-1),this._loadTile(f,a,c),this._container.appendChild(f)}},_getTilePos:function(a){var b=this._map.getPixelOrigin();return a.multiplyBy(this.options.tileSize).subtract(b)},getTileUrl:function(a,b){return this._url.replace("{s}",this.options.subdomains[(a.x+a.y)%this.options.subdomains.length]).replace("{z}",b).replace("{x}",a.x).replace("{y}",a.y)},_createTileProto:function(){this._tileImg=L.DomUtil.create("img","leaflet-tile"),this._tileImg.galleryimg="no";var a=this.options.tileSize;this._tileImg.style.width=a+"px",this._tileImg.style.height=a+"px"},_createTile:function(){var a=this._tileImg.cloneNode(!1);return a.onselectstart=a.onmousemove=L.Util.falseFn,a},_loadTile:function(a,b,c){a._layer=this,a.onload=this._tileOnLoad,a.onerror=this._tileOnError,a.src=this.getTileUrl(b,c)},_tileOnLoad:function(){var a=this._layer;this.className+=" leaflet-tile-loaded",a.fire("tileload",{tile:this,url:this.src}),a._tilesToLoad--,a._tilesToLoad||a.fire("load")},_tileOnError:function(){var a=this._layer;a.fire("tileerror",{tile:this,url:this.src});if(a=a.options.errorTileUrl)this.src=a}}),L.TileLayer.WMS=L.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(a,b){this._url=a,this.wmsParams=L.Util.extend({},this.defaultWmsParams),this.wmsParams.width=this.wmsParams.height=this.options.tileSize;for(var c in b)this.options.hasOwnProperty(c)||(this.wmsParams[c]=b[c]);L.Util.setOptions(this,b)},onAdd:function(a){this.wmsParams[parseFloat(this.wmsParams.version)>=1.3?"crs":"srs"]=a.options.crs.code,L.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a){var b=this.options.tileSize,a=a.multiplyBy(b),b=a.add(new L.Point(b,b)),a=this._map.unproject(a,this._zoom,!0),b=this._map.unproject(b,this._zoom,!0),a=this._map.options.crs.project(a),b=this._map.options.crs.project(b),b=[a.x,b.y,b.x,a.y].join(",");return this._url+L.Util.getParamString(this.wmsParams)+"&bbox="+b}}),L.TileLayer.Canvas=L.TileLayer.extend({options:{async:!1},initialize:function(a){L.Util.setOptions(this,a)},_createTileProto:function(){this._canvasProto=L.DomUtil.create("canvas","leaflet-tile");var a=this.options.tileSize;this._canvasProto.width=a,this._canvasProto.height=a},_createTile:function(){var a=this._canvasProto.cloneNode(!1);return a.onselectstart=a.onmousemove=L.Util.falseFn,a},_loadTile:function(a,b,c){a._layer=this,this.drawTile(a,b,c),this.options.async||this.tileDrawn(a)},drawTile:function(){},tileDrawn:function(a){this._tileOnLoad.call(a)}}),L.ImageOverlay=L.Class.extend({includes:L.Mixin.Events,initialize:function(a,b){this._url=a,this._bounds=b},onAdd:function(a){this._map=a,this._image||this._initImage(),a.getPanes().overlayPane.appendChild(this._image),a.on("viewreset",this._reset,this),this._reset()},onRemove:function(a){a.getPanes().overlayPane.removeChild(this._image),a.off("viewreset",this._reset,this)},_initImage:function(){this._image=L.DomUtil.create("img","leaflet-image-layer"),this._image.style.visibility="hidden",L.Util.extend(this._image,{galleryimg:"no",onselectstart:L.Util.falseFn,onmousemove:L.Util.falseFn,onload:this._onImageLoad,src:this._url})},_reset:function(){var a=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),b=this._map.latLngToLayerPoint(this._bounds.getSouthEast()).subtract(a);L.DomUtil.setPosition(this._image,a),this._image.style.width=b.x+"px",this._image.style.height=b.y+"px"},_onImageLoad:function(){this.style.visibility=""}}),L.Popup=L.Class.extend({includes:L.Mixin.Events,options:{maxWidth:300,autoPan:!0,closeButton:!0,offset:new L.Point(0,2),autoPanPadding:new L.Point(5,5)},initialize:function(a){L.Util.setOptions(this,a)},onAdd:function(a){this._map=a,this._container||this._initLayout(),this._updateContent(),this._container.style.opacity="0",this._map._panes.popupPane.appendChild(this._container),this._map.on("viewreset",this._updatePosition,this),this._map.options.closePopupOnClick&&this._map.on("preclick",this._close,this),this._update(),this._container.style.opacity="1",this._opened=!0},onRemove:function(a){a._panes.popupPane.removeChild(this._container),a.off("viewreset",this._updatePosition,this),a.off("click",this._close,this),this._container.style.opacity="0",this._opened=!1},setLatLng:function(a){return this._latlng=a,this._opened&&this._update(),this},setContent:function(a){return this._content=a,this._opened&&this._update(),this},_close:function(){this._opened&&this._map.removeLayer(this)},_initLayout:function(){this._container=L.DomUtil.create("div","leaflet-popup"),this._closeButton=L.DomUtil.create("a","leaflet-popup-close-button",this._container),this._closeButton.href="#close",this._closeButton.onclick=L.Util.bind(this._onCloseButtonClick,this),this._wrapper=L.DomUtil.create("div","leaflet-popup-content-wrapper",this._container),L.DomEvent.disableClickPropagation(this._wrapper),this._contentNode=L.DomUtil.create("div","leaflet-popup-content",this._wrapper),this._tipContainer=L.DomUtil.create("div","leaflet-popup-tip-container",this._container),this._tip=L.DomUtil.create("div","leaflet-popup-tip",this._tipContainer)},_update:function(){this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan()},_updateContent:function(){this._content&&(typeof this._content=="string"?this._contentNode.innerHTML=this._content:(this._contentNode.innerHTML="",this._contentNode.appendChild(this._content)))},_updateLayout:function(){this._container.style.width="",this._container.style.whiteSpace="nowrap";var a=this._container.offsetWidth;this._container.style.width=(a>this.options.maxWidth?this.options.maxWidth:a)+"px",this._container.style.whiteSpace="",this._containerWidth=this._container.offsetWidth},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._containerBottom=-a.y-this.options.offset.y,this._containerLeft=a.x-Math.round(this._containerWidth/2)+this.options.offset.x,this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"},_adjustPan:function(){if(this.options.autoPan){var a=this._container.offsetHeight,b=this._map.layerPointToContainerPoint(new L.Point(this._containerLeft,-a-this._containerBottom)),c=new L.Point(0,0),d=this.options.autoPanPadding,e=this._map.getSize();b.x<0&&(c.x=b.x-d.x),b.x+this._containerWidth>e.x&&(c.x=b.x+this._containerWidth-e.x+d.x),b.y<0&&(c.y=b.y-d.y),b.y+a>e.y&&(c.y=b.y+a-e.y+d.y),(c.x||c.y)&&this._map.panBy(c)}},_onCloseButtonClick:function(a){this._close(),L.DomEvent.stop(a)}}),L.Icon=L.Class.extend({iconUrl:L.ROOT_URL+"images/marker.png",shadowUrl:L.ROOT_URL+"images/marker-shadow.png",iconSize:new L.Point(25,41),shadowSize:new L.Point(41,41),iconAnchor:new L.Point(13,41),popupAnchor:new L.Point(0,-33),initialize:function(a){a&&(this.iconUrl=a)},createIcon:function(){return this._createIcon("icon")},createShadow:function(){return this._createIcon("shadow")},_createIcon:function(a){var b=this[a+"Size"],c=this[a+"Url"],d=this._createImg(c);return c?(d.className="leaflet-marker-"+a,d.style.marginLeft=-this.iconAnchor.x+"px",d.style.marginTop=-this.iconAnchor.y+"px",b&&(d.style.width=b.x+"px",d.style.height=b.y+"px"),d):null},_createImg:function(a){var b;return L.Browser.ie6?(b=document.createElement("div"),b.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+a+'")'):(b=document.createElement("img"),b.src=a),b}}),L.Marker=L.Class.extend({includes:L.Mixin.Events,options:{icon:new L.Icon,title:"",clickable:!0,draggable:!1},initialize:function(a,b){L.Util.setOptions(this,b),this._latlng=a},onAdd:function(a){this._map=a,this._initIcon(),a.on("viewreset",this._reset,this),this._reset()},onRemove:function(a){this._removeIcon(),a.off("viewreset",this._reset,this)},getLatLng:function(){return this._latlng},setLatLng:function(a){this._latlng=a,this._reset()},setIcon:function(a){this._removeIcon(),this._icon=this._shadow=null,this.options.icon=a,this._initIcon()},_initIcon:function(){this._icon||(this._icon=this.options.icon.createIcon(),this.options.title&&(this._icon.title=this.options.title),this._initInteraction()),this._shadow||(this._shadow=this.options.icon.createShadow()),this._map._panes.markerPane.appendChild(this._icon),this._shadow&&this._map._panes.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this._map._panes.markerPane.removeChild(this._icon),this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow)},_reset:function(){var a=this._map.latLngToLayerPoint(this._latlng).round();L.DomUtil.setPosition(this._icon,a),this._shadow&&L.DomUtil.setPosition(this._shadow,a),this._icon.style.zIndex=a.y},_initInteraction:function(){if(this.options.clickable){this._icon.className+=" leaflet-clickable",L.DomEvent.addListener(this._icon,"click",this._onMouseClick,this);for(var a=["dblclick","mousedown","mouseover","mouseout"],b=0;b<a.length;b++)L.DomEvent.addListener(this._icon,a[b],this._fireMouseEvent,this)}L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())},_onMouseClick:function(a){L.DomEvent.stopPropagation(a),(!this.dragging||!this.dragging.moved())&&this.fire(a.type)},_fireMouseEvent:function(a){this.fire(a.type),L.DomEvent.stopPropagation(a)}}),L.Marker.include({openPopup:function(){return this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup),this},closePopup:function(){this._popup&&this._popup._close()},bindPopup:function(a,b){return b=L.Util.extend({offset:this.options.icon.popupAnchor},b),this._popup=new L.Popup(b),this._popup.setContent(a),this.on("click",this.openPopup,this),this}}),L.Path=L.Class.extend({includes:[L.Mixin.Events],statics:function(){return{SVG_NS:"http://www.w3.org/2000/svg",SVG:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,CLIP_PADDING:.5}}(),options:{stroke:!0,color:"#0033ff",weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0,updateOnMoveEnd:!1},initialize:function(a){L.Util.setOptions(this,a)},onAdd:function(a){this._map=a,this._initElements(),this._initEvents(),this.projectLatlngs(),this._updatePath(),a.on("viewreset",this.projectLatlngs,this),this._updateTrigger=this.options.updateOnMoveEnd?"moveend":"viewreset",a.on(this._updateTrigger,this._updatePath,this)},onRemove:function(a){a._pathRoot.removeChild(this._container),a.off("viewreset",this._projectLatlngs,this),a.off(this._updateTrigger,this._updatePath,this)},projectLatlngs:function(){},getPathString:function(){},setStyle:function(a){L.Util.setOptions(this,a),this._path&&this._updateStyle()},_initElements:function(){this._initRoot(),this._initPath(),this._initStyle()},_initRoot:function(){this._map._pathRoot||(this._map._pathRoot=this._createElement("svg"),this._map._panes.overlayPane.appendChild(this._map._pathRoot),this._map.on("moveend",this._updateSvgViewport,this),this._updateSvgViewport())},_updateSvgViewport:function(){this._updateViewport();var a=this._map._pathViewport,b=a.min,c=a.max,a=c.x-b.x,c=c.y-b.y,d=this._map._pathRoot,e=this._map._panes.overlayPane;L.Browser.mobileWebkit&&e.removeChild(d),L.DomUtil.setPosition(d,b),d.setAttribute("width",a),d.setAttribute("height",c),d.setAttribute("viewBox",[b.x,b.y,a,c].join(" ")),L.Browser.mobileWebkit&&e.appendChild(d)},_updateViewport:function(){var a=L.Path.CLIP_PADDING,b=this._map.getSize(),c=L.DomUtil.getPosition(this._map._mapPane).multiplyBy(-1).subtract(b.multiplyBy(a)),a=c.add(b.multiplyBy(1+a*2));this._map._pathViewport=new L.Bounds(c,a)},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this._container.appendChild(this._path),this._map._pathRoot.appendChild(this._container)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill?this._path.setAttribute("fill-rule","evenodd"):this._path.setAttribute("fill","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight)),this.options.fill&&(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity))},_updatePath:function(){var a=this.getPathString();a||(a="M0 0"),this._path.setAttribute("d",a)},_createElement:function(a){return document.createElementNS(L.Path.SVG_NS,a)},_initEvents:function(){if(this.options.clickable){L.Path.VML||this._path.setAttribute("class","leaflet-clickable"),L.DomEvent.addListener(this._container,"click",this._onMouseClick,this);for(var a=["dblclick","mousedown","mouseover","mouseout"],b=0;b<a.length;b++)L.DomEvent.addListener(this._container,a[b],this._fireMouseEvent,this)}},_onMouseClick:function(a){(!this._map.dragging||!this._map.dragging.moved())&&this._fireMouseEvent(a)},_fireMouseEvent:function(a){this.hasEventListeners(a.type)&&(this.fire(a.type,{latlng:this._map.mouseEventToLatLng(a),layerPoint:this._map.mouseEventToLayerPoint(a)}),L.DomEvent.stopPropagation(a))},_redraw:function(){this.projectLatlngs(),this._updatePath()}}),L.Path.VML=function(){var a=document.createElement("div");return a.innerHTML='<v:shape adj="1"/>',a=a.firstChild,a.style.behavior="url(#default#VML)",a&&typeof a.adj=="object"}(),L.Path=L.Path.SVG||!L.Path.VML?L.Path:L.Path.extend({statics:{CLIP_PADDING:.02},_createElement:function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch(a){return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initRoot:function(){this._map._pathRoot||(this._map._pathRoot=document.createElement("div"),this._map._pathRoot.className="leaflet-vml-container",this._map._panes.overlayPane.appendChild(this._map._pathRoot),this._map.on("moveend",this._updateViewport,this),this._updateViewport())},_initPath:function(){this._container=this._createElement("shape"),this._container.className+=" leaflet-vml-shape"+(this.options.clickable?" leaflet-clickable":""),this._container.coordsize="1 1",this._path=this._createElement("path"),this._container.appendChild(this._path),this._map._pathRoot.appendChild(this._container)},_initStyle:function(){this.options.stroke?(this._stroke=this._createElement("stroke"),this._stroke.endcap="round",this._container.appendChild(this._stroke)):this._container.stroked=!1,this.options.fill?(this._container.filled=!0,this._fill=this._createElement("fill"),this._container.appendChild(this._fill)):this._container.filled=!1,this._updateStyle()},_updateStyle:function(){this.options.stroke&&(this._stroke.weight=this.options.weight+"px",this._stroke.color=this.options.color,this._stroke.opacity=this.options.opacity),this.options.fill&&(this._fill.color=this.options.fillColor||this.options.color,this._fill.opacity=this.options.fillOpacity)},_updatePath:function(){this._container.style.display="none",this._path.v=this.getPathString()+" ",this._container.style.display=""}}),L.Path.include({bindPopup:function(a,b){if(!this._popup||this._popup.options!==b)this._popup=new L.Popup(b);return this._popup.setContent(a),this._openPopupAdded||(this.on("click",this._openPopup,this),this._openPopupAdded=!0),this},_openPopup:function(a){this._popup.setLatLng(a.latlng),this._map.openPopup(this._popup)}}),L.Polyline=L.Path.extend({initialize:function(a,b){L.Path.prototype.initialize.call(this,b),this._latlngs=a},options:{smoothFactor:1,noClip:!1,updateOnMoveEnd:!0},projectLatlngs:function(){this._originalPoints=[];for(var a=0,b=this._latlngs.length;a<b;a++)this._originalPoints[a]=this._map.latLngToLayerPoint(this._latlngs[a])},getPathString:function(){for(var a=0,b=this._parts.length,c="";a<b;a++)c+=this._getPathPartStr(this._parts[a]);return c},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._latlngs=a,this._redraw(),this},addLatLng:function(a){return this._latlngs.push(a),this._redraw(),this},spliceLatLngs:function(){var a=[].splice.apply(this._latlngs,arguments);return this._redraw(),a},_getPathPartStr:function(a){for(var b=L.Path.VML,c=0,d=a.length,e="",f;c<d;c++)f=a[c],b&&f._round(),e+=(c?"L":"M")+f.x+" "+f.y;return e},_clipPoints:function(){var a=this._originalPoints,b=a.length,c,d,e;if(this.options.noClip)this._parts=[a];else{var f=this._parts=[],g=this._map._pathViewport,h=L.LineUtil;for(d=c=0;c<b-1;c++)if(e=h.clipSegment(a[c],a[c+1],g,c))if(f[d]=f[d]||[],f[d].push(e[0]),e[1]!=a[c+1]||c==b-2)f[d].push(e[1]),d++}},_simplifyPoints:function(){for(var a=this._parts,b=L.LineUtil,c=0,d=a.length;c<d;c++)a[c]=b.simplify(a[c],this.options.smoothFactor)},_updatePath:function(){this._clipPoints(),this._simplifyPoints(),L.Path.prototype._updatePath.call(this)}}),L.Polygon=L.Polyline.extend({options:{fill:!0},initialize:function(a,b){L.Polyline.prototype.initialize.call(this,a,b),a[0]instanceof Array&&(this._latlngs=a[0],this._holes=a.slice(1))},projectLatlngs:function(){L.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[];if(this._holes)for(var a=0,b=this._holes.length;a<b;a++){this._holePoints[a]=[];for(var c=0,d=this._holes[a].length;c<d;c++)this._holePoints[a][c]=this._map.latLngToLayerPoint(this._holes[a][c])}},_clipPoints:function(){var a=[];this._parts=[this._originalPoints].concat(this._holePoints);if(!this.options.noClip){for(var b=0,c=this._parts.length;b<c;b++){var d=L.PolyUtil.clipPolygon(this._parts[b],this._map._pathViewport);d.length&&a.push(d)}this._parts=a}},_getPathPartStr:function(a){return L.Polyline.prototype._getPathPartStr.call(this,a)+(L.Path.SVG?"z":"x")}}),function(){function a(a){return L.FeatureGroup.extend({initialize:function(b,c){this._layers={};for(var d=0,e=b.length;d<e;d++)this.addLayer(new a(b[d],c))},setStyle:function(a){for(var b in this._layers)this._layers.hasOwnProperty(b)&&this._layers[b].setStyle&&this._layers[b].setStyle(a)}})}L.MultiPolyline=a(L.Polyline),L.MultiPolygon=a(L.Polygon)}(),L.Circle=L.Path.extend({initialize:function(a,b,c){L.Path.prototype.initialize.call(this,c),this._latlng=a,this._mRadius=b},options:{fill:!0},setLatLng:function(a){return this._latlng=a,this._redraw(),this},setRadius:function(a){return this._mRadius=a,this._redraw(),this},projectLatlngs:function(){var a=this._map.options.scale(this._map._zoom);this._point=this._map.latLngToLayerPoint(this._latlng),this._radius=this._mRadius/40075017*a},getPathString:function(){var a=this._point,b=this._radius;return L.Path.SVG?"M"+a.x+","+(a.y-b)+"A"+b+","+b+",0,1,1,"+(a.x-.1)+","+(a.y-b)+" z":(a._round(),b=Math.round(b),"AL "+a.x+","+a.y+" "+b+","+b+" 0,23592600")}}),L.CircleMarker=L.Circle.extend({options:{radius:10,weight:2},initialize:function(a,b){L.Circle.prototype.initialize.call(this,a,null,b),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},setRadius:function(a){return this._radius=a,this._redraw(),this}}),L.GeoJSON=L.LayerGroup.extend({includes:L.Mixin.Events,initialize:function(a,b){L.Util.setOptions(this,b),this._geojson=a,this._layers={},a&&this.addGeoJSON(a)},addGeoJSON:function(a){if(a.features)for(var b=0,c=a.features.length;b<c;b++)this.addGeoJSON(a.features[b]);else b=a.type=="Feature"?a.geometry:a,c=L.GeoJSON.geometryToLayer(b,this.options.pointToLayer),this.fire("featureparse",{layer:c,properties:a.properties,geometryType:b.type,bbox:a.bbox,id:a.id}),this.addLayer(c)}}),L.Util.extend(L.GeoJSON,{geometryToLayer:function(a,b){var c=a.coordinates,d,e,f,g=[];switch(a.type){case"Point":return d=this.coordsToLatLng(c),b?b(d):new L.Marker(d);case"MultiPoint":e=0;for(f=c.length;e<f;e++)d=this.coordsToLatLng(c[e]),d=b?b(d):new L.Marker(d),g.push(d);return new L.FeatureGroup(g);case"LineString":return c=this.coordsToLatLngs(c),new L.Polyline(c);case"Polygon":return c=this.coordsToLatLngs(c,1),new L.Polygon(c);case"MultiLineString":return c=this.coordsToLatLngs(c,1),new L.MultiPolyline(c);case"MultiPolygon":return c=this.coordsToLatLngs(c,2),new L.MultiPolygon(c);case"GeometryCollection":e=0;for(f=a.geometries.length;e<f;e++)d=this.geometryToLayer(a.geometries[e]),g.push(d);return new L.FeatureGroup(g);default:throw Error("Invalid GeoJSON object.")}},coordsToLatLng:function(a,b){var c=parseFloat(a[b?0:1]),d=parseFloat(a[b?1:0]);return new L.LatLng(c,d)},coordsToLatLngs:function(a,b,c){var d,e=[],f,g=a.length;for(f=0;f<g;f++)d=b?this.coordsToLatLngs(a[f],b-1,c):this.coordsToLatLng(a[f],c),e.push(d);return e}}),L.Handler=L.Class.extend({initialize:function(a){this._map=a},enabled:function(){return!!this._enabled}}),L.Handler.MapDrag=L.Handler.extend({enable:function(){this._enabled||(this._draggable||(this._draggable=new L.Draggable(this._map._mapPane,this._map._container),this._draggable.on("dragstart",this._onDragStart,this),this._draggable.on("drag",this._onDrag,this),this._draggable.on("dragend",this._onDragEnd,this)),this._draggable.enable(),this._enabled=!0)},disable:function(){this._enabled&&(this._draggable.disable(),this._enabled=!1)},moved:function(){return this._draggable._moved},_onDragStart:function(){this._map.fire("movestart"),this._map.fire("dragstart")},_onDrag:function(){this._map.fire("move"),this._map.fire("drag")},_onDragEnd:function(){this._map.fire("moveend"),this._map.fire("dragend")}}),L.Handler.TouchZoom=L.Handler.extend({enable:function(){L.Browser.mobileWebkit&&!this._enabled&&(L.DomEvent.addListener(this._map._container,"touchstart",this._onTouchStart,this),this._enabled=!0)},disable:function(){this._enabled&&(L.DomEvent.removeListener(this._map._container,"touchstart",this._onTouchStart,this),this._enabled=!1)},_onTouchStart:function(a){if(a.touches&&a.touches.length==2&&!this._map._animatingZoom){var b=this._map.mouseEventToLayerPoint(a.touches[0]),c=this._map.mouseEventToLayerPoint(a.touches[1]),d=this._map.containerPointToLayerPoint(this._map.getSize().divideBy(2));this._startCenter=b.add(c).divideBy(2,!0),this._startDist=b.distanceTo(c),this._moved=!1,this._zooming=!0,this._centerOffset=d.subtract(this._startCenter),L.DomEvent.addListener(document,"touchmove",this._onTouchMove,this),L.DomEvent.addListener(document,"touchend",this._onTouchEnd,this),L.DomEvent.preventDefault(a)}},_onTouchMove:function(a){if(a.touches&&a.touches.length==2){this._moved||(this._map._mapPane.className+=" leaflet-zoom-anim",this._map._prepareTileBg(),this._moved=!0);var b=this._map.mouseEventToLayerPoint(a.touches[0]),c=this._map.mouseEventToLayerPoint(a.touches[1]);this._scale=b.distanceTo(c)/this._startDist,this._delta=b.add(c).divideBy(2,!0).subtract(this._startCenter),this._map._tileBg.style.webkitTransform=[L.DomUtil.getTranslateString(this._delta),L.DomUtil.getScaleString(this._scale,this._startCenter)].join(" "),L.DomEvent.preventDefault(a)}},_onTouchEnd:function(){if(this._moved&&this._zooming){this._zooming=!1;var a=this._map.getZoom(),b=Math.log(this._scale)/Math.LN2,b=this._map._limitZoom(a+(b>0?Math.ceil(b):Math.floor(b))),a=b-a,c=this._centerOffset.subtract(this._delta).divideBy(this._scale),d=this._map.unproject(this._map.getPixelOrigin().add(this._startCenter).add(c));L.DomEvent.removeListener(document,"touchmove",this._onTouchMove),L.DomEvent.removeListener(document,"touchend",this._onTouchEnd),this._map._runAnimation(d,b,Math.pow(2,a)/this._scale,this._startCenter.add(c))}}}),L.Handler.ScrollWheelZoom=L.Handler.extend({enable:function(){this._enabled||(L.DomEvent.addListener(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0,this._enabled=!0)},disable:function(){this._enabled&&(L.DomEvent.removeListener(this._map._container,"mousewheel",this._onWheelScroll),this._enabled=!1)},_onWheelScroll:function(a){this._delta+=L.DomEvent.getWheelDelta(a),this._lastMousePos=this._map.mouseEventToContainerPoint(a),clearTimeout(this._timer),this._timer=setTimeout(L.Util.bind(this._performZoom,this),50),L.DomEvent.preventDefault(a)},_performZoom:function(){var a=Math.round(this._delta);this._delta=0;if(a){var b=this._getCenterForScrollWheelZoom(this._lastMousePos,a),a=this._map.getZoom()+a;this._map._limitZoom(a)!=this._map._zoom&&this._map.setView(b,a)}},_getCenterForScrollWheelZoom:function(a,b){var c=this._map.getPixelBounds().getCenter(),d=this._map.getSize().divideBy(2),d=a.subtract(d).multiplyBy(1-Math.pow(2,-b));return this._map.unproject(c.add(d),this._map._zoom,!0)}}),L.Handler.DoubleClickZoom=L.Handler.extend({enable:function(){this._enabled||(this._map.on("dblclick",this._onDoubleClick,this._map),this._enabled=!0)},disable:function(){this._enabled&&(this._map.off("dblclick",this._onDoubleClick,this._map),this._enabled=!1)},_onDoubleClick:function(a){this.setView(a.latlng,this._zoom+1)}}),L.Handler.ShiftDragZoom=L.Handler.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane},enable:function(){this._enabled||(L.DomEvent.addListener(this._container,"mousedown",this._onMouseDown,this),this._enabled=!0)},disable:function(){this._enabled&&(L.DomEvent.removeListener(this._container,"mousedown",this._onMouseDown),this._enabled=!1)},_onMouseDown:function(a){if(!a.shiftKey||a.which!=1&&a.button!=1)return!1;L.DomUtil.disableTextSelection(),this._startLayerPoint=this._map.mouseEventToLayerPoint(a),this._box=L.DomUtil.create("div","leaflet-zoom-box",this._pane),L.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",L.DomEvent.addListener(document,"mousemove",this._onMouseMove,this),L.DomEvent.addListener(document,"mouseup",this._onMouseUp,this),L.DomEvent.preventDefault(a)},_onMouseMove:function(a){var b=this._map.mouseEventToLayerPoint(a),a=b.x-this._startLayerPoint.x,c=b.y-this._startLayerPoint.y,b=new L.Point(Math.min(b.x,this._startLayerPoint.x),Math.min(b.y,this._startLayerPoint.y));L.DomUtil.setPosition(this._box,b),this._box.style.width=Math.abs(a)-4+"px",this._box.style.height=Math.abs(c)-4+"px"},_onMouseUp:function(a){this._pane.removeChild(this._box),this._container.style.cursor="",L.DomUtil.enableTextSelection(),L.DomEvent.removeListener(document,"mousemove",this._onMouseMove),L.DomEvent.removeListener(document,"mouseup",this._onMouseUp),a=this._map.mouseEventToLayerPoint(a),this._map.fitBounds(new L.LatLngBounds(this._map.layerPointToLatLng(this._startLayerPoint),this._map.layerPointToLatLng(a)))}}),L.Handler.MarkerDrag=L.Handler.extend({initialize:function(a){this._marker=a},enable:function(){this._enabled||(this._draggable||(this._draggable=new L.Draggable(this._marker._icon,this._marker._icon),this._draggable.on("dragstart",this._onDragStart,this),this._draggable.on("drag",this._onDrag,this),this._draggable.on("dragend",this._onDragEnd,this)),this._draggable.enable(),this._enabled=!0)},disable:function(){this._enabled&&(this._draggable.disable(),this._enabled=!1)},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup(),this._marker.fire("movestart"),this._marker.fire("dragstart")},_onDrag:function(){var a=L.DomUtil.getPosition(this._marker._icon);L.DomUtil.setPosition(this._marker._shadow,a),this._marker._latlng=this._marker._map.layerPointToLatLng(a),this._marker.fire("move"),this._marker.fire("drag")},_onDragEnd:function(){this._marker.fire("moveend"),this._marker.fire("dragend")}}),L.Control={},L.Control.Position={TOP_LEFT:"topLeft",TOP_RIGHT:"topRight",BOTTOM_LEFT:"bottomLeft",BOTTOM_RIGHT:"bottomRight"},L.Control.Zoom=L.Class.extend({onAdd:function(a){this._map=a,this._container=L.DomUtil.create("div","leaflet-control-zoom"),this._zoomInButton=this._createButton("Zoom in","leaflet-control-zoom-in",this._map.zoomIn,this._map),this._zoomOutButton=this._createButton("Zoom out","leaflet-control-zoom-out",this._map.zoomOut,this._map),this._container.appendChild(this._zoomInButton),this._container.appendChild(this._zoomOutButton)},getContainer:function(){return this._container},getPosition:function(){return L.Control.Position.TOP_LEFT},_createButton:function(a,b,c,d){var e=document.createElement("a");return e.href="#",e.title=a,e.className=b,L.DomEvent.disableClickPropagation(e),L.DomEvent.addListener(e,"click",L.DomEvent.preventDefault),L.DomEvent.addListener(e,"click",c,d),e}}),L.Control.Attribution=L.Class.extend({onAdd:function(a){this._container=L.DomUtil.create("div","leaflet-control-attribution"),this._map=a,this._prefix='Powered by <a href="http://leaflet.cloudmade.com">Leaflet</a>',this._attributions={},this._update()},getPosition:function(){return L.Control.Position.BOTTOM_RIGHT},getContainer:function(){return this._container},setPrefix:function(a){this._prefix=a},addAttribution:function(a){a&&(this._attributions[a]=!0,this._update())},removeAttribution:function(a){a&&(delete this._attributions[a],this._update())},_update:function(){if(this._map){var a=[],b;for(b in this._attributions)this._attributions.hasOwnProperty(b)&&a.push(b);b=[],this._prefix&&b.push(this._prefix),a.length&&b.push(a.join(", ")),this._container.innerHTML=b.join(" &mdash; ")}}}),L.Map=L.Class.extend({includes:L.Mixin.Events,options:{crs:L.CRS.EPSG3857||L.CRS.EPSG4326,scale:function(a){return 256*(1<<a)},center:null,zoom:null,layers:[],dragging:!0,touchZoom:L.Browser.mobileWebkit&&!L.Browser.android,scrollWheelZoom:!L.Browser.mobileWebkit,doubleClickZoom:!0,shiftDragZoom:!0,zoomControl:!0,attributionControl:!0,fadeAnimation:L.DomUtil.TRANSITION&&!L.Browser.android,zoomAnimation:L.DomUtil.TRANSITION&&!L.Browser.android&&!L.Browser.mobileOpera,trackResize:!0,closePopupOnClick:!0},initialize:function(a,b){L.Util.setOptions(this,b),this._container=L.DomUtil.get(a),this._initLayout(),L.DomEvent&&(this._initEvents(),L.Handler&&this._initInteraction(),L.Control&&this._initControls());var c=this.options.center,d=this.options.zoom;c!==null&&d!==null&&this.setView(c,d,!0),c=this.options.layers,c=c instanceof Array?c:[c],this._tileLayersNum=0,this._initLayers(c)},setView:function(a,b){return this._resetView(a,this._limitZoom(b)),this},setZoom:function(a){return this.setView(this.getCenter(),a)},zoomIn:function(){return this.setZoom(this._zoom+1)},zoomOut:function(){return this.setZoom(this._zoom-1)},fitBounds:function(a){var b=this.getBoundsZoom(a);return this.setView(a.getCenter(),b)},fitWorld:function(){var a=new L.LatLng(-60,-170),b=new L.LatLng(85,179);return this.fitBounds(new L.LatLngBounds(a,b))},panTo:function(a){return this.setView(a,this._zoom)},panBy:function(a){return this.fire("movestart"),this._rawPanBy(a),this.fire("move"),this.fire("moveend"),this},addLayer:function(a){var b=L.Util.stamp(a);return this._layers[b]?this:(this._layers[b]=a,a.options&&!isNaN(a.options.maxZoom)&&(this._layersMaxZoom=Math.max(this._layersMaxZoom||0,a.options.maxZoom)),a.options&&!isNaN(a.options.minZoom)&&(this._layersMinZoom=Math.min(this._layersMinZoom||Infinity,a.options.minZoom)),this.options.zoomAnimation&&L.TileLayer&&a instanceof L.TileLayer&&(this._tileLayersNum++,a.on("load",this._onTileLayerLoad,this)),this.attributionControl&&a.getAttribution&&this.attributionControl.addAttribution(a.getAttribution()),b=function(){a.onAdd(this),this.fire("layeradd",{layer:a})},this._loaded?b.call(this):this.on("load",b,this),this)},removeLayer:function(a){var b=L.Util.stamp(a);return this._layers[b]&&(a.onRemove(this),delete this._layers[b],this.options.zoomAnimation&&L.TileLayer&&a instanceof L.TileLayer&&(this._tileLayersNum--,a.off("load",this._onTileLayerLoad,this)),this.attributionControl&&a.getAttribution&&this.attributionControl.removeAttribution(a.getAttribution()),this.fire("layerremove",{layer:a})),this},invalidateSize:function(){return this._sizeChanged=!0,this.fire("move"),clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(L.Util.bind(function(){this.fire("moveend")},this),200),this},getCenter:function(a){var b=this.getSize().divideBy(2);return this.unproject(this._getTopLeftPoint().add(b),this._zoom,a)},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),b=this.unproject(new L.Point(a.min.x,a.max.y)),a=this.unproject(new L.Point(a.max.x,a.min.y));return new L.LatLngBounds(b,a)},getMinZoom:function(){return isNaN(this.options.minZoom)?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return isNaN(this.options.maxZoom)?this._layersMaxZoom||Infinity:this.options.maxZoom},getBoundsZoom:function(a){var b=this.getSize(),c=this.getMinZoom(),d=this.getMaxZoom(),e=a.getNorthEast(),a=a.getSouthWest(),f,g;do c++,f=this.project(e,c),g=this.project(a,c),f=new L.Point(f.x-g.x,g.y-f.y);while(f.x<=b.x&&f.y<=b.y&&c<=d);return c-1},getSize:function(){if(!this._size||this._sizeChanged)this._size=new L.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1;return this._size},getPixelBounds:function(){var a=this._getTopLeftPoint(),b=this.getSize();return new L.Bounds(a,a.add(b))},getPixelOrigin:function(){return this._initialTopLeftPoint},getPanes:function(){return this._panes},mouseEventToContainerPoint:function(a){return L.DomEvent.getMousePosition(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},containerPointToLayerPoint:function(a){return a.subtract(L.DomUtil.getPosition(this._mapPane))},layerPointToContainerPoint:function(a){return a.add(L.DomUtil.getPosition(this._mapPane))},layerPointToLatLng:function(a){return this.unproject(a.add(this._initialTopLeftPoint))},latLngToLayerPoint:function(a){return this.project(a)._subtract(this._initialTopLeftPoint)},project:function(a,b){return b=typeof b=="undefined"?this._zoom:b,this.options.crs.latLngToPoint(a,this.options.scale(b))},unproject:function(a,b,c){return b=typeof b=="undefined"?this._zoom:b,this.options.crs.pointToLatLng(a,this.options.scale(b),c)},_initLayout:function(){var a=this._container;a.className+=" leaflet-container",this.options.fadeAnimation&&(a.className+=" leaflet-fade-anim");var b=L.DomUtil.getStyle(a,"position");b!="absolute"&&b!="relative"&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._mapPane=a.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=a.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),this._objectsPane=a.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),a.shadowPane=this._createPane("leaflet-shadow-pane"),a.overlayPane=this._createPane("leaflet-overlay-pane"),a.markerPane=this._createPane("leaflet-marker-pane"),a.popupPane=this._createPane("leaflet-popup-pane")},_createPane:function(a,b){return L.DomUtil.create("div",a,b||this._objectsPane)},_resetView:function(a,b,c){var d=this._zoom!=b;this.fire("movestart"),this._zoom=b,this._initialTopLeftPoint=this._getNewTopLeftPoint(a),c?this._initialTopLeftPoint._add(L.DomUtil.getPosition(this._mapPane)):L.DomUtil.setPosition(this._mapPane,new L.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum,this.fire("viewreset"),this.fire("move"),d&&this.fire("zoomend"),this.fire("moveend"),this._loaded||(this._loaded=!0,this.fire("load"))},_initLayers:function(a){this._layers={};for(var b=0,c=a.length;b<c;b++)this.addLayer(a[b])},_initControls:function(){this.options.zoomControl&&this.addControl(new L.Control.Zoom),this.options.attributionControl&&(this.attributionControl=new L.Control.Attribution,this.addControl(this.attributionControl))},_rawPanBy:function(a){var b=L.DomUtil.getPosition(this._mapPane);L.DomUtil.setPosition(this._mapPane,b.subtract(a))},_initEvents:function(){L.DomEvent.addListener(this._container,"click",this._onMouseClick,this);for(var a=["dblclick","mousedown","mouseenter","mouseleave","mousemove"],b=0;b<a.length;b++)L.DomEvent.addListener(this._container,a[b],this._fireMouseEvent,this);this.options.trackResize&&L.DomEvent.addListener(window,"resize",this.invalidateSize,this)},_onMouseClick:function(a){if(!this.dragging||!this.dragging.moved())this.fire("pre"+a.type),this._fireMouseEvent(a)},_fireMouseEvent:function(a){var b=a.type,b=b=="mouseenter"?"mouseover":b=="mouseleave"?"mouseout":b;this.hasEventListeners(b)&&this.fire(b,{latlng:this.mouseEventToLatLng(a),layerPoint:this.mouseEventToLayerPoint(a)})},_initInteraction:function(){var a={dragging:L.Handler.MapDrag,touchZoom:L.Handler.TouchZoom,doubleClickZoom:L.Handler.DoubleClickZoom,scrollWheelZoom:L.Handler.ScrollWheelZoom,shiftDragZoom:L.Handler.ShiftDragZoom},b;for(b in a)a.hasOwnProperty(b)&&a[b]&&(this[b]=new a[b](this),this.options[b]&&this[b].enable())},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this._tileBg&&(clearTimeout(this._clearTileBgTimer),this._clearTileBgTimer=setTimeout(L.Util.bind(this._clearTileBg,this),500))},_getTopLeftPoint:function(){if(!this._loaded)throw Error("Set map center and zoom first.");return this._initialTopLeftPoint.subtract(L.DomUtil.getPosition(this._mapPane))},_getNewTopLeftPoint:function(a){var b=this.getSize().divideBy(2);return this.project(a).subtract(b).round()},_limitZoom:function(a){var b=this.getMinZoom(),c=this.getMaxZoom();return Math.max(b,Math.min(c,a))}}),L.Map.include({locate:function(a){var b={timeout:1e4};return L.Util.extend(b,a),navigator.geolocation?navigator.geolocation.getCurrentPosition(L.Util.bind(this._handleGeolocationResponse,this),L.Util.bind(this._handleGeolocationError,this),b):this.fire("locationerror",{code:0,message:"Geolocation not supported."}),this},locateAndSetView:function(a,b){return this._setViewOnLocate=!0,this._maxLocateZoom=a||Infinity,this.locate(b)},_handleGeolocationError:function(a){var a=a.code,b=a==1?"permission denied":a==2?"position unavailable":"timeout";this._setViewOnLocate&&(this.fitWorld(),this._setViewOnLocate=!1),this.fire("locationerror",{code:a,message:"Geolocation error: "+b+"."})},_handleGeolocationResponse:function(a){var b=180*a.coords.accuracy/4e7,c=b*2,d=a.coords.latitude,e=a.coords.longitude,f=new L.LatLng(d-b,e-c),b=new L.LatLng(d+b,e+c),f=new L.LatLngBounds(f,b);this._setViewOnLocate&&(b=Math.min(this.getBoundsZoom(f),this._maxLocateZoom),this.setView(f.getCenter(),b),this._setViewOnLocate=!1),this.fire("locationfound",{latlng:new L.LatLng(d,e),bounds:f,accuracy:a.coords.accuracy})}}),L.Map.include({openPopup:function(a){return this.closePopup(),this._popup=a,this.addLayer(a)},closePopup:function(){return this._popup&&this.removeLayer(this._popup),this}}),L.Map.include(!L.Transition||!L.Transition.implemented()?{}:{setView:function(a,b,c){var b=this._limitZoom(b),d=this._zoom!=b;return this._loaded&&!c&&this._layers&&(c=this._getNewTopLeftPoint(a).subtract(this._getTopLeftPoint()),d?this._zoomToIfCenterInView&&this._zoomToIfCenterInView(a,b,c):this._panByIfClose(c))?this:(this._resetView(a,b),this)},panBy:function(a){return this._panTransition||(this._panTransition=new L.Transition(this._mapPane,{duration:.3}),this._panTransition.on("step",this._onPanTransitionStep,this),this._panTransition.on("end",this._onPanTransitionEnd,this)),this.fire(this,"movestart"),this._panTransition.run({position:L.DomUtil.getPosition(this._mapPane).subtract(a)}),this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){this.fire("moveend")},_panByIfClose:function(a){return this._offsetIsWithinView(a)?(this.panBy(a),!0):!1},_offsetIsWithinView:function(a,b){var c=b||1,d=this.getSize();return Math.abs(a.x)<=d.x*c&&Math.abs(a.y)<=d.y*c}}),L.Map.include(L.DomUtil.TRANSITION?{_zoomToIfCenterInView:function(a,b,c){if(this._animatingZoom)return!0;if(!this.options.zoomAnimation)return!1;var d=Math.pow(2,b-this._zoom),c=c.divideBy(1-1/d);return this._offsetIsWithinView(c,1)?(this._mapPane.className+=" leaflet-zoom-anim",c=this.containerPointToLayerPoint(this.getSize().divideBy(2)).add(c),this._prepareTileBg(),this._runAnimation(a,b,d,c),!0):!1},_runAnimation:function(a,b,c,d){this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=b,a=L.DomUtil.TRANSFORM;if(L.Browser.gecko||window.opera)this._tileBg.style[a]+=" translate(0,0)";L.Browser.android?(this._tileBg.style[a+"Origin"]=d.x+"px "+d.y+"px",c="scale("+c+")"):c=L.DomUtil.getScaleString(c,d),L.Util.falseFn(this._tileBg.offsetWidth),d={},d[a]=this._tileBg.style[a]+" "+c,this._tileBg.transition.run(d)},_prepareTileBg:function(){this._tileBg||(this._tileBg=this._createPane("leaflet-tile-pane",this._mapPane),this._tileBg.style.zIndex=1);var a=this._tilePane,b=this._tileBg;b.style[L.DomUtil.TRANSFORM]="",b.style.visibility="hidden",b.empty=!0,a.empty=!1,this._tilePane=this._panes.tilePane=b,this._tileBg=a,this._tileBg.transition||(this._tileBg.transition=new L.Transition(this._tileBg,{duration:.3,easing:"cubic-bezier(0.25,0.1,0.25,0.75)"}),this._tileBg.transition.on("end",this._onZoomTransitionEnd,this)),this._stopLoadingBgTiles()},_stopLoadingBgTiles:function(){for(var a=[].slice.call(this._tileBg.getElementsByTagName("img")),b=0,c=a.length;b<c;b++)a[b].complete||(a[b].src="",a[b].parentNode.removeChild(a[b]))},_onZoomTransitionEnd:function(){this._restoreTileFront(),L.Util.falseFn(this._tileBg.offsetWidth),this._resetView(this._animateToCenter,this._animateToZoom,!0),this._mapPane.className=this._mapPane.className.replace(" leaflet-zoom-anim",""),this._animatingZoom=!1},_restoreTileFront:function(){this._tilePane.innerHTML="",this._tilePane.style.visibility="",this._tilePane.style.zIndex=2,this._tileBg.style.zIndex=1},_clearTileBg:function(){!this._animatingZoom&&!this.touchZoom._zooming&&(this._tileBg.innerHTML="")}}:{}),L.Map.include({addControl:function(a){a.onAdd(this);var b=a.getPosition(),c=this._controlCorners[b],a=a.getContainer();return L.DomUtil.addClass(a,"leaflet-control"),b.indexOf("bottom")!=-1?c.insertBefore(a,c.firstChild):c.appendChild(a),this},removeControl:function(a){var b=this._controlCorners[a.getPosition()],c=a.getContainer();return b.removeChild(c),a.onRemove&&a.onRemove(this),this},_initControlPos:function(){var a=this._controlCorners={},b=L.DomUtil.create("div","leaflet-control-container",this._container);L.Browser.mobileWebkit&&(b.className+=" leaflet-big-buttons"),a.topLeft=L.DomUtil.create("div","leaflet-top leaflet-left",b),a.topRight=L.DomUtil.create("div","leaflet-top leaflet-right",b),a.bottomLeft=L.DomUtil.create("div","leaflet-bottom leaflet-left",b),a.bottomRight=L.DomUtil.create("div","leaflet-bottom leaflet-right",b)}}),define("web/js/lib/leaflet/leaflet",function(){}),this.zeega={module:function(){var a={};return function(b){return a[b]?a[b]:a[b]={Views:{}}}}(),app:_.extend({currentFrame:null,previewMode:!0,init:function(){this.url_prefix=sessionStorage.getItem("hostname")+sessionStorage.getItem("directory"),this.loadModules(),this.isLoaded=!0},loadModules:function(){console.log("load modules"),this.data=$.parseJSON(projectJSON),console.log(this.data),this.player=new Player2($("body")),this.player.loadProject(this.data.project)}},Backbone.Events)},define("web/js/app/zeega.project-viewer",function(){});var Player2=Backbone.View.extend({MINIMUM_LOAD:3e3,has_started:!1,loadAheadDistance:2,overlaysHidden:!1,viewportRatio:1.5,zeega:!0,apiplayer:!1,initialize:function(a,b){this.model=new Backbone.Model,this.container=a,this.generateBackbone(),_.isUndefined(zeega.app.router)&&(this.zeega=!1),_.isUndefined(b)||(this.apiplayer=b)},loadProject:function(a,b){this.container.prepend(this.render().el),$("#wrapper").hide(),$(this.el).fadeIn(),this.initListeners(),this.data=a,this.parseData(a);var c=_.isUndefined(b)||_.isUndefined(b.sequenceID)?a.sequences[0].id:b.sequenceID,d=_.isUndefined(b)||_.isUndefined(b.frameID)?_.find(a.sequences,function(a){return a.id==c}).frames[0]:b.frameID;this.setCurrentSequence(c),this.setCurrentFrame(d),_.isUndefined(zeega.app.router)?(this.startRouter(),this.updateTitle()):(this.router=zeega.app.router,this.goToFrame(this.currentFrame))},loadProjectById:function(a,b){var c=this;this.model.on("sequences_loaded",function(){c.render(),c.setCurrentSequence(c.initial_s),c.setCurrentFrame(c.initial_f),c.setCurrentLayers(),c.goToFrame(c.currentFrame)}),$.getJSON(sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"api/projects/"+a,function(a){c.sequences=new c.Sequences(a.project.sequences),c.initial_s=_.isUndefined(b)||_.isUndefined(b.sequenceID)?a.project.sequences[0].id:b.sequenceID,c.initial_f=_.isUndefined(b)||_.isUndefined(b.frameID)?_.find(a.project.sequences,function(a){return a.id==c.initial_s}).frames[0].id:b.frameID,c.model.trigger("sequences_loaded")})},startRouter:function(){var a=this,b=Backbone.Router.extend({routes:{"":"goToCurrentFrame","player/sequence/:sequenceID/frame/:frameID":"goToSequenceFrame"},goToSequenceFrame:function(b,c){a.goToSequenceFrame(b,c)},goToCurrentFrame:function(){a.goToFrame(a.currentFrame)}});this.router=new b,Backbone.history.start()},updateTitle:function(){$("title").html(this.data.title)},goToSequenceFrame:function(a,b){this.currentSequence=this.sequences.get(a),this.goToFrame(this.frames.get(b))},goToFrame:function(a){this.clearStage(a);if(a.status=="ready")this.renderFrame(a.id);else{var b=this;console.log("frame needs a little bit more to load"),a.on("ready",function(){b.has_played?b.renderFrame(a.id):setTimeout(function(){a.loader.fadeOut(),b.startTimer=setTimeout(function(){b.renderFrame(a.id),b.has_played=!0},1e3)},2e3)})}this.router.navigate("player/sequence/"+this.currentSequence.id+"/frame/"+a.id),this.loadAhead()},clearStage:function(a){if(this.currentFrame.id!=a.id){var b=this,c=this.currentFrame.get("layers"),d=a.get("layers"),e=_.difference(c,d);_.each(e,function(a){b.layers.get(a).trigger("player_exit")})}},renderFrame:function(a){var b=this,c=this.frames.get(a);c.off("ready",this.renderFrame),this.currentFrame=c,_.each(c.get("layers"),function(a,c){b.layers.get(a).trigger("player_play",c+1)}),this.setAdvance(c.get("attr").advance),this.updateCitations(),this.updateArrows()},loadAhead:function(){console.log("LOAD AHEAD ON SEQUENCE: "+this.currentSequence.id);var a=this.currentSequence.get("frames")||_.pluck(_.toArray(this.currentSequence.frames),"id");this.currentSequence.set("frames",a);var b=_.indexOf(a,this.currentFrame.id);for(var c=0;c<this.loadAheadDistance*2+1;c++){var d=Math.ceil(c/2)*(-1+2*(c%2)),e=b+d;if(e>=0&&e<a.length){var f=a[e],g=this.frames.get(f);g.status!="loading"&&g.status!="ready"&&this.preloadFrame(g)}}},preloadFrame:function(a){var b=this;this.currentFrame==a&&$("#zeega-player").prepend(a.loader.render().el);var c=[];_.each(a.links,function(a){c=_.union(b.frames.get(a).get("layers"),c)}),console.log("preload layers: "+_.union(c,a.get("layers"))),_.each(_.union(c,a.get("layers")),function(c){var d=b.layers.get(c);d.status!="loading"&&a.status!="ready"&&b.preloadLayer(d)}),a.trigger("loading",a.id)},preloadLayer:function(a){a.trigger("loading",a.id),this.$el.find("#preview-media").append(a.visual.render().el),a.trigger("player_preload")},setAdvance:function(a){var b=this;this.t&&clearTimeout(this.t),a!=-1&&(a==0?_.each(_.toArray(this.currentLayers),function(a){a.on("playback_ended",function(){b.goRight()})}):a>0&&(a=a<1?1:a,this.t=setTimeout(function(){b.goRight()},a)))},goLeft:function(){var a=this.getLeft();a&&this.goToFrame(a)},goRight:function(){var a=this.getRight();a&&this.goToFrame(a)},getLeft:function(a){_.isUndefined(a)&&(a=1);var b=this.currentSequence.get("frames"),c=_.indexOf(b,this.currentFrame.id);return c-a<0?!1:this.frames.get(b[c-a])},getRight:function(a){a=a||1;var b=this.currentSequence.get("frames"),c=_.indexOf(b,this.currentFrame.id);return this.frames.get(b[c+a])||!1},updateCitations:function(){var a=this,b=Backbone.View.extend({tagName:"li",className:"clearfix",render:function(){$(this.el).html(_.template(this.getTemplate(),this.model.attributes))},events:{click:"expandCitation"},expandCitation:function(a){a.stopPropagation(),$("#citation").animate({height:"100px"}),this.closeOtherCitations(),this.$el.find(".citation-content").is(":hidden")?this.$el.find(".citation-content").show():(this.$el.find(".citation-content").hide(),this.closeCitationBar())},closeOtherCitations:function(){var a=this;_.each($(".citation-content"),function(b){$(b).is(":visible")&&b!=a.$el.find(".citation-content")[0]&&$(b).hide()})},closeCitation:function(){this.$el.find(".citation-content").is(":visible")&&this.$el.find(".citation-content").hide()},expandCitationBar:function(){$("#citation").animate({height:"100px"})},closeCitationBar:function(){$("#citation").animate({height:"24px"})},getTemplate:function(){var a='<div class="citation-tab"><i class="zicon-<%= type.toLowerCase() %>"></i></div><div class="citation-content" style="display:none"><div class="citation-thumb"><img width="100%" height="100%" src="<%= attr.thumbnail_url %>"/></div><div class="citation-body"><div class="citation-title"><%= attr.title %></div><div class="citation-metadata"><a href="<%= attr.attribution_uri %>" target="blank">Link to original</a></div></div></div>';return a}});this.$el.find("#citation ul").empty(),_.each(this.currentFrame.get("layers"),function(c){var d=a.layers.get(c);!d.citation&&d.displayCitation&&(d.citation=new b({model:d})),d.citation&&(d.citation.render(),a.$el.find("#citation ul").append(d.citation.el))})},closePlayer:function(){var a=this;$("#wrapper").show(),this.unsetListeners(),_.each(_.toArray(this.currentSequence.layers),function(a){a.rendered&&a.trigger("player_unrender")}),this.zeega&&zeega.app.restoreFromPreview(),this.$el.fadeOut(450,function(){$(this).remove()})},render:function(){if(this.apiplayer)var a=this.container.width(),b=this.container.height();else var a=window.innerWidth,b=window.innerHeight;var c={};return a/b>this.viewportRatio?(c.height=b+"px",c.width=b*this.viewportRatio+"px",c.fontSize=b/519*100+"%"):(c.height=a/this.viewportRatio+"px",c.width=a+"px",c.fontSize=a/704*100+"%"),$(this.el).attr("id","preview-wrapper").append(this.getTemplate()),$(this.el).find("#preview-media").css(c),this},updateArrows:function(){var a=this.getLeft(),b=this.getRight();this.currentSequence.get("frames").length<2?(this.$el.find("#preview-left").hide(),this.$el.find("#preview-right").hide()):this.overlaysHidden||(a?this.$el.find("#preview-left").is(":hidden")&&this.$el.find("#preview-left").fadeIn():this.$el.find("#preview-left").fadeOut(),b?this.$el.find("#preview-right").is(":hidden")&&this.$el.find("#preview-right").fadeIn():this.$el.find("#preview-right").fadeOut())},fadeOutOverlays:function(a){a.overlaysHidden=!0},initListeners:function(){var a=this;$(window).bind("keydown",function(b){switch(b.which){case 27:a.zeega&&a.closePlayer();break;case 8:a.zeega&&a.closePlayer();break;case 37:a.goLeft();break;case 39:a.goRight();break;case 38:a.goUp();break;case 40:a.goDown();break;case 32:a.playPause()}}),this.apiplayer||(window.onresize=function(b){var c=window.innerWidth,d=window.innerHeight,e={};c/d>a.viewportRatio?(e.height=d+"px",e.width=d*a.viewportRatio+"px"):(e.height=c/a.viewportRatio+"px",e.width=c+"px"),a.$el.find("#preview-media").clearQueue().animate(e,500)}),$("#zeega-player").keydown(function(a){});var b=_.debounce(this.fadeOutOverlays,5e3);onmousemove=function(){a.overlaysHidden?(a.overlaysHidden=!1,$(".player-overlay").fadeIn("slow"),a.updateArrows()):b(a)}},unsetListeners:function(){$(window).unbind("keydown"),onmousemove=null},events:{"click #preview-left":"goLeft","click #preview-right":"goRight","click #preview-close":"closePlayer"},parseData:function(a){this.sequences=new this.Sequences(a.sequences);var b=zeega.module("layer"),c=[];_.each(a.layers,function(a){var d=new b[a.type](a,{player:!0});d.id=parseInt(d.id),c.push(d)}),this.layers=new this.LayerCollection(c),this.frames=new this.FrameCollection(a.frames),this.frames.addFrameLoadersAndConnections(),this.layers.on("ready",this.updateFrameStatus,this),this.model.trigger("sequences_loaded")},setCurrentSequence:function(a){this.currentSequence=this.sequences.get(a)},setCurrentFrame:function(a){this.currentFrame=this.frames.get(a)},updateFrameStatus:function(a){var b=this;_.each(_.toArray(this.frames),function(c){var d=c.get("layers"),e=b.layers.ready;_.include(d,a)&&c.loader.incrementLoaded(a),_.difference(d,e).length==0&&c.trigger("ready",c.id)})},generateBackbone:function(){var a=this,b=Backbone.Model.extend(),c=Backbone.Model.extend(),d=Backbone.View.extend({className:"progress-bar",loadedCount:0,initialize:function(){},render:function(){var b=this;return $(this.el).css("z-index",1e5),this.model.get("layers").length>0&&($(this.el).append(_.template(this.getTemplate(),a.data)),this.$el.find(".progress-types ul").empty(),_.each(this.model.get("layers"),function(c){var d=a.layers.get(c);console.log(d),console.log("load layer type: "+d.get("type")),d.get("type")!="Link"&&(d.get("type")=="Geo"||!_.isUndefined(d.get("attr").archive))&&(console.log("load layer type: "+d.get("type")),b.$el.find(".progress-types ul").append('<li class="layer-load-icon-'+d.id+'"><i class="zitem-'+d.get("attr").archive.toLowerCase()+'"></i></li>'))}),$(this.el).find(".bar").stop().animate({width:.25/this.model.get("layers").length*100+"%"},200).animate({width:.75/this.model.get("layers").length*100+"%"},1e5)),this},incrementLoaded:function(a){var b=this;this.loadedCount++,this.$el.find(".layer-load-icon-"+a+" i").addClass("loaded"),$(this.el).find(".bar").stop().animate({width:this.loadedCount/this.model.get("layers").length*100+"%"},2e3).animate({width:this.loadedCount*1.5/this.model.get("layers").length*100+"%"},1e5),this.model.get("layers").length==this.loadedCount&&b.has_played&&this.fadeOut()},fadeOut:function(){var a=this;$(this.el).fadeOut("show",function(){a.remove()})},getTemplate:function(){return html="<div class='progress-head'><h3 class='estimate'>Estimated load time. . .</h3><h3 class='time'><%= estimated_time %></h3></div><div class='progress progress-striped active progress-danger'><div class='bar' style='width:0'></div></div><div class='progress-types'><ul></ul></div>",html}});this.LayerCollection=Backbone.Collection.extend({loading:[],ready:[],initialize:function(){this.on("loading",this.updateLoadingStatus,this),this.on("ready",this.updateReadyStatus,this)},updateLoadingStatus:function(a){var b=this.get(a);b.status!="loading"&&b.status!="ready"&&(b.status="loading",this.loading.push(a))},updateReadyStatus:function(a){var b=this.get(a);b.status!="ready"&&(this.loading=_.without(this.loading,a),b.status="ready",this.ready.push(a))}}),this.FrameCollection=this.LayerCollection.extend({addFrameLoadersAndConnections:function(){_.each(_.toArray(this),function(b){b.loader=new d({model:b});var c=[];_.each(b.get("layers"),function(d){var e=a.layers.get(d);e.get("type")=="Link"&&e.get("attr").from_frame==b.id&&c.push(e.get("attr").to_frame)}),b.links=c})}});var e=Backbone.Model.extend({initialize:function(){this.parseData()},parseData:function(){},updateFrameStatus:function(a){var b=this;_.each(_.toArray(this.frames),function(c){var d=c.get("layers"),e=b.layers.ready;_.include(d,a)&&c.loader.incrementLoaded(),_.difference(d,e).length==0&&c.trigger("ready",c.id)})}});this.Sequences=Backbone.Collection.extend({model:e,initialize:function(){}})},getTemplate:function(){return html="<div id='zeega-player'>",this.zeega&&(html+="<div id='preview-close' class='player-overlay'><a href='#'><span class='zicon orange zicon-close' ></span></a></div>"),html+="<div id='preview-left' class='hidden preview-nav-arrow preview-nav'><div class='arrow-background'></div><img class='player-arrow arrow-left' src='"+sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"images/mediaPlayerArrow_shadow.png"+"'>"+"</div>"+"<div id='preview-right' class='hidden preview-nav-arrow preview-nav'>"+"<div class='arrow-background'></div>"+"<img class='player-arrow arrow-right' src='"+sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"images/mediaPlayerArrow_shadow.png"+"'>"+"</div>"+"<div id='preview-media'></div>"+"<div id='citation' class='player-overlay'><ul class='clearfix'></ul></div>",html}});define("web/js/app/zeega.player",function(){});var LayerGlobals=new Array;String.prototype.toCapitalCase=function(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()},Storage.prototype.setObject=function(a,b){this.setItem(a,JSON.stringify(b))},Storage.prototype.getObject=function(a){var b=this.getItem(a);return b&&JSON.parse(b)},String.prototype.toRGB=function(){var a=function(a){return a.charAt(0)=="#"?a.substring(1,7):a},b="";return b+=parseInt(a(this).substring(0,2),16)+",",b+=parseInt(a(this).substring(2,4),16)+",",b+=parseInt(a(this).substring(4,6),16),b},define("web/js/helpers/zeega.helpers",function(){}),function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(c){function g(){!a&&this.init&&this.init.apply(this,arguments)}var d=this.prototype;a=!0;var e=new this;a=!1;for(var f in c)e[f]=typeof c[f]=="function"&&typeof d[f]=="function"&&b.test(c[f])?function(a,b){return function(){var c=this._super;this._super=d[a];var e=b.apply(this,arguments);return this._super=c,e}}(f,c[f]):c[f];return g.prototype=e,g.prototype.constructor=g,g.extend=arguments.callee,g}}(),define("web/js/helpers/zeega.extends",function(){}),function(a,b,c){function d(a){var b={x:a.offsetLeft,y:a.offsetTop};while(a=a.offsetParent)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}function e(a,b){for(var d in b)a[d]===c&&(a[d]=b[d]);return a}function f(a,b){for(var c in b)a.style[g(a,c)||c]=b[c];return a}function g(a,b){var d=a.style,e,f;if(d[b]!==c)return b;b=b.charAt(0).toUpperCase()+b.slice(1);for(f=0;f<k.length;f++){e=k[f]+b;if(d[e]!==c)return e}}function h(a,b,c,d){var e=["opacity",b,~~(a*100),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=m.substring(0,m.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return l[e]||(n.insertRule("@"+i+"keyframes "+e+"{"+"0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}"+"100%{opacity:"+g+"}"+"}",0),l[e]=1),e}function i(a,b,c){return c&&!c.parentNode&&i(a,c),a.insertBefore(b,c||null),a}function j(a,c){var d=b.createElement(a||"div"),e;for(e in c)d[e]=c[e];return d}var k=["webkit","Moz","ms","O"],l={},m;i(b.getElementsByTagName("head")[0],j("style"));var n=b.styleSheets[b.styleSheets.length-1],o=function q(a){if(!this.spin)return new q(a);this.opts=e(a||{},{lines:12,length:7,width:5,radius:10,color:"#000",speed:1,trail:100,opacity:.25,fps:20})},p=o.prototype={spin:function(a){this.stop();var b=this,c=b.el=f(j(),{position:"relative"}),e,g;a&&(g=d(i(a,c,a.firstChild)),e=d(c),f(c,{left:(a.offsetWidth>>1)-e.x+g.x+"px",top:(a.offsetHeight>>1)-e.y+g.y+"px"})),c.setAttribute("aria-role","progressbar"),b.lines(c,b.opts);if(!m){var h=b.opts,k=0,l=h.fps,n=l/h.speed,o=(1-h.opacity)/(n*h.trail/100),p=n/h.lines;(function q(){k++;for(var a=h.lines;a;a--){var d=Math.max(1-(k+a*p)%n*o,h.opacity);b.opacity(c,h.lines-a,d,h)}b.timeout=b.el&&setTimeout(q,~~(1e3/l))})()}return b},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=c),this}};p.lines=function(a,b){function c(a,c){return f(j(),{position:"absolute",width:b.length+b.width+"px",height:b.width+"px",background:a,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/b.lines*d)+"deg) translate("+b.radius+"px"+",0)",borderRadius:(b.width>>1)+"px"})}var d=0,e;for(;d<b.lines;d++)e=f(j(),{position:"absolute",top:1+~(b.width/2)+"px",transform:"translate3d(0,0,0)",opacity:b.opacity,animation:m&&h(b.opacity,b.trail,d,b.lines)+" "+1/b.speed+"s linear infinite"}),b.shadow&&i(e,f(c("#000","0 0 4px #000"),{top:"2px"})),i(a,i(e,c(b.color,"0 0 1px rgba(0,0,0,.1)")));return a},p.opacity=function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)},function(){var a=f(j("group"),{behavior:"url(#default#VML)"}),b;if(!g(a,"transform")&&a.adj){for(b=4;b--;)n.addRule(["group","roundrect","fill","stroke"][b],"behavior:url(#default#VML)");p.lines=function(a,b){function c(a,c,g){i(h,i(f(d(),{rotation:360/b.lines*a+"deg",left:~~c}),i(f(j("roundrect",{arcsize:1}),{width:e,height:b.width,left:b.radius,top:-b.width>>1,filter:g}),j("fill",{color:b.color,opacity:b.opacity}),j("stroke",{opacity:0}))))}function d(){return f(j("group",{coordsize:g+" "+g,coordorigin:-e+" "+ -e}),{width:g,height:g})}var e=b.length+b.width,g=2*e,h=d(),k=~(b.length+b.radius+b.width)+"px",l;if(b.shadow)for(l=1;l<=b.lines;l++)c(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=b.lines;l++)c(l);return i(f(a,{margin:k+" 0 0 "+k,zoom:1}),h)},p.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}else m=g(a,"animation")}(),a.Spinner=o}(window,document),define("web/js/lib/spin",function(){}),function(a){a.fn.spin=function(b,c){var d={tiny:{lines:9,length:3,width:2,radius:4},small:{lines:8,length:4,width:3,radius:5},large:{lines:10,length:8,width:4,radius:8},slow:{lines:6,length:3,width:2,radius:4,speed:.5}};if(Spinner)return this.each(function(){var e=a(this),f=e.data();f.spinner&&(f.spinner.stop(),delete f.spinner),b!==!1&&(typeof b=="string"&&(b in d?b=d[b]:b={},c&&(b.color=c)),f.spinner=(new Spinner(a.extend({color:e.css("color")},b))).spin(this))});throw"Spinner class not available."}}(jQuery),define("web/js/lib/jquery/plugins/spin",function(){}),function(a,b){function s(a,b){return function(){if(r.plugin.debug)return a.apply(this,arguments);try{return a.apply(this,arguments)}catch(c){r.plugin.errors.push({plugin:b,thrown:c,source:a.toString()}),this.trigger("error",r.plugin.errors)}}}function v(a){var b=typeof a=="string"?a:[a.language,a.region].join("-"),c=b.split("-");return{iso6391:b,language:c[0]||"",region:c[1]||""}}function x(){var a,b=[];if(Object.keys)b=Object.keys(r.p);else for(a in r.p)h.call(r.p,a)&&b.push(a);return b.join(",").toLowerCase().split(",")}if(!b.addEventListener){a.Popcorn={isSupported:!1};var c="forEach extend effects error guid sizeOf isArray nop position disable enable destroy addTrackEvent removeTrackEvent getTrackEvents getTrackEvent getLastTrackEventId timeUpdate plugin removePlugin compose effect parser xhr getJSONP getScript".split(/\s+/);while(c.length)a.Popcorn[c.shift()]=function(){};return}var d=Array.prototype,e=Object.prototype,f=d.forEach,g=d.slice,h=e.hasOwnProperty,i=e.toString,j=a.Popcorn,k=/^(#([\w\-\_\.]+))$/,l=[],m=!1,n=!1,o={events:{hash:{},apis:{}}},p=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(b,c){a.setTimeout(b,16)}}(),q=function(a){var b=a.media.currentTime,c=a.options.frameAnimation,d=a.data.disabled,e=a.data.trackEvents,f=e.animating,g=e.startIndex,h=r.registryByName,i=0,j,k,l;g=Math.min(g+1,e.byStart.length-2);while(g>0&&e.byStart[g]){j=e.byStart[g],k=j._natives,l=k&&k.type;if(!k||!!h[l]||!!a[l])j.start<=b&&j.end>b&&d.indexOf(l)===-1?j._running||(j._running=!0,k.start.call(a,null,j),c&&j&&j._running&&j.natives.frame&&k.frame.call(a,null,j,b)):j._running===!0&&(j._running=!1,k.end.call(a,null,j),c&&j._natives.frame&&(i=f.indexOf(j),i>=0&&f.splice(i,1)));g--}},r=function(a,b){return new r.p.init(a,b||null)};r.version="1.1.2",r.isSupported=!0,r.instances=[],r.p=r.prototype={init:function(c,d){var e;if(typeof c=="function"){if(b.readyState==="interactive"||b.readyState==="complete"){c(b,r);return}l.push(c);if(!m){m=!0;var f=function(){n=!0,b.removeEventListener("DOMContentLoaded",f,!1);for(var a=0,c=l.length;a<c;a++)l[a].call(b,r);l=null};b.addEventListener("DOMContentLoaded",f,!1)}return}e=k.exec(c),this.media=e&&e.length&&e[2]?b.getElementById(e[2]):c,this[this.media.nodeName&&this.media.nodeName.toLowerCase()||"video"]=this.media,r.instances.push(this),this.options=d||{},this.isDestroyed=!1,this.data={timeUpdate:r.nop,disabled:[],events:{},hooks:{},history:[],state:{volume:this.media.volume},trackRefs:{},trackEvents:{byStart:[{start:-1,end:-1}],byEnd:[{start:-1,end:-1}],animating:[],startIndex:0,endIndex:0,previousUpdateTime:-1}};var g=function(b){var c,d;b.media.readyState>=2?(c=b.media.duration,d=c!=c?Number.MAX_VALUE:c+1,r.addTrackEvent(b,{start:d,end:d}),b.options.frameAnimation?(b.data.timeUpdate=function(){r.timeUpdate(b,{}),b.trigger("timeupdate"),!b.isDestroyed&&p(b.data.timeUpdate)},!b.isDestroyed&&p(b.data.timeUpdate)):(b.data.timeUpdate=function(a){r.timeUpdate(b,a)},b.isDestroyed||b.media.addEventListener("timeupdate",b.data.timeUpdate,!1))):a.setTimeout(function(){g(b)},1)};return g(this),this}},r.p.init.prototype=r.p,r.forEach=function(a,b,c){if(!a||!b)return{};c=c||this;var d,e;if(f&&a.forEach===f)return a.forEach(b,c);if(i.call(a)==="[object NodeList]"){for(d=0,e=a.length;d<e;d++)b.call(c,a[d],d,a);return a}for(d in a)h.call(a,d)&&b.call(c,a[d],d,a);return a},r.extend=function(a){var b=a,c=g.call(arguments,1);return r.forEach(c,function(a){for(var c in a)b[c]=a[c]}),b},r.extend(r,{noConflict:function(b){return b&&(a.Popcorn=j),r},error:function(a){throw new Error(a)},guid:function(a){return r.guid.counter++,(a?a:"")+(+(new Date)+r.guid.counter)},sizeOf:function(a){var b=0;for(var c in a)b++;return b},isArray:Array.isArray||function(a){return i.call(a)==="[object Array]"},nop:function(){},position:function(c){var d=c.getBoundingClientRect(),e={},f=c.ownerDocument,g=b.documentElement,h=b.body,i,j,k,l,m,n;i=g.clientTop||h.clientTop||0,j=g.clientLeft||h.clientLeft||0,k=a.pageYOffset&&g.scrollTop||h.scrollTop,l=a.pageXOffset&&g.scrollLeft||h.scrollLeft,m=Math.ceil(d.top+k-i),n=Math.ceil(d.left+l-j);for(var o in d)e[o]=Math.round(d[o]);return r.extend({},e,{top:m,left:n})},disable:function(a,b){var c=a.data.disabled;return c.indexOf(b)===-1&&c.push(b),q(a),a},enable:function(a,b){var c=a.data.disabled,d=c.indexOf(b);return d>-1&&c.splice(d,1),q(a),a},destroy:function(a){var b=a.data.events,c,d,e;for(d in b){c=b[d];for(e in c)delete c[e];b[d]=null}a.isDestroyed||(a.data.timeUpdate&&a.media.removeEventListener("timeupdate",a.data.timeUpdate,!1),a.isDestroyed=!0)}}),r.guid.counter=1,r.extend(r.p,function(){var a="load play pause currentTime playbackRate volume duration preload playbackRate autoplay loop controls muted buffered readyState seeking paused played seekable ended",b={};return r.forEach(a.split(/\s+/g),function(a){b[a]=function(b){return typeof this.media[a]=="function"?(b!=null&&/play|pause/.test(a)&&(this.media.currentTime=r.util.toSeconds(b)),this.media[a](),this):b!=null?(this.media[a]=b,this):this.media[a]}}),b}()),r.forEach("enable disable".split(" "),function(a){r.p[a]=function(b){return r[a](this,b)}}),r.extend(r.p,{roundTime:function(){return-~this.media.currentTime},exec:function(a,b){return r.addTrackEvent(this,{start:a,end:a+1,_running:!1,_natives:{start:b||r.nop,end:r.nop,type:"exec"}}),this},mute:function(a){var b=a==null||a===!0?"muted":"unmuted";return b==="unmuted"&&(this.media.muted=!1,this.media.volume=this.data.state.volume),b==="muted"&&(this.data.state.volume=this.media.volume,this.media.muted=!0),this.trigger(b),this},unmute:function(a){return this.mute(a==null?!1:!a)},position:function(){return r.position(this.media)},toggle:function(a){return r[this.data.disabled.indexOf(a)>-1?"enable":"disable"](this,a)},defaults:function(a,b){return r.isArray(a)?(r.forEach(a,function(a){for(var b in a)this.defaults(b,a[b])},this),this):(this.options.defaults||(this.options.defaults={}),this.options.defaults[a]||(this.options.defaults[a]={}),r.extend(this.options.defaults[a],b),this)}}),r.Events={UIEvents:"blur focus focusin focusout load resize scroll unload",MouseEvents:"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave click dblclick",Events:"loadstart progress suspend emptied stalled play pause loadedmetadata loadeddata waiting playing canplay canplaythrough seeking seeked timeupdate ended ratechange durationchange volumechange"},r.Events.Natives=r.Events.UIEvents+" "+r.Events.MouseEvents+" "+r.Events.Events,o.events.apiTypes=["UIEvents","MouseEvents","Events"],function(a,b){var c=o.events.apiTypes,d=a.Natives.split(/\s+/g),e=0,f=d.length,g;for(;e<f;e++)b.hash[d[e]]=!0;c.forEach(function(c,d){b.apis[c]={};var e=a[c].split(/\s+/g),f=e.length,g=0;for(;g<f;g++)b.apis[c][e[g]]=!0})}(r.Events,o.events),r.events={isNative:function(a){return!!o.events.hash[a]},getInterface:function(a){if(!r.events.isNative(a))return!1;var b=o.events,c=b.apiTypes,d=b.apis,e=0,f=c.length,g,h;for(;e<f;e++){h=c[e];if(d[h][a]){g=h;break}}return g},all:r.Events.Natives.split(/\s+/g),fn:{trigger:function(c,d){var e,f;if(this.data.events[c]&&r.sizeOf(this.data.events[c])){e=r.events.getInterface(c);if(e)return f=b.createEvent(e),f.initEvent(c,!0,!0,a,1),this.media.dispatchEvent(f),this;r.forEach(this.data.events[c],function(a,b){a.call(this,d)},this)}return this},listen:function(a,b){var c=this,d=!0,e=r.events.hooks[a],f=a,g;return this.data.events[a]||(this.data.events[a]={},d=!1),e&&(e.add&&e.add.call(this,{},b),e.bind&&(a=e.bind),e.handler&&(g=b,b=function(b){e.handler.call(c,b,g)}),d=!0,this.data.events[a]||(this.data.events[a]={},d=!1)),this.data.events[a][b.name||b.toString()+r.guid()]=b,!d&&r.events.all.indexOf(a)>-1&&this.media.addEventListener(a,function(b){r.forEach(c.data.events[a],function(a,d){typeof a=="function"&&a.call(c,b)})},!1),this},unlisten:function(a,b){return this.data.events[a]&&this.data.events[a][b]?(delete this.data.events[a][b],this):(this.data.events[a]=null,this)}},hooks:{canplayall:{bind:"canplaythrough",add:function(a,b){var c=!1;this.media.readyState&&(b.call(this,a),c=!0),this.data.hooks.canplayall={fired:c}},handler:function(b,c){this.data.hooks.canplayall.fired||(c.call(this,b),this.data.hooks.canplayall.fired=!0)}}}},r.forEach(["trigger","listen","unlisten"],function(a){r.p[a]=r.events.fn[a]}),r.addTrackEvent=function(a,b){b&&b._natives&&b._natives.type&&a.options.defaults&&a.options.defaults[b._natives.type]&&(b=r.extend({},a.options.defaults[b._natives.type],b)),b._natives&&(b._id=b.id?b.id:r.guid(b._natives.type),a.data.history.push(b._id)),b.start=r.util.toSeconds(b.start,a.options.framerate),b.end=r.util.toSeconds(b.end,a.options.framerate);var c=a.data.trackEvents.byStart,d=a.data.trackEvents.byEnd,e,f,g;for(e=c.length-1;e>=0;e--)if(b.start>=c[e].start){c.splice(e+1,0,b);break}for(f=d.length-1;f>=0;f--)if(b.end>d[f].end){d.splice(f+1,0,b);break}b._natives&&(!!r.registryByName[b._natives.type]||!!a[b._natives.type])&&(g=a.media.currentTime,b.end>g&&b.start<=g&&a.data.disabled.indexOf(b._natives.type)===-1&&(b._running=!0,b._natives.start.call(a,null,b),a.options.frameAnimation&&b._natives.frame&&(a.data.trackEvents.animating.push(b),b._natives.frame.call(a,null,b,g)))),e<=a.data.trackEvents.startIndex&&b.start<=a.data.trackEvents.previousUpdateTime&&a.data.trackEvents.startIndex++,f<=a.data.trackEvents.endIndex&&b.end<a.data.trackEvents.previousUpdateTime&&a.data.trackEvents.endIndex++,this.timeUpdate(a,null,!0),b._id&&r.addTrackEvent.ref(a,b)},r.addTrackEvent.ref=function(a,b){return a.data.trackRefs[b._id]=b,a},r.removeTrackEvent=function(a,b){var c=a.data.history.length,d=0,e=[],f=[],g=[],h=[];r.forEach(a.data.trackEvents.byStart,function(c,g,h){c._id||(e.push(a.data.trackEvents.byStart[g]),f.push(a.data.trackEvents.byEnd[g])),c._id&&(c._id!==b&&(e.push(a.data.trackEvents.byStart[g]),f.push(a.data.trackEvents.byEnd[g])),c._id===b&&(d=g,c._natives._teardown&&c._natives._teardown.call(a,c)))}),a.data.trackEvents.animating.length&&r.forEach(a.data.trackEvents.animating,function(c,d,e){c._id||g.push(a.data.trackEvents.animating[d]),c._id&&c._id!==b&&g.push(a.data.trackEvents.animating[d])}),d<=a.data.trackEvents.startIndex&&a.data.trackEvents.startIndex--,d<=a.data.trackEvents.endIndex&&a.data.trackEvents.endIndex--,a.data.trackEvents.byStart=e,a.data.trackEvents.byEnd=f,a.data.trackEvents.animating=g;for(var i=0;i<c;i++)a.data.history[i]!==b&&h.push(a.data.history[i]);a.data.history=h,r.removeTrackEvent.ref(a,b)},r.removeTrackEvent.ref=function(a,b){return delete a.data.trackRefs[b],a},r.getTrackEvents=function(a){var b=[],c=a.data.trackEvents.byStart,d=c.length,e=0,f;for(;e<d;e++)f=c[e],f._id&&b.push(f);return b},r.getTrackEvents.ref=function(a){return a.data.trackRefs},r.getTrackEvent=function(a,b){return a.data.trackRefs[b]},r.getTrackEvent.ref=function(a,b){return a.data.trackRefs[b]},r.getLastTrackEventId=function(a){return a.data.history[a.data.history.length-1]},r.timeUpdate=function(a,b){var c=a.media.currentTime,d=a.data.trackEvents.previousUpdateTime,e=a.data.trackEvents,f=e.animating,g=e.endIndex,h=e.startIndex,i=0,j=e.byStart.length,k=e.byEnd.length,l=r.registryByName,m="trackstart",n="trackend",o,p,q,s,t;if(d<=c){while(e.byEnd[g]&&e.byEnd[g].end<=c){o=e.byEnd[g],s=o._natives,t=s&&s.type;if(!!s&&!l[t]&&!a[t]){r.removeTrackEvent(a,o._id);return}o._running===!0&&(o._running=!1,s.end.call(a,b,o),a.trigger(n,r.extend({},o,{plugin:t,type:n}))),g++}while(e.byStart[h]&&e.byStart[h].start<=c){p=e.byStart[h],s=p._natives,t=s&&s.type;if(!!s&&!l[t]&&!a[t]){r.removeTrackEvent(a,p._id);return}p.end>c&&p._running===!1&&a.data.disabled.indexOf(t)===-1&&(p._running=!0,s.start.call(a,b,p),a.trigger(m,r.extend({},p,{plugin:t,type:m})),a.options.frameAnimation&&p&&p._running&&p._natives.frame&&f.push(p)),h++}if(a.options.frameAnimation)while(i<f.length)q=f[i],q._running?(q._natives.frame.call(a,b,q,c),i++):f.splice(i,1)}else if(d>c){while(e.byStart[h]&&e.byStart[h].start>c){p=e.byStart[h],s=p._natives,t=s&&s.type;if(!!s&&!l[t]&&!a[t]){r.removeTrackEvent(a,p._id);return}p._running===!0&&(p._running=!1,s.end.call(a,b,p),a.trigger(n,r.extend({},o,{plugin:t,type:n}))),h--}while(e.byEnd[g]&&e.byEnd[g].end>c){o=e.byEnd[g],s=o._natives,t=s&&s.type;if(!!s&&!l[t]&&!a[t]){r.removeTrackEvent(a,o._id);return}o.start<=c&&o._running===!1&&a.data.disabled.indexOf(t)===-1&&(o._running=!0,s.start.call(a,b,o),a.trigger(m,r.extend({},p,{plugin:t,type:m})),a.options.frameAnimation&&o&&o._running&&o._natives.frame&&f.push(o)),g--}if(a.options.frameAnimation)while(i<f.length)q=f[i],q._running?(q._natives.frame.call(a,b,q,c),i++):f.splice(i,1)}e.endIndex=g,e.startIndex=h,e.previousUpdateTime=c,e.byStart.length<j&&e.startIndex--,e.byEnd.length<k&&e.endIndex--},r.extend(r.p,{getTrackEvents:function(){return r.getTrackEvents.call(null,this)},getTrackEvent:function(a){return r.getTrackEvent.call(null,this,a)},getLastTrackEventId:function(){return r.getLastTrackEventId.call(null,this)},removeTrackEvent:function(a){return r.removeTrackEvent.call(null,this,a),this},removePlugin:function(a){return r.removePlugin.call(null,this,a),this},timeUpdate:function(a){return r.timeUpdate.call(null,this,a),this},destroy:function(){return r.destroy.call(null,this),this}}),r.manifest={},r.registry=[],r.registryByName={},r.plugin=function(a,b,c){if(r.protect.natives.indexOf(a.toLowerCase())>=0){r.error("'"+a+"' is a protected function name");return}var d=["start","end"],e={},f,h=typeof b=="function",i=["_setup","_teardown","start","end","frame"],j=function(a,b){return a=a||r.nop,b=b||r.nop,function(){a.apply(this,arguments),b.apply(this,arguments)}};r.manifest[a]=c=c||b.manifest||{},i.forEach(function(c){b[c]=s(b[c]||r.nop,a)});var k=function(b,e){if(!e)return this;var f=e._natives={},h="",k,l,m,n;return r.extend(f,b),e._natives.type=a,e._running=!1,f.start=f.start||f["in"],f.end=f.end||f.out,f._teardown=j(function(){var a=g.call(arguments);a.unshift(null),a[1]._running&&f.end.apply(this,a)},f._teardown),k=this.options.defaults&&this.options.defaults[e._natives&&e._natives.type],e.compose=e.compose&&e.compose.split(" ")||[],e.effect=e.effect&&e.effect.split(" ")||[],e.compose=e.compose.concat(e.effect),e.compose.forEach(function(a){h=r.compositions[a]||{},i.forEach(function(a){f[a]=j(f[a],h[a])})}),e._natives.manifest=c,"start"in e||(e.start=e["in"]||0),"end"in e||(e.end=e.out||this.duration()||Number.MAX_VALUE),n=k?r.extend({},k,e):e,n.target||(m="options"in c&&c.options,n.target=m&&"target"in m&&m.target),e._natives._setup&&e._natives._setup.call(this,n),r.addTrackEvent(this,r.extend(n,e)),r.forEach(b,function(a,b){b!=="type"&&d.indexOf(b)===-1&&this.listen(b,a)},this),this};e[a]=function(a){return k.call(this,h?b.call(this,a):b,a)},r.extend(r.p,e);var l={fn:e[a],definition:b,base:b,parents:[],name:a};return r.registry.push(r.extend(e,l,{type:a})),r.registryByName[a]=l,e},r.plugin.errors=[],r.plugin.debug=!1,r.removePlugin=function(a,b){if(!b){b=a,a=r.p;if(r.protect.natives.indexOf(b.toLowerCase())>=0){r.error("'"+b+"' is a protected function name");return}var c=r.registry.length,d;for(d=0;d<c;d++)if(r.registry[d].name===b){r.registry.splice(d,1),delete r.registryByName[b],delete r.manifest[b],delete a[b];return}}var e=a.data.trackEvents.byStart,f=a.data.trackEvents.byEnd,g=a.data.trackEvents.animating,h,i;for(h=0,i=e.length;h<i;h++)e[h]&&e[h]._natives&&e[h]._natives.type===b&&f[h]&&f[h]._natives&&f[h]._natives.type===b&&(e[h]._natives._teardown&&e[h]._natives._teardown.call(a,e[h]),e.splice(h,1),f.splice(h,1),h--,i--,a.data.trackEvents.startIndex<=h&&(a.data.trackEvents.startIndex--,a.data.trackEvents.endIndex--));for(h=0,i=g.length;h<i;h++)g[h]&&g[h]._natives&&g[h]._natives.type===b&&(g.splice(h,1),h--,i--)},r.compositions={},r.compose=function(a,b,c){r.manifest[a]=c=c||b.manifest||{},r.compositions[a]=b},r.plugin.effect=r.effect=r.compose,r.parsers={},r.parser=function(a,b,c){if(r.protect.natives.indexOf(a.toLowerCase())>=0){r.error("'"+a+"' is a protected function name");return}typeof b=="function"&&!c&&(c=b,b="");if(typeof c!="function"||typeof b!="string")return;var d=r.events.all,e,f={};return e=function(a,d){if(!a)return this;var e=this;return r.xhr({url:a,dataType:b,success:function(a){var b=c(a),f,g,i,j=0;f=b.data||[],g=f.length,i=null;if(!g)return;for(;j<g;j++){i=f[j];for(var k in i)h.call(i,k)&&!!e[k]&&e[k](i[k])}d&&d()}}),this},f[a]=e,r.extend(r.p,f),f},r.player=function(a,c){c=c||{};var d=function(a,d,e){e=e||{};var f=new Date/1e3,g=f,h=0,i=1,j=!1,l={},m=b.getElementById(k.exec(a)&&k.exec(a)[2])||b.getElementById(a)||a,n={},o,p;for(var q in m)typeof m[q]=="object"?n[q]=m[q]:typeof m[q]=="function"?n[q]=function(a){return"length"in m[a]&&!m[a].call?m[a]:function(){return m[a].apply(m,arguments)}}(q):r.player.defineProperty(n,q,{get:function(a){return function(){return m[a]}}(q),set:r.nop,configurable:!0});var s=function(){f=new Date/1e3,n.paused||(n.currentTime=n.currentTime+(f-g),n.dispatchEvent("timeupdate"),o=setTimeout(s,10)),g=f};return n.play=function(){this.paused=!1,n.readyState>=4&&(g=new Date/1e3,n.dispatchEvent("play"),s())},n.pause=function(){this.paused=!0,n.dispatchEvent("pause")},r.player.defineProperty(n,"currentTime",{get:function(){return h},set:function(a){return h=+a,n.dispatchEvent("timeupdate"),h},configurable:!0}),r.player.defineProperty(n,"volume",{get:function(){return i},set:function(a){return i=+a,n.dispatchEvent("volumechange"),i},configurable:!0}),r.player.defineProperty(n,"muted",{get:function(){return j},set:function(a){return j=+a,n.dispatchEvent("volumechange"),j},configurable:!0}),n.addEventListener=function(a,b){return l[a]||(l[a]=[]),l[a].push(b),b},n.dispatchEvent=function(a){var c,d=this,e,f=a.type;f||(f=a,e=r.events.getInterface(f),e&&(c=b.createEvent(e),c.initEvent(f,!0,!0,window,1))),r.forEach(l[f],function(a){a.call(d,c,d)})},n.src=d||"",n.readyState=0,n.duration=0,n.paused=!0,n.ended=0,c._setup?c._setup.call(n,e):(n.readyState=4,n.dispatchEvent("load"),n.dispatchEvent("loadeddata")),n.addEventListener("load",function(){n.currentTime=h,n.volume=i,n.muted=j}),n.addEventListener("loadeddata",function(){!n.paused&&n.play()}),p=new r.p.init(n,e),p};r[a]=r[a]||d},r.player.defineProperty=Object.defineProperty||function(a,b,c){a.__defineGetter__(b,c.get||r.nop),a.__defineSetter__(b,c.set||r.nop)};var t=/\?/,u={url:"",data:"",dataType:"",success:r.nop,type:"GET",async:!0,xhr:function(){return new a.XMLHttpRequest}};r.xhr=function(a){a.dataType=a.dataType&&a.dataType.toLowerCase()||null;if(!(!a.dataType||a.dataType!=="jsonp"&&a.dataType!=="script")){r.xhr.getJSONP(a.url,a.success,a.dataType==="script");return}var b=r.extend({},u,a);b.ajax=b.xhr();if(b.ajax)return b.type==="GET"&&b.data&&(b.url+=(t.test(b.url)?"&":"?")+b.data,b.data=null),b.ajax.open(b.type,b.url,b.async),b.ajax.send(b.data||null),r.xhr.httpData(b)},r.xhr.httpData=function(a){var b,c=null,d,e=null;return a.ajax.onreadystatechange=function(){if(a.ajax.readyState===4){try{c=JSON.parse(a.ajax.responseText)}catch(f){}b={xml:a.ajax.responseXML,text:a.ajax.responseText,json:c};if(!b.xml||!b.xml.documentElement){b.xml=null;try{d=new DOMParser,e=d.parseFromString(a.ajax.responseText,"text/xml"),e.getElementsByTagName("parsererror").length||(b.xml=e)}catch(f){}}a.dataType&&(b=b[a.dataType]),a.success.call(a.ajax,b)}},b},r.xhr.getJSONP=function(a,c,d){var e=b.head||b.getElementsByTagName("head")[0]||b.documentElement,f=b.createElement("script"),g=a.split("?")[1],h=!1,i=[],j,k,l;g&&!d&&(i=g.split("&")),i.length&&(k=i[i.length-1].split("=")),j=i.length?k[1]?k[1]:k[0]:"jsonp",!g&&!d&&(a+="?callback="+j),j&&!d&&(!window[j]||(j=r.guid(j)),window[j]=function(a){c&&c(a),h=!0},a=a.replace(k.join("="),k[0]+"="+j)),f.onload=function(){d&&c&&c(),h&&delete window[j],e.removeChild(f)},f.src=a,e.insertBefore(f,e.firstChild);return},r.getJSONP=r.xhr.getJSONP,r.getScript=r.xhr.getScript=function(a,b){return r.xhr.getJSONP(a,b,!0)},r.util={toSeconds:function(a,b){var c=/^([0-9]+:){0,2}[0-9]+([.;][0-9]+)?$/,d="Invalid time format",e,f,g,h,i,j;return typeof a=="number"?a:(typeof a=="string"&&!c.test(a)&&r.error(d),e=a.split(":"),f=e.length-1,g=e[f],g.indexOf(";")>-1&&(i=g.split(";"),j=0,b&&typeof b=="number"&&(j=parseFloat(i[1],10)/b),e[f]=parseInt(i[0],10)+j),h=e[0],{1:parseFloat(h,10),2:parseInt(h,10)*60+parseFloat(e[1],10),3:parseInt(h,10)*3600+parseInt(e[1],10)*60+parseFloat(e[2],10)}[e.length||1])}};var w=v(a.navigator.userLanguage||a.navigator.language);r.locale={get:function(){return w},set:function(a){return w=v(a),r.locale.broadcast(),w},broadcast:function(a){var b=r.instances,c=b.length,d=0,e;a=a||"locale:changed";for(;d<c;d++)e=b[d],a in e.data.events&&e.trigger(a)}},r.p.cue=r.p.exec,r.protect={natives:x()},a.Popcorn=r}(window,window.document),function(a,b){var c=a.document,d=a.location,e=/:\/\//,f=d.href.replace(d.href.split("/").slice(-1)[0],""),g=function(a,b,c){a=a||0,b=(b||a||0)+1,c=c||1;var d=Math.ceil((b-a)/c)||0,e=0,f=[];f.length=d;while(e<d)f[e++]=a,a+=c;return f};b.sequence=function(a,c){return new b.sequence.init(a,c)},b.sequence.init=function(a,d){this.parent=c.getElementById(a),this.seqId=b.guid("__sequenced"),this.queue=[],this.playlist=[],this.inOuts={ofVideos:[],ofClips:[]},this.dims={width:0,height:0},this.active=0,this.cycling=!1,this.playing=!1,this.times={last:0},this.events={};var g=this,h=0;return b.forEach(d,function(d,h){var i=c.createElement("video");i.preload="auto",i.controls=!0,i.style.display=h&&"none"||"",i.id=g.seqId+"-"+h,g.queue.push(i);var j=d["in"],k=d.out;g.inOuts.ofVideos.push({"in":j!==undefined&&j||1,out:k!==undefined&&k||0}),g.inOuts.ofVideos[h].out=g.inOuts.ofVideos[h].out||g.inOuts.ofVideos[h]["in"]+2,i.src=e.test(d.src)?d.src:f+d.src,i.setAttribute("data-sequence-owner",a),i.setAttribute("data-sequence-guid",g.seqId),i.setAttribute("data-sequence-id",h),i.setAttribute("data-sequence-clip",[g.inOuts.ofVideos[h]["in"],g.inOuts.ofVideos[h].out].join(":")),g.parent.appendChild(i),g.playlist.push(b("#"+i.id))}),g.inOuts.ofVideos.forEach(function(a){var b=a.out-a["in"],c={"in":h,out:h+b};g.inOuts.ofClips.push(c),h=c.out+1}),b.forEach(this.queue,function(a,c){function d(b){return c||(g.dims.width=a.videoWidth,g.dims.height=a.videoHeight),a.currentTime=g.inOuts.ofVideos[c]["in"]-.5,a.removeEventListener("canplaythrough",d,!1),!0}a.addEventListener("canplaythrough",d,!1),a.addEventListener("play",function(a){g.playing=!0},!1),a.addEventListener("pause",function(a){g.playing=!1},!1),a.addEventListener("timeupdate",function(c){var d=c.srcElement||c.target,e=+(d.dataset&&d.dataset.sequenceId||d.getAttribute("data-sequence-id")),f=Math.floor(a.currentTime);g.times.last!==f&&e===g.active&&(g.times.last=f,f===g.inOuts.ofVideos[e].out&&b.sequence.cycle.call(g,e))},!1)}),this},b.sequence.init.prototype=b.sequence.prototype,b.sequence.cycle=function(a){this.queue||b.error("Popcorn.sequence.cycle is not a public method");var c=this.queue,d=this.inOuts.ofVideos,e=c[a],f=0,g,h,i,j;return c[a+1]&&(f=a+1),c[a+1]?(g=c[f],h=d[f],b.extend(g,{width:this.dims.width,height:this.dims.height}),i=this.playlist[f],j=this.playlist[a],e.pause(),this.active=f,this.times.last=h["in"]-1,i.currentTime(h["in"]),i[f?"play":"pause"](),this.trigger("cycle",{position:{previous:a,current:f}}),f&&(e.style.display="none",g.style.display=""),this.cycling=!1):(f=0,this.playlist[a].pause()),this};var h=["timeupdate","play","pause"];b.extend(b.sequence.prototype,{eq:function(a){return this.playlist[a]},remove:function(){this.parent.innerHTML=null},clip:function(a){return this.inOuts.ofVideos[a]},duration:function(){var a=0,b=this.inOuts.ofClips,c=0;for(;c<b.length;c++)a+=b[c].out-b[c]["in"]+1;return a-1},play:function(){return this.playlist[this.active].play(),this},exec:function(a,c){var d=this.active;return this.inOuts.ofClips.forEach(function(b,c){a>=b["in"]&&a<=b.out&&(d=c)}),a+=this.inOuts.ofVideos[d]["in"]-this.inOuts.ofClips[d]["in"],b.addTrackEvent(this.playlist[d],{start:a-1,end:a,_running:!1,_natives:{start:c||b.nop,end:b.nop,type:"exec"}}),this},listen:function(a,c){var d=this,e=this.playlist,f=e.length,g=0,i;return c||(c=b.nop),b.Events.Natives.indexOf(a)>-1?b.forEach(e,function(b){b.listen(a,function(e){e.active=d,h.indexOf(a)>-1?c.call(b,e):++g===f&&c.call(b,e)})}):(this.events[a]||(this.events[a]={}),i=c.name||b.guid("__"+a),this.events[a][i]=c),this},unlisten:function(a,b){},trigger:function(a,c){var d=this;if(b.Events.Natives.indexOf(a)>-1)return;return this.events[a]&&b.forEach(this.events[a],function(b,e){b.call(d,{type:a},c)}),this}}),b.forEach(b.manifest,function(a,c){b.sequence.prototype[c]=function(a){var d={},e=[],f,h,i,j,k,l,m,n,o;for(f=0;f<this.inOuts.ofClips.length;f++)h=this.inOuts.ofClips[f],i=g(h["in"],h.out),j=i.indexOf(a.start),k=i.indexOf(a.end),j>-1&&(d[f]=b.extend({},h,{start:i[j],clipIdx:j})),k>-1&&(d[f]=b.extend({},h,{end:i[k],clipIdx:k}));l=Object.keys(d).map(function(a){return+a}),e=g(l[0],l[1]);for(f=0;f<e.length;f++){var p={},q=e[f],r=d[q];r?(m=this.inOuts.ofVideos[q],n=r.clipIdx,o=g(m["in"],m.out),r.start&&(p.start=o[n],p.end=o[o.length-1]),r.end&&(p.start=o[0],p.end=o[n])):(p.start=this.inOuts.ofVideos[q]["in"],p.end=this.inOuts.ofVideos[q].out),this.playlist[q][c](b.extend({},a,p))}return this}})}(this,Popcorn),function(a){document.addEventListener("DOMContentLoaded",function(){var b="data-timeline-sources",c=document.querySelectorAll("["+b+"]");a.forEach(c,function(d,e){var f=c[e],g=!1,h,i,j;f.id||(f.id=a.guid("__popcorn")),f.nodeType&&f.nodeType===1&&(j=a("#"+f.id),h=(f.getAttribute(b)||"").split(","),h[0]&&a.forEach(h,function(a){i=a.split("!"),i.length===1&&(i=a.match(/(.*)[\/\\]([^\/\\]+\.\w+)$/)[2].split("."),i[0]="parse"+i[1].toUpperCase(),i[1]=a),h[0]&&j[i[0]]&&j[i[0]](i[1])}),!j.autoplay||j.play())})},!1)}(Popcorn),function(a){a.plugin("attribution",function(){var b="data:image/png;base64,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",c={"cc-by":b+"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","cc-by-sa":b+"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","cc-by-nd":b+"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","cc-by-nc":b+"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","cc-by-nc-sa":b+"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","cc-by-nc-nd":b+"m8SURBVHja7FpdcBvVFf52pXgGplH11mbkDPbQdqy8oIQmMZRiufwMxRivJiHtFChyZwqUlMoiiWlaO5JCfkBNKqvhp30oUsswMCVMlL9CHRqt4xTLkmKtE7D8UMZisIf2pZLltDO1Vnv6sNprrS1bsgNDGjgz17vW3fvt3W/PPfe75y5HRCaO46bxhX3iRkQcB4AA4HT/KfA8D57nYTAYwPMGGHgevKF05HlwHA+e48BxHMBxGgoIBFIICilQFLUUi0X1qBRRLCpQlCKrU0hh1xOR1hl2fi3YAx3bAAAcANLINRgMauENc+cGg1rHG0okc+A4vpzfEjklYhWVzGKxVMrPi3qSFUVhxJYTfS2RbASgJ9dghFF3VMvJ46cQjUYRj8cxk5/RAa02rcamTZvQ+p1WtN9/H4qKATwvqy+kyIMDV3qXZcNHIXUkoDSGOJXckUQKkTcjSKfTuuutViuELQI2bFxf08NdLTgcAPrL2bdhNBoZqUajUS0GIwbEc/A/68fU1FRNHbJYLOje3Y2WltshF4soFmXIcqkUZchykXl4uSd/PPUxjvQ9j/H0OADAbrfDZrMBACRJgiiKAIAmaxO2u7bjq2u+UvH+//j4n3gh+MJVgfNAxzaV4HcGzsBoMM4Ra1yFVUYjPL1eRI5FWAOz2QxBENDQ0ICWlhYAwMDAADKZDCKRCHK5HLtWcAjY2b0D111/HWRZRkGWIcsFyLKsDxmkYDo7jZ8+/iTy+TwEQUAgEEBDQ4Ous5lMBm63G5FIBCaTCfv9+xc81OX8Zbi2d101OFocprODZ2lw6BwNJYYoKSVo9D2JBIdApcFLZrOZvF4vZbNZWspCoRCZzWbWrsnaROeHBikpJSmWHKLBoXMUHTxLZ8R+evuvb9Hp/lN04q3jZLVaCQA5nU4dnoYz/x4a9hvH/6QrTdamijjBQIB+8L3vXzHOYs+8GA4A4gHAUIrBRoMBRoPec202G1KpFDweD8xm85Lhwel0YmJigg2l8fQ4DvkP62I5zxSJqkYSsQTS6TQEQUD3rl1VQ5DT6YQgCBhPj2MkkdLFyvH0ODasX49bm29hv/+mrw/P+v04efo0nt65C5OTkzXhXGl/dPPNYGyQYskYjYxeoOCRIPMcm81W1WsrWTabJZvNxnCCzwdp5OIIDV+I0fnYIEXPq1781jt/Jus61XsnJiZqxp+YmCAAZLVambdoo6Dp69+gG29ooJZv3UaP//hRAkBer5cOHjhIAOjoG2/UhHOl/angwaoX+5/1s3gbCoWqem0lM5vNiEajrK3/oL+kpUsezJU0Nc8jPZaG3W5fEOM6OzuZl3d2durqGhoaYLfbdTN7Oq3itLe344Ft2zA5OYkz/f248YYG/GfmMh56+CGMvf8+tmzdWhNOeX++1tBYsSyFoxmvyTSeV6WYpha6urrYUF+Jmc1mBAIBAMDU1BROnjjFFiwqyRyTaZXuEw6HK55rVqmNzWaD//AhHPQ/h1dffw1btm7FBx9m4D98CGvXrkX45RDSY2M14ZTbXffcU7FUwwGg6mDNm6LRKCPH5XKxi0RRRDAYZCrBbrfD4/FUrOvo6EBXVxeLT263G7lcDtGzUdzX3lbyXg4cz4FTuE9N5G9ubsbm5mY82eXCkb4gzvT3482jR/Hm0aPY3NwM5486cdfdd9eE9dJvX1pxP9SFBseB5zjE43FVYgkCG96iKKK1tVXXSBRFiKIIl8sFh8OxoG50dBShUIhhhcNhxONxdQXIc2zoa4sPSZIqTh6a5zqdzgX1ldrM/y2fz+NMfz+eO/QrOMc60X5vGwBgOBbDcCyG+vp6cKuMVXHKw0G5/T0zsWR/yjxYfWBthXbTTTexC9xuN4sz0WgUmUwGnZ2deOSRR+Dz+djwOHbsGCRJgtvtZhoZAFpaWhAOhzGTn1HvA67sCKxbtw6iKCKTyejiXigUYgRrL6tcg4qiCKvVqltZzcf5yaOPYTgWw5G+IADggw8z6N6xE5uaN+OiNIo/hMP4cGqyKs4dd925pJdW6o9ORSSlBF0au8hm/Wg0ukCLer3eBbPnUnWaRaNRdt2lsYuUlJL0bvxdGvibSO8MnCGPbw8BIEEQFsWfb4KgavTdPbvZjL27Z/cCnI8++oj2+fbSmjVraPWXVlMwEKDp6ell41SzSjg6FfFZ2i233QLrOisikcgCtVDJtNVTk7VJlwfYsHE9mqxNOpz6+nr8ck8vdrifQntbG37W1QWTybRsnJX0R6ciQPosVnk80WbHcDiMXC4HSZLQ2NgIn8/H6rRlcnld+fCZy4+yP7pO9Hp7YTKZEA6H4XA4WJvyLFsmk4HD4UBfXx9MJhO2u7YveJinf9FdEWfHrp149fXXrhhnfliohsOSPYmROOrq6nDbrd/GTH4GTqeTxb1IJLJgItMmno6OjkXrtPZutxt9fX1YbVqN8+8OYnZ2FrOFWRTkAgoFWU0GFWVk/5XDAd8BpiVtNhtsNhvMZjNEUWQvvVqS5nL+Mp474GdJms8ShyV7hi8Mo66uDr49PkSORWA2m5HNZmuSaZFIBMFgkF1bXgcAjY2NyGQyuOPOO3A4cAj/nZ1FYR7BWt5YKSpIDCdw7Oi1ka5kBMeSQ1i1qg7nz52H60lV/wYCAaZnV2rhcJjFsX0H9uHetu9itjCL2UIBcqGAgjyP4AoJ+P/3hDsPgG3p2FtbYLFYAAA+n69i7KnVcrkck3gWi6WUiC/tYigKlFIsptKW07VqPAAopKBYVPfRntm/lxHkcDh0Od7lkNva2sradv+8u5RgL86RXLZlxCZZura2jNjkDoB6PD2UGImTdClFD//wYV1GLZVKLSuzVJ5JExwCSZdSlBiJ0979e9nvn6My90/XUy5KphIkrSDhns1myev16hLuGzdtpNH3JEpKCerx9HweySVuvijt9fSgwyHAaDTisP8wXvnjKyveMvI944UsyxgejuOJx56o5TuCOf1YyrQRlW2OVvh/MZzF2mj3qIaxFE6lflYNEeWl19OjevKlFL0c/j1ZLJaa35jFYqHgkSBJl1KUlBL04u9erLnt/OXx/PPy36rhVGtfC9YngbPAgzXresqFBx96kG31iNEBnDh+Yslt+/uF+2G3t7ANzePHT2Cfb99yvoRZ1DNq8dxKnlbpuJz+VMOphrkowQCw4eb16PXsQf1aS9luRHm6ETrdqn14MjU5iV8fCuDcwLnlfmp0RaGhWkhYDjGfFM6SBGt2e8vtaGtvw83fvBlfNplKn07NBRgiwnQ+jwvJCzh98vSyif20PPhqiME1EfyFrdw4Irqe47h/f0HFp7DAIOL+NwDFrtvhh4x87AAAAABJRU5ErkJggg=="},d;return{_setup:function(b){var e="",f=b.license&&c[b.license.toLowerCase()],g="target=_blank";b._container=document.createElement("div"),b._container.style.display="none",d=document.getElementById(b.target),b.nameofworkurl&&(e+="<a href='"+b.nameofworkurl+"' "+g+">"),b.nameofwork&&(e+=b.nameofwork),b.nameofworkurl&&(e+="</a>"),b.copyrightholderurl&&(e+="<a href='"+b.copyrightholderurl+"' "+g+">"),b.copyrightholder&&(e+=", "+b.copyrightholder),b.copyrightholderurl&&(e+="</a>"),e===""&&(e=b.text),b.license?f?b.licenseurl?e="<a href='"+b.licenseurl+"' "+g+"><img src='"+f+"' border='0'/></a> "+e:e="<img src='"+f+"' />"+e:(e+=", license: ",b.licenseurl?e+="<a href='"+b.licenseurl+"' "+g+">"+b.license+"</a> ":e+=b.license):b.licenseurl&&(e+=", <a href='"+b.licenseurl+"' "+g+">license</a> "),b._container.innerHTML=e;if(!d&&a.plugin.debug)throw new Error("target container doesn't exist");d&&d.appendChild(b._container)},start:function(a,b){b._container.style.display="inline"},end:function(a,b){b._container.style.display="none"},_teardown:function(a){d=document.getElementById(a.target),d&&d.removeChild(a._container)}}}(),{about:{name:"Popcorn Attribution Plugin",version:"0.2",author:"@rwaldron",website:"github.com/rwldrn"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},nameofwork:{elem:"input",type:"text",label:"Name of Work"},nameofworkurl:{elem:"input",type:"url",label:"Url of Work"},copyrightholder:{elem:"input",type:"text",label:"Copyright Holder"},copyrightholderurl:{elem:"input",type:"url",label:"Copyright Holder Url"},license:{elem:"input",type:"text",label:"License type"},licenseurl:{elem:"input",type:"url",label:"License URL"},target:"attribution-container"}})}(Popcorn),function(a){a.plugin("code",function(b){var c=!1,d=function(){var a=function(a){return function(b,d){var e=function(){c&&b(),c&&a(e)};e()}};return window.webkitRequestAnimationFrame?a(window.webkitRequestAnimationFrame):window.mozRequestAnimationFrame?a(window.mozRequestAnimationFrame):a(function(a){window.setTimeout(a,16)})}();if(!b.onStart||typeof b.onStart!="function"){if(a.plugin.debug)throw new Error("Popcorn Code Plugin Error: onStart must be a function.");b.onStart=a.nop}if(b.onEnd&&typeof b.onEnd!="function"){if(a.plugin.debug)throw new Error("Popcorn Code Plugin Error: onEnd  must be a function.");b.onEnd=undefined}if(b.onFrame&&typeof b.onFrame!="function"){if(a.plugin.debug)throw new Error("Popcorn Code Plugin Error: onFrame  must be a function.");b.onFrame=undefined}return{start:function(a,b){b.onStart(b),b.onFrame&&(c=!0,d(b.onFrame,b))},end:function(a,b){b.onFrame&&(c=!1),b.onEnd&&b.onEnd(b)}}},{about:{name:"Popcorn Code Plugin",version:"0.1",author:"David Humphrey (@humphd)",website:"http://vocamus.net/dave"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},onStart:{elem:"input",type:"function",label:"onStart"},onFrame:{elem:"input",type:"function",label:"onFrame"},onEnd:{elem:"input",type:"function",label:"onEnd"}}})}(Popcorn),function(a){var b=0;a.plugin("flickr",function(c){var d,e=document.getElementById(c.target),f,g,h,i,j=c.numberofimages||4,k=c.height||"50px",l=c.width||"50px",m=c.padding||"5px",n=c.border||"0px";d=document.createElement("div"),d.id="flickr"+b,d.style.width="100%",d.style.height="100%",d.style.display="none",b++;if(!e&&a.plugin.debug)throw new Error("flickr target container doesn't exist");e&&e.appendChild(d);var o=function(){f?setTimeout(function(){o()},5):(g="http://api.flickr.com/services/rest/?method=flickr.people.findByUsername&",g+="username="+c.username+"&api_key="+c.apikey+"&format=json&jsoncallback=flickr",a.getJSONP(g,function(a){f=a.user.nsid,p()}))},p=function(){g="http://api.flickr.com/services/feeds/photos_public.gne?",f&&(g+="id="+f+"&"),c.tags&&(g+="tags="+c.tags+"&"),g+="lang=en-us&format=json&jsoncallback=flickr",a.xhr.getJSONP(g,function(b){var c=document.createElement("p");c.innerHTML="<p style='padding:"+m+";'>"+b.title+"<p/>",a.forEach(b.items,function(a,b){if(!(b<j))return!1;h=document.createElement("a"),h.setAttribute("href",a.link),h.setAttribute("target","_blank"),i=document.createElement("img"),i.setAttribute("src",a.media.m),i.setAttribute("height",k),i.setAttribute("width",l),i.setAttribute("style","border:"+n+";padding:"+m),h.appendChild(i),c.appendChild(h)}),d.appendChild(c)})};return c.username&&c.apikey?o():(f=c.userid,p()),{start:function(a,b){d.style.display="inline"},end:function(a,b){d.style.display="none"},_teardown:function(a){document.getElementById(a.target)&&document.getElementById(a.target).removeChild(d)}}},{about:{name:"Popcorn Flickr Plugin",version:"0.2",author:"Scott Downe, Steven Weerdenburg, Annasob",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"number",label:"In"},end:{elem:"input",type:"number",label:"Out"},userid:{elem:"input",type:"text",label:"UserID"},tags:{elem:"input",type:"text",label:"Tags"},username:{elem:"input",type:"text",label:"Username"},apikey:{elem:"input",type:"text",label:"Api_key"},target:"flickr-container",height:{elem:"input",type:"text",label:"Height"},width:{elem:"input",type:"text",label:"Width"},padding:{elem:"input",type:"text",label:"Padding"},border:{elem:"input",type:"text",label:"Border"},numberofimages:{elem:"input",type:"text",label:"Number of Images"}}})}(Popcorn),function(a){a.forEach(["footnote","text"],function(b){a.plugin(b,{manifest:{about:{name:"Popcorn "+b+" Plugin",version:"0.2",author:"@annasob, @rwaldron",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},text:{elem:"input",type:"text",label:"Text"},target:b+"-container"}},_setup:function(b){var c=document.getElementById(b.target);b._container=document.createElement("div"),b._container.style.display="none",b._container.innerHTML=b.text;if(!c&&a.plugin.debug)throw new Error("target container doesn't exist");c&&c.appendChild(b._container)},start:function(a,b){b._container.style.display="inline"},end:function(a,b){b._container.style.display="none"},_teardown:function(a){document.getElementById(a.target)&&document.getElementById(a.target).removeChild(a._container)}})})}(Popcorn),function(a,b){var c=!1;a.plugin("facebook",{manifest:{about:{name:"Popcorn Facebook Plugin",version:"0.1",author:"Dan Ventura, Matthew Schranz: @mjschranz",website:"dsventura.blogspot.com, mschranz.wordpress.com"},options:{type:{elem:"select",options:["LIKE","LIKE-BOX","ACTIVITY","FACEPILE","LIVE-STREAM","SEND","COMMENTS"],label:"Type"},target:"facebook-container",start:{elem:"input",type:"number",label:"In"},end:{elem:"input",type:"number",label:"Out"},font:{elem:"input",type:"text",label:"font"},xid:{elem:"input",type:"text",label:"Xid"},href:{elem:"input",type:"url",label:"Href"},site:{elem:"input",type:"url",label:"Site"},height:{elem:"input",type:"text",label:"Height"},width:{elem:"input",type:"text",label:"Width"},action:{elem:"select",options:["like","recommend"],label:"Action"},stream:{elem:"select",options:["false","true"],label:"Stream"},header:{elem:"select",options:["false","true"],label:"Header"},layout:{elem:"select",options:["standard","button_count","box_count"],label:"Layout"},max_rows:{elem:"input",type:"text",label:"Max_rows"},border_color:{elem:"input",type:"text",label:"Border_color"},event_app_id:{elem:"input",type:"text",label:"Event_app_id"},colorscheme:{elem:"select",options:["light","dark"],label:"Colorscheme"},show_faces:{elem:"select",options:["false","true"],label:"Showfaces"},recommendations:{elem:"select",options:["false","true"],label:"Recommendations"},always_post_to_friends:{elem:"input",options:["false","true"],label:"Always_post_to_friends"},num_posts:{elem:"input",type:"text",label:"Number_of_Comments"}}},_setup:function(d){var e=document.getElementById(d.target),f=d.type;if(!document.getElementById("fb-root")){var g=document.createElement("div");g.setAttribute("id","fb-root"),document.body.appendChild(g)}if(!c||d.event_app_id)c=!0,a.getScript("//connect.facebook.net/en_US/all.js"),b.fbAsyncInit=function(){FB.init({appId:d.event_app_id||"",status:!0,cookie:!0,xfbml:!0})};f=f.toLowerCase();var h=function(a){return["like","like-box","activity","facepile","live-stream","send","comments"].indexOf(a)>-1};if(!h(f))throw new Error("Facebook plugin type was invalid.");d._container=document.createElement("div"),d._container.id="facebookdiv-"+a.guid(),d._facebookdiv=document.createElement("fb:"+f),d._container.appendChild(d._facebookdiv);var i=f==="activity"?"site":"href";d._facebookdiv.setAttribute(i,d[i]||document.URL);var j="width height layout show_faces stream header colorscheme maxrows border_color recommendations font always_post_to_friends xid num_posts".split(" ");a.forEach(j,function(a){d[a]!=null&&d._facebookdiv.setAttribute(a,d[a])});if(!e&&a.plugin.debug)throw new Error("Facebook target container doesn't exist");e&&e.appendChild(d._container)},start:function(a,b){b._container.style.display=""},end:function(a,b){b._container.style.display="none"},_teardown:function(a){var b=document.getElementById(a.target);b&&b.removeChild(a._container)}})}(Popcorn,this);var googleCallback;(function(a){var b=1,c=!1,d=!1,e,f;googleCallback=function(a){typeof google!="undefined"&&google.maps&&google.maps.Geocoder&&google.maps.LatLng?(e=new google.maps.Geocoder,d=!0):setTimeout(function(){googleCallback(a)},1)},f=function(){document.body?(c=!0,a.getScript("//maps.google.com/maps/api/js?sensor=false&callback=googleCallback")):setTimeout(function(){f()},1)},a.plugin("googlemap",function(g){var h,j,k,l=document.getElementById(g.target);c||f(),h=document.createElement("div"),h.id="actualmap"+b,h.style.width="100%",h.style.height="100%",b++;if(!l&&a.plugin.debug)throw new Error("target container doesn't exist");l&&l.appendChild(h);var m=function(){d?g.location?e.geocode({address:g.location},function(a,b){b===google.maps.GeocoderStatus.OK&&(g.lat=a[0].geometry.location.lat(),g.lng=a[0].geometry.location.lng(),k=new google.maps.LatLng(g.lat,g.lng),j=new google.maps.Map(h,{mapTypeId:google.maps.MapTypeId[g.type]||google.maps.MapTypeId.HYBRID}),j.getDiv().style.display="none")}):(k=new google.maps.LatLng(g.lat,g.lng),j=new google.maps.Map(h,{mapTypeId:google.maps.MapTypeId[g.type]||google.maps.MapTypeId.HYBRID}),j.getDiv().style.display="none"):setTimeout(function(){m()},5)};return m(),{start:function(a,b){var c=this,d,e=function(){if(j){j.getDiv().style.display="block",google.maps.event.trigger(j,"resize"),j.setCenter(k),b.zoom&&typeof b.zoom!="number"&&(b.zoom=+b.zoom),b.zoom=b.zoom||8,j.setZoom(b.zoom),b.heading&&typeof b.heading!="number"&&(b.heading=+b.heading),b.pitch&&typeof b.pitch!="number"&&(b.pitch=+b.pitch);if(b.type==="STREETVIEW"){j.setStreetView(d=new google.maps.StreetViewPanorama(h,{position:k,pov:{heading:b.heading=b.heading||0,pitch:b.pitch=b.pitch||0,zoom:b.zoom}}));var a=function(d,e){var h=google.maps.geometry.spherical.computeHeading;setTimeout(function(){var e=c.media.currentTime;if(typeof b.tween=="object"){for(var i=0,j=d.length;i<j;i++){var k=d[i];e>=k.interval*(i+1)/1e3&&(e<=k.interval*(i+2)/1e3||e>=k.interval*j/1e3)&&(o.setPosition(new google.maps.LatLng(k.position.lat,k.position.lng)),o.setPov({heading:k.pov.heading||h(k,d[i+1])||0,zoom:k.pov.zoom||0,pitch:k.pov.pitch||0}))}a(d,d[0].interval)}else{for(var l=0,m=d.length;l<m;l++){var n=b.interval;e>=n*(l+1)/1e3&&(e<=n*(l+2)/1e3||e>=n*m/1e3)&&(f.setPov({heading:h(d[l],d[l+1])||0,zoom:b.zoom,pitch:b.pitch||0}),f.setPosition(g[l]))}a(g,b.interval)}},e)};if(b.location&&typeof b.tween=="string"){var f=d,g=[],i=new google.maps.DirectionsService,l=new google.maps.DirectionsRenderer(f),m={origin:b.location,destination:b.tween,travelMode:google.maps.TravelMode.DRIVING};i.route(m,function(a,b){b==google.maps.DirectionsStatus.OK&&(l.setDirections(a),n(a,c))});var n=function(c,d){var e=c.routes[0].overview_path;for(var f=0,h=e.length;f<h;f++)g.push(new google.maps.LatLng(e[f].lat(),e[f].lng()));b.interval=b.interval||1e3,a(g,10)}}else if(typeof b.tween=="object"){var o=d;for(var p=0,q=b.tween.length;p<q;p++)b.tween[p].interval=b.tween[p].interval||1e3,a(b.tween,10)}}}else setTimeout(function(){e()},13)};e()},end:function(a,b){j&&(j.getDiv().style.display="none")},_teardown:function(a){var b=document.getElementById(a.target);b&&b.removeChild(h),h=j=k=null}}},{about:{name:"Popcorn Google Map Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"map-container",type:{elem:"select",options:["ROADMAP","SATELLITE","STREETVIEW","HYBRID","TERRAIN"],label:"Type"},zoom:{elem:"input",type:"text",label:"Zoom"},lat:{elem:"input",type:"text",label:"Lat"},lng:{elem:"input",type:"text",label:"Lng"},location:{elem:"input",type:"text",label:"Location"},heading:{elem:"input",type:"text",label:"Heading"},pitch:{elem:"input",type:"text",label:"Pitch"}}})})(Popcorn),function(a){a.plugin("image",{manifest:{about:{name:"Popcorn image Plugin",version:"0.1",author:"Scott Downe",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"number",label:"In"},end:{elem:"input",type:"number",label:"Out"},href:{elem:"input",type:"url",label:"Link URL"},target:"image-container",src:{elem:"input",type:"url",label:"Source URL"},text:{elem:"input",type:"text",label:"TEXT"}}},_setup:function(b){var c=document.createElement("img"),d=document.getElementById(b.target);b.link=document.createElement("a"),b.link.style.position="relative",b.link.style.textDecoration="none";if(!d&&a.plugin.debug)throw new Error("target container doesn't exist");d&&d.appendChild(b.link),c.addEventListener("load",function(){c.style.borderStyle="none",b.href&&(b.link.href=b.href),b.link.target="_blank";var d=c.height/12+"px",e=document.createElement("div");a.extend(e.style,{color:"black",fontSize:d,fontWeight:"bold",position:"relative",textAlign:"center",width:c.width+"px",zIndex:"10"}),e.innerHTML=b.text||"",b.link.appendChild(e),b.link.appendChild(c),e.style.top=c.height/2-e.offsetHeight/2+"px",b.link.style.display="none"},!1),c.src=b.src},start:function(a,b){b.link.style.display="block"},end:function(a,b){b.link.style.display="none"},_teardown:function(a){document.getElementById(a.target)&&document.getElementById(a.target).removeChild(a.link)}})}(Popcorn),function(a){var b=function(a){var b=0,c=0,d=0,e=null,f=null,g=!1,h=0,i=function(){},j=function(){a.background(0),c=d=0,e=f=null},k=function(b,c,d,e){var f,h,i,j;g?(f=c*a.height,h=a.width-b*a.width,i=e*a.height,j=a.width-d*a.width):(f=b*a.width,h=c*a.height,i=d*a.width,j=e*a.height),a.stroke(0),a.strokeWeight(13),a.strokeCap(a.SQUARE),a.line(f,h,i,j),a.stroke(255),a.strokeWeight(12),a.strokeCap(a.ROUND),a.line(f,h,i,j)},l=function(a){a<c&&j();while(c<=a){if(!h)return;b=h[d]||h;var g=b.pt[c],i=c;e!=null&&k(e,f,g.x,g.y),e=g.x,f=g.y,c===i&&c++}};a.draw=function(){i()},a.setup=function(){},a.construct=function(b,c,d){var e=function(){if(c){h=c.gml.tag.drawing.stroke;var a=(d.end-d.start)/(h.pt||function(a){var b=[];for(var c=0,d=a.length;c<d;c++)b=b.concat(a[c].pt);return b}(h)).length,f=c.gml.tag,j=f.header&&f.header.client&&f.header.client.name;g=j==="Graffiti Analysis 2.0: DustTag"||j==="DustTag: Graffiti Analysis 2.0"||j==="Fat Tag - Katsu Edition",i=function(){b.currentTime<d.endDrawing&&l((b.currentTime-d.start)/a)};return}setTimeout(e,5)};a.size(640,640),a.frameRate(60),a.smooth(),j(),a.noLoop(),e()}};a.plugin("gml",{_setup:function(c){var d=this,e=document.getElementById(c.target);c.endDrawing=c.endDrawing||c.end,c.container=document.createElement("canvas"),c.container.style.display="none",c.container.setAttribute("id","canvas"+c.gmltag);if(!e&&a.plugin.debug)throw new Error("target container doesn't exist");e&&e.appendChild(c.container);var f=function(){a.getJSONP("//000000book.com/data/"+c.gmltag+".json?callback=",function(a){c.pjsInstance=new Processing(c.container,b),c.pjsInstance.construct(d.media,a,c),c._running&&c.pjsInstance.loop()},!1)};window.Processing?f():a.getScript("//processingjs.org/content/download/processing-js-1.3.0/processing-1.3.0.min.js",f)},start:function(a,b){b.pjsInstance&&b.pjsInstance.loop(),b.container.style.display="block"},end:function(a,b){b.pjsInstance&&b.pjsInstance.noLoop(),b.container.style.display="none"},_teardown:function(a){a.pjsInstance&&a.pjsInstance.exit(),document.getElementById(a.target)&&document.getElementById(a.target).removeChild(a.container)}})}(Popcorn),function(a){var b={},c=function(c){if(c.artist){var d="";d="<h3>"+c.artist.name+"</h3>",d+="<a href='"+c.artist.url+"' target='_blank' style='float:left;margin:0 10px 0 0;'><img src='"+c.artist.image[2]["#text"]+"' alt=''></a>",d+="<p>"+c.artist.bio.summary+"</p>",d+="<hr /><p><h4>Tags</h4><ul>",a.forEach(c.artist.tags.tag,function(a,b){d+="<li><a href='"+a.url+"'>"+a.name+"</a></li>"}),d+="</ul></p>",d+="<hr /><p><h4>Similar</h4><ul>",a.forEach(c.artist.similar.artist,function(a,b){d+="<li><a href='"+a.url+"'>"+a.name+"</a></li>"}),d+="</ul></p>",b[c.artist.name.toLowerCase()].htmlString=d}};a.plugin("lastfm",function(){return{_setup:function(d){d._container=document.createElement("div"),d._container.style.display="none",d._container.innerHTML="",d.artist=d.artist&&d.artist.toLowerCase()||"";var e=document.getElementById(d.target);if(!e&&a.plugin.debug)throw new Error("target container doesn't exist");e&&e.appendChild(d._container),b[d.artist]||(b[d.artist]={count:0,htmlString:"Unknown Artist"},a.getJSONP("//ws.audioscrobbler.com/2.0/?method=artist.getinfo&artist="+d.artist+"&api_key="+d.apikey+"&format=json&callback=lastFMcallback",c,!1)),b[d.artist].count++},start:function(a,c){c._container.innerHTML=b[c.artist].htmlString,c._container.style.display="inline"},end:function(a,b){b._container.style.display="none",b._container.innerHTML=""},_teardown:function(a){--b[a.artist].count||delete b[a.artist],document.getElementById(a.target)&&document.getElementById(a.target).removeChild(a._container)}}}(),{about:{name:"Popcorn LastFM Plugin",version:"0.1",author:"Steven Weerdenburg",website:"http://sweerdenburg.wordpress.com/"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"lastfm-container",artist:{elem:"input",type:"text",label:"Artist"}}})}(Popcorn),function(a){a.plugin("lowerthird",{manifest:{about:{name:"Popcorn lowerthird Plugin",version:"0.1",author:"Scott Downe",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"lowerthird-container",salutation:{elem:"input",type:"text",label:"Text"},name:{elem:"input",type:"text",label:"Text"},role:{elem:"input",type:"text",label:"Text"}}},_setup:function(b){var c=document.getElementById(b.target);this.container||(this.container=document.createElement("div"),this.container.style.position="absolute",this.container.style.color="white",this.container.style.textShadow="black 2px 2px 6px",this.container.style.fontSize="24px",this.container.style.fontWeight="bold",this.container.style.paddingLeft="40px",this.container.style.width=this.video.offsetWidth+"px",this.container.style.left=this.position().left+"px",this.video.parentNode.appendChild(this.container));if(b.target&&b.target!=="lowerthird-container"){b.container=document.createElement("div");if(!c&&a.plugin.debug)throw new Error("target container doesn't exist");c&&c.appendChild(b.container)}else b.container=this.container},start:function(a,b){b.container.innerHTML=(b.salutation?b.salutation+" ":"")+b.name+(b.role?"<br />"+b.role:""),this.container.style.top=this.position().top+this.video.offsetHeight-(40+this.container.offsetHeight)+"px"},end:function(a,b){b.container.innerHTML=""}})}(Popcorn),function(a){var b=1,c=!1;a.plugin("googlefeed",function(d){var e=function(){var b=!1,d=0,e=document.getElementsByTagName("link"),f=e.length,g=document.head||document.getElementsByTagName("head")[0],h=document.createElement("link"),i="//www.google.com/uds/solutions/dynamicfeed/gfdynamicfeedcontrol.";window.GFdynamicFeedControl?c=!0:a.getScript(i+"js",function(){c=!0});for(;d<f;d++)e[d].href===i+"css"&&(b=!0);b||(h.type="text/css",h.rel="stylesheet",h.href=i+"css",g.insertBefore(h,g.firstChild))};window.google?e():a.getScript("//www.google.com/jsapi",function(){google.load("feeds","1",{callback:function(){e()}})});var f=document.createElement("div"),g=document.getElementById(d.target),h=function(){c?d.feed=new GFdynamicFeedControl(d.url,f,{vertical:d.orientation.toLowerCase()==="vertical"?!0:!1,horizontal:d.orientation.toLowerCase()==="horizontal"?!0:!1,title:d.title=d.title||"Blog"}):setTimeout(function(){h()},5)};if(!d.orientation||d.orientation.toLowerCase()!=="vertical"&&d.orientation.toLowerCase()!=="horizontal")d.orientation="vertical";f.style.display="none",f.id="_feed"+b,f.style.width="100%",f.style.height="100%",b++;if(!g&&a.plugin.debug)throw new Error("target container doesn't exist");return g&&g.appendChild(f),h(),{start:function(a,b){f.setAttribute("style","display:inline")},end:function(a,b){f.setAttribute("style","display:none")},_teardown:function(a){document.getElementById(a.target)&&document.getElementById(a.target).removeChild(f),delete a.feed}}},{about:{name:"Popcorn Google Feed Plugin",version:"0.1",author:"David Seifried",website:"dseifried.wordpress.com"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"feed-container",url:{elem:"input",type:"url",label:"url"},title:{elem:"input",type:"text",label:"title"},orientation:{elem:"select",options:["Vertical","Horizontal"],label:"orientation"}}})}(Popcorn),function(a){var b=0,c=function(b,c){var d=b.container=document.createElement("div"),e=d.style,f=b.media,g=function(){var a=b.position();e.fontSize="18px",e.width=f.offsetWidth+"px",e.top=a.top+f.offsetHeight-d.offsetHeight-40+"px",e.left=a.left+"px",setTimeout(g,10)};return d.id=c||a.guid(),e.position="absolute",e.color="white",e.textShadow="black 2px 2px 6px",e.fontWeight="bold",e.textAlign="center",g(),b.media.parentNode.appendChild(d),d};a.plugin("subtitle",{manifest:{about:{name:"Popcorn Subtitle Plugin",version:"0.1",author:"Scott Downe",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"subtitle-container",text:{elem:"input",type:"text",label:"Text"}}},_setup:function(a){var d=document.createElement("div");d.id="subtitle-"+b++,d.style.display="none",!this.container&&(!a.target||a.target==="subtitle-container")&&c(this),a.target&&a.target!=="subtitle-container"?a.container=document.getElementById(a.target)||c(this,a.target):a.container=this.container,document.getElementById(a.container.id)&&document.getElementById(a.container.id).appendChild(d),a.innerContainer=d,a.showSubtitle=function(){a.innerContainer.innerHTML=a.text||""}},start:function(a,b){b.innerContainer.style.display="inline",b.showSubtitle(b,b.text)},end:function(a,b){b.innerContainer.style.display="none",b.innerContainer.innerHTML=""},_teardown:function(a){a.container.removeChild(a.innerContainer)}})}(Popcorn),function(a){var b=[],c=function(){this.name="",this.contains={},this.toString=function(){var a=[];for(var b in this.contains)this.contains.hasOwnProperty(b)&&a.push(" "+this.contains[b]);return a.toString()}};a.plugin("tagthisperson",function(){return{_setup:function(d){var e=!1,f=document.getElementById(d.target);if(!f&&a.plugin.debug)throw new Error("target container doesn't exist");for(var g=0;g<b.length;g++)if(b[g].name===d.target){d._p=b[g],e=!0;break}e||(d._p=new c,d._p.name=d.target,b.push(d._p))},start:function(a,b){b._p.contains[b.person]=b.image?"<img src='"+b.image+"'/> ":"",b._p.contains[b.person]+=b.href?"<a href='"+b.href+"' target='_blank'> "+b.person+"</a>":b.person,document.getElementById(b.target).innerHTML=b._p.toString()},end:function(a,b){delete b._p.contains[b.person],document.getElementById(b.target).innerHTML=b._p.toString()}}}(),{about:{name:"Popcorn tagthisperson Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"tagthisperson-container",person:{elem:"input",type:"text",label:"Name"},image:{elem:"input",type:"url",label:"Image Src"},href:{elem:"input",type:"url",label:"URL"}}})}(Popcorn),function(a){var b=!1;a.plugin("twitter",{manifest:{about:{name:"Popcorn Twitter Plugin",version:"0.1",author:"Scott Downe",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"number",label:"In"},end:{elem:"input",type:"number",label:"Out"},src:{elem:"input",type:"text",label:"Source"},target:"twitter-container",height:{elem:"input",type:"number",label:"Height"},width:{elem:"input",type:"number",label:"Width"}}},_setup:function(c){!window.TWTR&&!b&&(b=!0,a.getScript("//widgets.twimg.com/j/2/widget.js"));var d=document.getElementById(c.target);c.container=document.createElement("div"),c.container.setAttribute("id",a.guid()),c.container.style.display="none";if(!d&&a.plugin.debug)throw new Error("target container doesn't exist");d&&d.appendChild(c.container);var e=c.src||"",f=c.width||250,g=c.height||200,h=/^@/.test(e),i={version:2,id:c.container.getAttribute("id"),rpp:30,width:f,height:g,interval:6e3,theme:{shell:{background:"#ffffff",color:"#000000"},tweets:{background:"#ffffff",color:"#444444",links:"#1985b5"}},features:{loop:!0,timestamp:!0,avatars:!0,hashtags:!0,toptweets:!0,live:!0,scrollbar:!1,behavior:"default"}},j=function(a){window.TWTR?h?(i.type="profile",(new TWTR.Widget(i)).render().setUser(e).start()):(i.type="search",i.search=e,i.subject=e,(new TWTR.Widget(i)).render().start()):setTimeout(function(){j(a)},1)};j(this)},start:function(a,b){b.container.style.display="inline"},end:function(a,b){b.container.style.display="none"},_teardown:function(a){document.getElementById(a.target)&&document.getElementById(a.target).removeChild(a.container)}})}(Popcorn),function(a){a.plugin("webpage",{manifest:{about:{name:"Popcorn Webpage Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{id:{elem:"input",type:"text",label:"Id"},start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},src:{elem:"input",type:"url",label:"Src"},target:"iframe-container"}},_setup:function(b){var c=document.getElementById(b.target);b.src=b.src.replace(/^(https?:)?(\/\/)?/,"//"),b._iframe=document.createElement("iframe"),b._iframe.setAttribute("width","100%"),b._iframe.setAttribute("height","100%"),b._iframe.id=b.id,b._iframe.src=b.src,b._iframe.style.display="none";if(!c&&a.plugin.debug)throw new Error("target container doesn't exist");c&&c.appendChild(b._iframe)},start:function(a,b){b._iframe.src=b.src,b._iframe.style.display="inline"},end:function(a,b){b._iframe.style.display="none"},_teardown:function(a){document.getElementById(a.target)&&document.getElementById(a.target).removeChild(a._iframe)}})}(Popcorn);var wikiCallback;(function(a){a.plugin("wikipedia",{manifest:{about:{name:"Popcorn Wikipedia Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},lang:{elem:"input",type:"text",label:"Language"},src:{elem:"input",type:"url",label:"Src"},title:{elem:"input",type:"text",label:"Title"},numberofwords:{elem:"input",type:"text",label:"Num Of Words"},target:"wikipedia-container"}},_setup:function(b){var c,d=a.guid();b.lang||(b.lang="en"),b.numberofwords=b.numberofwords||200,window["wikiCallback"+d]=function(a){b._link=document.createElement("a"),b._link.setAttribute("href",b.src),b._link.setAttribute("target","_blank"),b._link.innerHTML=b.title||a.parse.displaytitle,b._desc=document.createElement("p"),c=a.parse.text["*"].substr(a.parse.text["*"].indexOf("<p>")),c=c.replace(/((<(.|\n)+?>)|(\((.*?)\) )|(\[(.*?)\]))/g,""),c=c.split(" "),b._desc.innerHTML=c.slice(0,c.length>=b.numberofwords?b.numberofwords:c.length).join(" ")+" ...",b._fired=!0};if(b.src)a.getScript("//"+b.lang+".wikipedia.org/w/api.php?action=parse&props=text&page="+b.src.slice(b.src.lastIndexOf("/")+1)+"&format=json&callback=wikiCallback"+d);else if(a.plugin.debug)throw new Error("Wikipedia plugin needs a 'src'")},start:function(a,b){var c=function(){b._fired?b._link&&b._desc&&document.getElementById(b.target)&&(document.getElementById(b.target).appendChild(b._link),document.getElementById(b.target).appendChild(b._desc),b._added=!0):setTimeout(function(){c()},13)};c()},end:function(a,b){b._added&&(document.getElementById(b.target).removeChild(b._link),document.getElementById(b.target).removeChild(b._desc))},_teardown:function(a){a._added&&(a._link.parentNode&&document.getElementById(a.target).removeChild(a._link),a._desc.parentNode&&document.getElementById(a.target).removeChild(a._desc),delete a.target)}})})(Popcorn),function(a,b){var c={text:function(a){var b=a.post,c=document.createElement("a"),d=document.createTextNode(b.title),e=document.createElement("div");c.setAttribute("href",b.post_url),c.appendChild(d),e.appendChild(c),e.innerHTML+=b.body,a._container.appendChild(e)},photo:function(b){var c=b.width||250,d=-1,e=[b.post.photos.length],f=[b.post.photos.length],g=document.createElement("div"),h=document.createElement("img"),i=b.post;for(var j=0,k=i.photos.length;j<k;j++){var l=i.photos[j],m=l.alt_sizes;for(var n=0,o=m.length;n<o;n++){var p=m[n];if(p.width===c){f[j]=p.url,e[j]=l.caption,d=0;break}p.width===250&&(d=n)}d===-1&&a.error("Clearly your blog has a picture that is so tiny it isn't even 250px wide. Consider  using a bigger picture or try a smaller size."),n===m.length&&(f[j]=m[d].url)}for(var q=0,r=f.length;q<r;q++)g.innerHTML+=e[q]+"<br/>",h.setAttribute("src",f[q]),h.setAttribute("alt","Pic"+q),g.appendChild(h),g.innerHTML+="<br/>";g.innerHTML+="<br/>"+i.caption,b._container.appendChild(g)},audio:function(a){var b=document.createElement("div"),c=document.createElement("a"),d=a.post;if(!d.artist){var e=document.createTextNode(d.source_title);c.setAttribute("href",d.source_url),c.appendChild(e),b.appendChild(c),b.innerHTML+="<br/>"}else{var f=document.createElement("img");b.innerHTML+="Artist: "+d.artist+"<br/>",c.setAttribute("href",d.source_url),f.setAttribute("src",d.album_art),f.setAttribute("alt",d.album),c.appendChild(f),b.appendChild(c),b.innerHTML+="<hr/>"+d.track_number+" - "+d.track_name+"<br/>"}b.innerHTML+=d.player+"   "+d.plays+"plays<br/>"+d.caption,a._container.appendChild(b)},video:function(b){var c=b.width||400,d=-1,e=b.post,f=document.createElement("div"),g;for(var h=0,i=e.player.length;h<i;h++){var j=e.player[h];if(j.width===c){g=j.embed_code,d=0;break}j.width===400&&(d=h)}h===b.post.player.length&&(g=e.player[d].embed_code),d===-1&&a.error("Specified video size was not found and default was never found. Please try another width."),f.innerHTML+=g+"<br/>"+e.caption,b._container.appendChild(f)},chat:function(a){var b=a.post,c,d=document.createElement("div");d.innerHTML+="<strong><u>"+b.title+"</u></strong><br/><br/>";for(var e=0,f=b.dialogue.length;e<f;e++)c=b.dialogue[e],d.innerHTML+=c.label+" "+c.phrase+"<br/>";a._container.appendChild(d)},quote:function(a){var b=document.createElement("div"),c=document.createElement("a"),d=a.post,e=document.createTextNode(d.text);c.setAttribute("href",d.post_url),c.appendChild(e),b.appendChild(c),b.innerHTML+="<br/><br/>Source: <b>"+d.source+"</b>",a._container.appendChild(b)},link:function(a){var b=document.createElement("div"),c=document.createElement("a"),d=a.post,e=document.createTextNode(d.title);c.setAttribute("href",d.post_url),c.appendChild(e),b.appendChild(c),b.innerHTML+="<br/>"+d.description,a._container.appendChild(b)},answer:function(a){var b=document.createElement("div"),c=document.createElement("a"),d=a.post,e=document.createTextNode(d.asking_name);b.innerHTML="Inquirer: ",c.setAttribute("href",d.asking_url),c.appendChild(e),b.appendChild(c),b.innerHTML+="<br/><br/>Question: "+d.question+"<br/>Answer: "+d.answer,a._container.appendChild(b)}};a.plugin("tumblr",{manifest:{about:{name:"Popcorn Tumblr Plugin",version:"0.1",author:"Matthew Schranz, @mjschranz",website:"mschranz.wordpress.com"},options:{requestType:{elem:"select",options:["INFO","AVATAR","BLOGPOST"],label:"Type_Of_Plugin"},target:"tumblr-container",start:{elem:"input",type:"number",label:"Start_Time"},end:{elem:"input",type:"number",label:"End_Time"},base_hostname:{elem:"input",type:"text",label:"User_Name"},api_key:{elem:"input",type:"text",label:"Application_Key"},size:{elem:"select",options:[16,24,30,40,48,64,96,128,512],label:"avatarSize"},blogId:{elem:"input",type:"number",label:"Blog_ID"},width:{elem:"input",type:"number",label:"Photo_Width"}}},_setup:function(b){var d=document.getElementById(b.target),e,f,g,h,i,j,k=function(a){return["info","avatar","blogpost"].indexOf(a)>-1};b.requestType=b.requestType.toLowerCase(),(!b.base_hostname||!b.api_key&&(b.requestType==="info"||b.requestType==="blogpost"))&&a.error("Must provide a blog URL to the plugin and an api_key for Blog Info and Blog Post requests."),!k(b.requestType)&&a.error("Invalid tumblr plugin type."),b.requestType==="blogpost"&&b.blogId===undefined&&a.error("Error. BlogId required for blogpost requests"),!d&&a.plugin.debug&&a.error("Target Tumblr container doesn't exist."),f=b.base_hostname.slice(b.base_hostname.indexOf("/")+2,b.base_hostname.length),g=b.base_hostname.slice(0,b.base_hostname.indexOf("/")+2),h=g==="http://"||g==="https://"?f:b.base_hostname,h.indexOf("/")>-1&&(h=h.slice(0,h.indexOf("/"))),b.base_hostname=h,b._container=document.createElement("div"),b._container.id="tumblrdiv-"+a.guid(),b.requestType==="avatar"?b._container.innerHTML="<img src=http://api.tumblr.com/v2/blog/"+b.base_hostname+"/avatar/"+b.size+" alt='BlogAvatar' />":(b.requestType==="blogpost"?j="posts":j="info",e="http://api.tumblr.com/v2/blog/"+b.base_hostname+"/"+j+"?api_key="+b.api_key+"&id="+b.blogId+"&jsonp=tumblrCallBack",a.getJSONP(e,function(d){if(d.meta.msg==="OK"){var e=document.createElement("div");if(b.requestType==="blogpost"){b.post=d.response.posts[0];var f=b.post.type,g=b.post,h=g.tags;e.innerHTML="Date Published: "+b.post.date.slice(0,b.post.date.indexOf(" "))+"<br/>";if(h.length!==0){e.innerHTML+="Tags: "+h[0];for(var i=1,j=h.length;i<j;i++)e.innerHTML+=", "+h[i]}else e.innerHTML+="Tags: No Tags Used";b._container.appendChild(e),c[f](b)}else{var k=document.createElement("a"),l=d.response.blog,m=document.createTextNode(l.title);k.setAttribute("href",l.url),k.appendChild(m),e.appendChild(k),e.innerHTML+=l.description,b._container.appendChild(e)}}else a.error("Error. Request failed. Status code: "+d.meta.status+" - Message: "+d.meta.msg)},!1)),b._container.style.display="none",d&&d.appendChild(b._container)},start:function(a,b){b._container&&(b._container.style.display="")},end:function(a,b){b._container&&(b._container.style.display="none")},_teardown:function(a){document.getElementById(a.target)&&document.getElementById(a.target).removeChild(a._container)}})}(Popcorn,this),function(a){a.plugin("linkedin",{manifest:{about:{name:"Popcorn LinkedIn Plugin",version:"0.1",author:"Dan Ventura",website:"dsventura.blogspot.com"},options:{type:{elem:"input",type:"text",label:"Type"},url:{elem:"input",type:"text",label:"URL"},apikey:{elem:"input",type:"text",label:"API Key"},counter:{elem:"input",type:"text",label:"Counter"},memberid:{elem:"input",type:"text",label:"Member ID"},format:{elem:"input",type:"text",label:"Format"},companyid:{elem:"input",type:"text",label:"Company ID"},modules:{elem:"input",type:"text",label:"Modules"},productid:{elem:"input",type:"text",label:"productid"},related:{elem:"input",type:"text",label:"related"},start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"linkedin-container"}},_setup:function(b){var c=b.apikey,d=document.getElementById(b.target),e=document.createElement("script");a.getScript("//platform.linkedin.com/in.js"),b._container=document.createElement("div"),b._container.appendChild(e),c&&(e.innerHTML="api_key: "+c),b.type=b.type&&b.type.toLowerCase()||"";var f=function(){b._container=document.createElement("p"),b._container.innerHTML="Plugin requires a valid <a href='https://www.linkedin.com/secure/developer'>apikey</a>";if(!d&&a.plugin.debug)throw"target container doesn't exist";d&&d.appendChild(b._container)},g=function(a){return{share:function(){e.setAttribute("type","IN/Share"),a.counter&&e.setAttribute("data-counter",a.counter),a.url&&e.setAttribute("data-url",a.url)},memberprofile:function(){e.setAttribute("type","IN/MemberProfile"),e.setAttribute("data-id",a.memberid),e.setAttribute("data-format",a.format||"inline"),a.text&&a.format.toLowerCase()!=="inline"&&e.setAttribute("data-text",a.text)},companyinsider:function(){e.setAttribute("type","IN/CompanyInsider"),e.setAttribute("data-id",a.companyid),a.modules&&a._container.setAttribute("data-modules",a.modules)},companyprofile:function(){e.setAttribute("type","IN/CompanyProfile"),e.setAttribute("data-id",a.companyid),e.setAttribute("data-format",a.format||"inline"),a.text&&a.format.toLowerCase()!=="inline"&&e.setAttribute("data-text",a.text),a.related!==undefined&&e.setAttribute("data-related",a.related)},recommendproduct:function(){e.setAttribute("type","IN/RecommendProduct"),e.setAttribute("data-company",a.companyid||"LinkedIn"),e.setAttribute("data-product",a.productid||"201714"),a.counter&&e.setAttribute("data-counter",a.counter)}}}(b);c?g[b.type]&&g[b.type]():f();if(!d&&a.plugin.debug)throw new Error("target container doesn't exist");d&&d.appendChild(b._container),b._container.style.display="none"},start:function(a,b){b._container.style.display="block"},end:function(a,b){b._container.style.display="none"},_teardown:function(a){var b=document.getElementById(a.target);b&&b.removeChild(a._container)}})}(Popcorn),function(a){a.plugin("mustache",function(b){var c,d,e,f;a.getScript("https://github.com/janl/mustache.js/raw/master/mustache.js");var g=!!b.dynamic,h=typeof b.template,i=typeof b.data,j=document.getElementById(b.target);if(!j&&a.plugin.debug)throw new Error("target container doesn't exist");b.container=j||document.createElement("div");if(h==="function")g?e=b.template:f=b.template(b);else if(h==="string")f=b.template;else{if(a.plugin.debug)throw new Error("Mustache Plugin Error: options.template must be a String or a Function.");f=""}if(i==="function")g?c=b.data:d=b.data(b);else if(i==="string")d=JSON.parse(b.data);else if(i==="object")d=b.data;else{if(a.plugin.debug)throw new Error("Mustache Plugin Error: options.data must be a String, Object, or Function.");d=""}return{start:function(a,b){var g=function(){if(!window.Mustache)setTimeout(function(){g()},10);else{c&&(d=c(b)),e&&(f=e(b));var a=Mustache.to_html(f,d).replace(/^\s*/mg,"");b.container.innerHTML=a}};g()},end:function(a,b){b.container.innerHTML=""},_teardown:function(a){c=d=e=f=null}}},{about:{name:"Popcorn Mustache Plugin",version:"0.1",author:"David Humphrey (@humphd)",website:"http://vocamus.net/dave"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"mustache-container",template:{elem:"input",type:"text",label:"Template"},data:{elem:"input",type:"text",label:"Data"},dynamic:{elem:"input",type:"text",label:"Dynamic"}}})}(Popcorn),function(a){function d(a,b){if(a.map){a.map.div.style.display=b;return}setTimeout(function(){d(a,b)},10)}var b,c=1;a.plugin("openmap",function(b){var e,f,g,h,j,k,l,m,n=document.getElementById(b.target);e=document.createElement("div"),e.id="openmapdiv"+c,e.style.width="100%",e.style.height="100%",c++;if(!n&&a.plugin.debug)throw new Error("target container doesn't exist");return n&&n.appendChild(e),m=function(){if(!window.OpenLayers)setTimeout(function(){m()},50);else{b.location?(location=new OpenLayers.LonLat(0,0),a.getJSONP("//tinygeocoder.com/create-api.php?q="+b.location+"&callback=jsonp",function(a){f=new OpenLayers.LonLat(a[1],a[0]),b.map.setCenter(f)})):f=new OpenLayers.LonLat(b.lng,b.lat),b.type=b.type||"ROADMAP";if(b.type==="SATELLITE"){b.map=new OpenLayers.Map({div:e,maxResolution:.28125,tileSize:new OpenLayers.Size(512,512)});var c=new OpenLayers.Layer.WorldWind("LANDSAT","//worldwind25.arc.nasa.gov/tile/tile.aspx",2.25,4,{T:"105"});b.map.addLayer(c),h=new OpenLayers.Projection("EPSG:4326"),g=new OpenLayers.Projection("EPSG:4326")}else if(b.type==="TERRAIN"){h=new OpenLayers.Projection("EPSG:4326"),g=new OpenLayers.Projection("EPSG:4326"),b.map=new OpenLayers.Map({div:e,projection:g});var d=new OpenLayers.Layer.WMS("USGS Terraserver","//terraserver-usa.org/ogcmap.ashx?",{layers:"DRG"});b.map.addLayer(d)}else{g=new OpenLayers.Projection("EPSG:900913"),h=new OpenLayers.Projection("EPSG:4326"),f=f.transform(h,g),b.map=new OpenLayers.Map({div:e,projection:g,displayProjection:h});var i=new OpenLayers.Layer.OSM;b.map.addLayer(i)}b.map&&(b.map.div.style.display="none")}},m(),{_setup:function(b){window.OpenLayers||a.getScript("//openlayers.org/api/OpenLayers.js");var c=function(){if(!b.map)setTimeout(function(){c()},13);else{b.zoom=b.zoom||2,b.zoom&&typeof b.zoom!="number"&&(b.zoom=+b.zoom),b.map.setCenter(f,b.zoom);if(b.markers){var d=OpenLayers.Util.extend({},OpenLayers.Feature.Vector.style["default"]),e=function(a){clickedFeature=a.feature;if(!clickedFeature.attributes.text)return;l=new OpenLayers.Popup.FramedCloud("featurePopup",clickedFeature.geometry.getBounds().getCenterLonLat(),new OpenLayers.Size(120,250),clickedFeature.attributes.text,null,!0,function(a){k.unselect(this.feature)}),clickedFeature.popup=l,l.feature=clickedFeature,b.map.addPopup(l)},i=function(a){feature=a.feature,feature.popup&&(l.feature=null,b.map.removePopup(feature.popup),feature.popup.destroy(),feature.popup=null)},m=function(b){a.getJSONP("//tinygeocoder.com/create-api.php?q="+b.location+"&callback=jsonp",function(a){var c=(new OpenLayers.Geometry.Point(a[1],a[0])).transform(h,g),e=OpenLayers.Util.extend({},d);if(!b.size||isNaN(b.size))b.size=14;e.pointRadius=b.size,e.graphicOpacity=1,e.externalGraphic=b.icon;var f=new OpenLayers.Feature.Vector(c,null,e);b.text&&(f.attributes={text:b.text}),j.addFeatures([f])})};j=new OpenLayers.Layer.Vector("Point Layer",{style:d}),b.map.addLayer(j);for(var n=0,o=b.markers.length;n<o;n++){var p=b.markers[n];p.text&&(k||(k=new OpenLayers.Control.SelectFeature(j),b.map.addControl(k),k.activate(),j.events.on({featureselected:e,featureunselected:i})));if(p.location){var q=m;q(p)}else{var r=(new OpenLayers.Geometry.Point(p.lng,p.lat)).transform(h,g),s=OpenLayers.Util.extend({},d);if(!p.size||isNaN(p.size))p.size=14;s.pointRadius=p.size,s.graphicOpacity=1,s.externalGraphic=p.icon;var t=new OpenLayers.Feature.Vector(r,null,s);p.text&&(t.attributes={text:p.text}),j.addFeatures([t])}}}}};c()},start:function(a,b){d(b,"block")},end:function(a,b){d(b,"none")},_teardown:function(a){n&&n.removeChild(e),e=map=f=g=h=j=k=l=null}}},{about:{name:"Popcorn OpenMap Plugin",version:"0.3",author:"@mapmeld",website:"mapadelsur.blogspot.com"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"map-container",type:{elem:"select",options:["ROADMAP","SATELLITE","TERRAIN"],label:"Type"},zoom:{elem:"input",type:"text",label:"Zoom"},lat:{elem:"input",type:"text",label:"Lat"},lng:{elem:"input",type:"text",label:"Lng"},location:{elem:"input",type:"text",label:"Location"},markers:{elem:"input",type:"text",label:"List Markers"}}})}(Popcorn),document.addEventListener("click",function(a){var b=a.target;(b.nodeName==="A"||b.parentNode&&b.parentNode.nodeName==="A")&&Popcorn.instances.forEach(function(a){a.options.pauseOnLinkClicked&&a.pause()})},!1),function(a){var b={},c=0,d=function(a){b[a]=document.createElement("div");var c=document.getElementById(a);return c&&c.appendChild(b[a]),b[a].style.height="100%",b[a].style.position="relative",b[a]},e=document.createElement("span"),f=["webkit","Moz","ms","O",""],g=["Transform","TransitionDuration","TransitionTimingFunction"],h={},i;document.getElementsByTagName("head")[0].appendChild(e);for(var j=0,k=g.length;j<k;j++)for(var l=0,m=f.length;l<m;l++){i=f[l]+g[j];if(i in e.style){h[g[j].toLowerCase()]=i;break}}document.getElementsByTagName("head")[0].appendChild(e),a.plugin("wordriver",{manifest:{about:{name:"Popcorn WordRiver Plugin"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"wordriver-container",text:{elem:"input",type:"text",label:"Text"},color:{elem:"input",type:"text",label:"Color"}}},_setup:function(c){if(!document.getElementById(c.target)&&a.plugin.debug)throw new Error("target container doesn't exist");c._duration=c.end-c.start,c._container=b[c.target]||d(c.target),c.word=document.createElement("span"),c.word.style.position="absolute",c.word.style.whiteSpace="nowrap",c.word.style.opacity=0,c.word.style.MozTransitionProperty="opacity, -moz-transform",c.word.style.webkitTransitionProperty="opacity, -webkit-transform",c.word.style.OTransitionProperty="opacity, -o-transform",c.word.style.transitionProperty="opacity, transform",c.word.style[h.transitionduration]="1s, "+c._duration+"s",c.word.style[h.transitiontimingfunction]="linear",c.word.innerHTML=c.text,c.word.style.color=c.color||"black"},start:function(a,b){b._container.appendChild(b.word),b.word.style[h.transform]="",b.word.style.fontSize=~~(30+20*Math.random())+"px",c%=b._container.offsetWidth-b.word.offsetWidth,b.word.style.left=c+"px",c+=b.word.offsetWidth+10,b.word.style[h.transform]="translateY("+(b._container.offsetHeight-b.word.offsetHeight)+"px)",b.word.style.opacity=1,setTimeout(function(){b.word.style.opacity=0},(b.end-b.start-1||1)*1e3)},end:function(a,b){b.word.style.opacity=0},_teardown:function(a){var c=document.getElementById(a.target);a.word.parentNode&&a._container.removeChild(a.word),b[a.target]&&!b[a.target].childElementCount&&c&&c.removeChild(b[a.target])&&delete b[a.target]}})}(Popcorn),function(a){a.plugin("processing",function(b){var c=function(c){function d(b){var d=function(){c.listen("pause",function(){b.canvas.style.display==="inline"&&b.pjsInstance.noLoop()}),c.listen("play",function(){b.canvas.style.display==="inline"&&b.pjsInstance.loop()})};if(b.sketch)a.xhr({url:b.sketch,dataType:"text",success:function(a){b.codeReady=!1;var e=Processing.compile(a);b.pjsInstance=new Processing(b.canvas,e),b.seeking=!1,b._running&&!c.media.paused&&b.pjsInstance.loop()||b.pjsInstance.noLoop(),c.listen("seeking",function(){b._running&&b.canvas.style.display==="inline"&&b.noPause&&b.pjsInstance.loop()}),b.noPause=b.noPause||!1,!b.noPause&&d(),b.codeReady=!0}});else if(a.plugin.debug)throw new Error("Popcorn.Processing: options.sketch is undefined")}window.Processing?d(b):a.getScript("//wac.1237.edgecastcdn.net/801237/cdn.processingjs.org/content/download/processing-js-1.3.6/processing-1.3.6.min.js",function(){d(b)})};return{_setup:function(b){b.codeReady=!1,b.parentTarget=document.getElementById(b.target);if(!b.parentTarget&&a.plugin.debug)throw new Error("target container doesn't exist");var d=document.createElement("canvas");d.id=a.guid(b.target+"-sketch"),d.style.display="none",b.canvas=d,b.parentTarget&&b.parentTarget.appendChild(b.canvas),c(this)},start:function(a,b){b.codeReady&&!this.media.paused&&b.pjsInstance.loop(),b.canvas.style.display="inline"},end:function(a,b){b.pjsInstance&&b.pjsInstance.noLoop(),b.canvas.style.display="none"},_teardown:function(a){a.pjsInstance&&a.pjsInstance.exit(),a.parentTarget&&a.parentTarget.removeChild(a.canvas)}}},{about:{name:"Popcorn Processing Plugin",version:"0.1",author:"Christopher De Cairos, Benjamin Chalovich",website:"cadecairos.blogspot.com, ben1amin.wordpress.org"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:{elem:"input",type:"text",label:"Target"},sketch:{elem:"input",type:"url",label:"Sketch"},noPause:{elem:"select",options:["TRUE","FALSE"],label:"No Loop"}}})}(Popcorn),function(a){var b=1;a.plugin("timeline",function(c){var d=document.getElementById(c.target),e=document.createElement("div"),f,g=!0;d&&!d.firstChild?(d.appendChild(f=document.createElement("div")),f.style.width="inherit",f.style.height="inherit",f.style.overflow="auto"):f=d.firstChild,e.style.display="none",e.id="timelineDiv"+b,c.direction=c.direction||"up",c.direction.toLowerCase()==="down"&&(g=!1);if(d&&f)g?f.insertBefore(e,f.firstChild):f.appendChild(e);else if(a.plugin.debug)throw new Error("target container doesn't exist");return b++,e.innerHTML="<p><span id='big' style='font-size:24px; line-height: 130%;' >"+c.title+"</span><br />"+"<span id='mid' style='font-size: 16px;'>"+c.text+"</span><br />"+c.innerHTML,{start:function(a,b){e.style.display="block",b.direction==="down"&&(f.scrollTop=f.scrollHeight)},end:function(a,b){e.style.display="none"},_teardown:function(a){f&&e&&f.removeChild(e)&&!f.firstChild&&d.removeChild(f)}}},{about:{name:"Popcorn Timeline Plugin",version:"0.1",author:"David Seifried @dcseifried",website:"dseifried.wordpress.com"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"feed-container",title:{elem:"input",type:"text",label:"title"},text:{elem:"input",type:"text",label:"text"},innerHTML:{elem:"input",type:"text",label:"innerHTML"},direction:{elem:"input",type:"text",label:"direction"}}})}(Popcorn),function(a,b){var c={};a.plugin("documentcloud",{manifest:{about:{name:"Popcorn Document Cloud Plugin",version:"0.1",author:"@humphd, @ChrisDeCairos",website:"http://vocamus.net/dave"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"documentcloud-container",width:{elem:"input",type:"text",label:"Width"},height:{elem:"input",type:"text",label:"Height"},src:{elem:"input",type:"text",label:"PDF URL"},preload:{elem:"input",type:"boolean",label:"Preload"},page:{elem:"input",type:"number",label:"Page Number"},aid:{elem:"input",type:"number",label:"Annotation Id"}}},_setup:function(d){function g(){function v(a){d._key=a.api.getId(),d._changeView=function(a){d.aid?a.pageSet.showAnnotation(a.api.getAnnotation(d.aid)):a.api.setCurrentPage(d.page)}}function w(b){var f=!1;return a.forEach(e.viewers,function(a,g){if(a.api.getSchema().canonicalURL===b){var h;v(a),h=c[d._key],d._containerId=h.id,h.num+=1,f=!0,e.loaded=!0}}),f}function x(){var a={num:1,id:d._containerId};c[d._key]=a,e.loaded=!0}e.loaded=!1;var g=d.url.replace(/\.html$/,".js"),h=d.target,i=b.getElementById(h),j=b.createElement("div"),k=a.position(i),l=d.width||k.width,m=d.height||k.height,n=d.sidebar||!0,o=d.text||!0,p=d.pdf||!0,q=d.showAnnotations||!0,r=d.zoom||700,s=d.search||!0,t=d.page,u;if(!w(d.url)){j.id=d._containerId=a.guid(h),u="#"+j.id,i.appendChild(j),f.trigger("documentready");var y=d.page||d.aid?function(a){v(a),d._changeView(a),j.style.visibility="hidden",a.elements.pages.hide(),x()}:function(a){v(a),x(),j.style.visibility="hidden",a.elements.pages.hide()};e.load(g,{width:l,height:m,sidebar:n,text:o,pdf:p,showAnnotations:q,zoom:r,search:s,container:u,afterLoad:y})}}function h(){window.DV.loaded?g():setTimeout(h,25)}var e=window.DV=window.DV||{},f=this;if(!e.loading){e.loading=!0,e.recordHit="//www.documentcloud.org/pixel.gif";var i=b.createElement("link"),j=b.getElementsByTagName("head")[0];i.rel="stylesheet",i.type="text/css",i.media="screen",i.href="//s3.documentcloud.org/viewer/viewer-datauri.css",j.appendChild(i),e.loaded=!1,a.getScript("http://s3.documentcloud.org/viewer/viewer.js",function(){e.loading=!1,g()})}else h()},start:function(a,c){var d=b.getElementById(c._containerId),e=DV.viewers[c._key];(c.page||c.aid)&&e&&c._changeView(e),d&&e&&(d.style.visibility="visible",e.elements.pages.show())},end:function(a,c){var d=b.getElementById(c._containerId);d&&DV.viewers[c._key]&&(d.style.visibility="hidden",DV.viewers[c._key].elements.pages.hide())},_teardown:function(a){var d=b.getElementById(a._containerId),e=a._key;if(e&&DV.viewers[e]&&--c[e].num===0){DV.viewers[e].api.unload();while(d.hasChildNodes())d.removeChild(d.lastChild);d.parentNode.removeChild(d)}}})}(Popcorn,window.document),function(a){a.parser("parseJSON","JSON",function(b){var c={title:"",remote:"",data:[]},d={},e=b;return a.forEach(e.data,function(a,b){c.data.push(a)}),c})}(Popcorn),function(a){a.parser("parseSBV",function(a){var b={title:"",remote:"",data:[]},c=[],d,e=0,f=0,g=0,h=function(a){var b=a.split(":"),c=b.length-1,d;try{d=parseInt(b[c-1],10)*60+parseFloat(b[c],10),c===2&&(d+=parseInt(b[0],10)*3600)}catch(e){throw"Bad cue"}return d},i=function(a,b){var c={};return c[a]=b,c};d=a.text.split(/(?:\r\n|\r|\n)/gm),f=d.length;while(e<f){var j={},k=[],l=d[e++].split(",");try{j.start=h(l[0]),j.end=h(l[1]);while(e<f&&d[e])k.push(d[e++]);j.text=k.join("<br />"),c.push(i("subtitle",j))}catch(m){while(e<f&&d[e])e++}while(e<f&&!d[e])e++}return b.data=c,b})}(Popcorn),function(a){a.parser("parseSRT",function(a){var b={title:"",remote:"",data:[]},c=[],d=0,e=0,f=0,g,h,i,j,k=function(a){var b=a.split(":");try{var c=b[2].split(",");return c.length===1&&(c=b[2].split(".")),parseFloat(b[0],10)*3600+parseFloat(b[1],10)*60+parseFloat(c[0],10)+parseFloat(c[1],10)/1e3}catch(d){return 0}},l=function(a,b){var c={};return c[a]=b,c};g=a.text.split(/(?:\r\n|\r|\n)/gm),e=g.length;for(d=0;d<e;d++){j={},i=[],j.id=parseInt(g[d++],10),h=g[d++].split(/[\t ]*-->[\t ]*/),j.start=k(h[0]),f=h[1].indexOf(" "),f!==-1&&(h[1]=h[1].substr(0,f)),j.end=k(h[1]);while(d<e&&g[d])i.push(g[d++]);j.text=i.join("\\N").replace(/\{(\\[\w]+\(?([\w\d]+,?)+\)?)+\}/gi,""),j.text=j.text.replace(/</g,"&lt;").replace(/>/g,"&gt;"),j.text=j.text.replace(/&lt;(\/?(font|b|u|i|s))((\s+(\w|\w[\w\-]*\w)(\s*=\s*(?:\".*?\"|'.*?'|[^'\">\s]+))?)+\s*|\s*)(\/?)&gt;/gi,"<$1$3$7>"),j.text=j.text.replace(/\\N/gi,"<br />"),c.push(l("subtitle",j))}return b.data=c,b})}(Popcorn),function(a){function b(a,b){var e=a.substr(10).split(","),f=/\{(\\[\w]+\(?([\w\d]+,?)+\)?)+\}/gi,g=/\\N/gi,h;h={start:c(e[b.start]),end:c(e[b.end])};if(h.start===-1||h.end===-1)throw"Invalid time";return h.text=d(e,b.text).replace(f,"").replace(g,"<br />"),h}function c(a){var b=a.split(":");return a.length!==10||b.length<3?-1:parseInt(b[0],10)*3600+parseInt(b[1],10)*60+parseFloat(b[2],10)}function d(a,b){var c=a.length,d=[],e=b;for(;e<c;e++)d.push(a[e]);return d.join(",")}function e(a,b){var c={};return c[a]=b,c}function f(a){var b=a.substr(8).split(", "),c={},d,e;for(e=0,d=b.length;e<d;e++)b[e]==="Start"?c.start=e:b[e]==="End"?c.end=e:b[e]==="Text"&&(c.text=e);return c}a.parser("parseSSA",function(a){var c={title:"",remote:"",data:[]},d=/(?:\r\n|\r|\n)/gm,g=[],h,i,j=0,k;h=a.text.split(d),k=h.length;while(j<k&&h[j]!=="[Events]")j++;i=f(h[++j]);while(++j<k&&h[j]&&h[j][0]!=="[")try{g.push(e("subtitle",b(h[j],i)))}catch(l){}return c.data=g,c})}(Popcorn),function(a){a.parser("parseTTML",function(a){var b={title:"",remote:"",data:[]},c,d=0,e,f=function(a,b){if(!a)return-1;var c=a.split(":"),d=c.length-1,e,f,g;if(d>=2)return parseInt(c[0],10)*3600+parseInt(c[d-1],10)*60+parseFloat(c[d],10);for(g=a.length-1;g>=0;g--)if(a[g]<="9"&&a[g]>="0")break;g++,e=a.substr(g),b=b||0;if(e==="h")f=3600;else if(e==="m")f=60;else if(e==="s")f=1;else{if(e!=="ms")return-1;f=.001}return parseFloat(a.substr(0,g))*f+b},g=function(a,b){var c={};return c[a]=b,c},h=function(a,b){var c={};return c.text=a.textContent.replace(/^[\s]+|[\s]+$/gm,"").replace(/(?:\r\n|\r|\n)/gm,"<br />"),c.id=a.getAttribute("xml:id")||a.getAttribute("id"),c.start=f(a.getAttribute("begin"),b),c.end=f(a.getAttribute("end"),b),c.target=e,c.end<0&&(c.end=f(a.getAttribute("duration"),0),c.end>=0?c.end+=c.start:c.end=Number.MAX_VALUE),c},i=function(a,c){var e=a.firstChild,j,k;while(e)e.nodeType===1&&(e.nodeName==="p"?(j=h(e,c),b.data.push(g("subtitle",j)),d++):e.nodeName==="div"&&(k=f(e.getAttribute("begin")),k<0&&(k=c),i(e,k))),e=e.nextSibling};if(!a.xml||!a.xml.documentElement||!(c=a.xml.documentElement.firstChild))return b;while(c.nodeName!=="body")c=c.nextSibling;return e="",i(c,0),b})}(Popcorn),function(a){a.parser("parseTTXT",function(a){var b={title:"",remote:"",data:[]},c=function(a){var b=a.split(":"),c=0;try{return parseFloat(b[0],10)*60*60+parseFloat(b[1],10)*60+parseFloat(b[2],10)}catch(d){c=0}return c},d=function(a,b){var c={};return c[a]=b,c},e=a.xml.lastChild.lastChild,f=Number.MAX_VALUE,g=[];while(e){if(e.nodeType===1&&e.nodeName==="TextSample"){var h={};h.start=c(e.getAttribute("sampleTime")),h.text=e.getAttribute("text"),h.text&&(h.end=f-.001,g.push(d("subtitle",h))),f=h.start}e=e.previousSibling}return b.data=g.reverse(),b})}(Popcorn),function(a){function b(a){var b=a.split(":"),c=a.length,d;if(c!==12&&c!==9)throw"Bad cue";c=b.length-1;try{d=parseInt(b[c-1],10)*60+parseFloat(b[c],10),c===2&&(d+=parseInt(b[0],10)*3600)}catch(e){throw"Bad cue"}return d}function c(a,b){var c={};return c[a]=b,c}function d(a){var c,d,e={},f=/-->/,g=/[\t ]+/;if(!a||a.indexOf("-->")===-1)throw"Bad cue";c=a.replace(f," --> ").split(g);if(c.length<2)throw"Bad cue";return e.id=a,e.start=b(c[0]),e.end=b(c[2]),e}function e(a,b,c){while(c<b&&!a[c])c++;return c}function f(a,b,c){while(c<b&&a[c])c++;return c}a.parser("parseVTT",function(a){var b={title:"",remote:"",data:[]},g=[],h=0,i=0,j,k,l,m=/(?:\r\n|\r|\n)/gm;j=a.text.split(m),i=j.length;if(i===0||j[0]!=="WEBVTT")return b;h++;while(h<i){k=[];try{h=e(j,i,h),l=d(j[h++]);while(h<i&&j[h])k.push(j[h++]);l.text=k.join("<br />"),g.push(c("subtitle",l))}catch(n){h=f(j,i,h)}}return b.data=g,b})}(Popcorn),function(a){a.parser("parseXML","XML",function(b){var c={title:"",remote:"",data:[]},d={},e=function(a){var b=a.split(":");if(b.length===1)return parseFloat(b[0],10);if(b.length===2)return parseFloat(b[0],10)+parseFloat(b[1]/12,10);if(b.length===3)return parseInt(b[0]*60,10)+parseFloat(b[1],10)+parseFloat(b[2]/12,10);if(b.length===4)return parseInt(b[0]*3600,10)+parseInt(b[1]*60,10)+parseFloat(b[2],10)+parseFloat(b[3]/12,10)},f=function(b){var c={};for(var f=0,g=b.length;f<g;f++){var h=b.item(f).nodeName,i=b.item(f).nodeValue;h==="in"?c.start=e(i):h==="out"?c.end=e(i):h==="resourceid"?a.extend(c,d[i]):c[h]=i}return c},g=function(a,b){var c={};return c[a]=b,c},h=function(b,e,i){var j={};a.extend(j,e,f(b.attributes),{text:b.textContent});var k=b.childNodes;if(k.length<1||k.length===1&&k[0].nodeType===3)i?d[j.id]=j:c.data.push(g(b.nodeName,j));else for(var l=0;l<k.length;l++)k[l].nodeType===1&&h(k[l],j,i)},i=b.documentElement.childNodes;for(var j=0,k=i.length;j<k;j++)i[j].nodeType===1&&(i[j].nodeName==="manifest"?h(i[j],{},!0):h(i[j],{},!1));return c})}(Popcorn),function(a,b){function i(){return b.swfobject&&b.soundcloud}function j(a,c){if(a.currentStyle)return a.currentStyle[c];if(b.getComputedStyle)return document.defaultView.getComputedStyle(a,null).getPropertyValue(c)}function k(a){function b(a){function c(a,b){return a+" "+b+(a>1?"s":"")+" ago"}var b=((new Date).getTime()-a.getTime())/1e3;return b<60?c(g(b),"second"):(b/=60,b<60?c(g(b),"minute"):(b/=60,b<24?c(g(b),"hour"):(b/=24,b<30?c(g(b),"day"):b<365?c(g(b/30),"month"):c(g(b/365),"year"))))}function c(a){var b=f(a/60),c=g(a%60);return b+"."+(c<10?"0":"")+c}return'<div><a href="'+a.user.profile+'">'+'<img width="16px height="16px" src="'+a.user.avatar+'"></img>'+a.user.name+"</a> at "+c(a.start)+" "+b(a.date)+"<br />"+a.text+"</span>"}function l(a){if(!i()){setTimeout(function(){l(a)},15);return}var b={enable_api:!0,object_id:a._playerId,url:a.src,show_comments:!a._options.api.key&&!a._options.api.commentdiv},c={allowscriptaccess:"always",wmode:"transparent"},d={id:a._playerId,name:a._playerId},e=document.createElement("div");e.setAttribute("id",a._playerId),a._container.appendChild(e),swfobject.embedSWF("http://player.soundcloud.com/player.swf",a._playerId,a.offsetWidth,a.height,"9.0.0","expressInstall.swf",b,c,d)}var c=33,d=.25,e=Math.abs,f=Math.floor,g=Math.round,h={};a.soundcloud=function(b,c,d){return a.getScript("http://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js"),a.getScript("http://popcornjs.org/code/players/soundcloud/lib/soundcloud.player.api.js",function(){var a=1;soundcloud.addEventListener("onPlayerReady",function(a,b){var c=h[a.api_getFlashId()];c.swfObj=a,c.duration=a.api_getTrackDuration(),c.currentTime=a.api_getTrackPosition(),c.volume=c.previousVolume=a.api_getVolume()/100,c._mediaId=b.mediaId,c.dispatchEvent("load"),c.dispatchEvent("canplay"),c.dispatchEvent("durationchange"),c.timeupdate()}),soundcloud.addEventListener("onMediaStart",function(a,b){var c=h[a.api_getFlashId()];c.played=1,c.dispatchEvent("playing")}),soundcloud.addEventListener("onMediaPlay",function(b,c){if(a){a=0;return}var d=h[b.api_getFlashId()];d.dispatchEvent("play")}),soundcloud.addEventListener("onMediaPause",function(a,b){var c=h[a.api_getFlashId()];c.dispatchEvent("pause")}),soundcloud.addEventListener("onMediaBuffering",function(a,b){var c=h[a.api_getFlashId()];c.dispatchEvent("progress"),c.readyState===0&&(c.readyState=3,c.dispatchEvent("readystatechange"))}),soundcloud.addEventListener("onMediaDoneBuffering",function(a,b){var c=h[a.api_getFlashId()];c.dispatchEvent("canplaythrough")}),soundcloud.addEventListener("onMediaEnd",function(a,b){var c=h[a.api_getFlashId()];c.paused=1,c.dispatchEvent("ended")}),soundcloud.addEventListener("onMediaSeek",function(a,b){var c=h[a.api_getFlashId()];c.setCurrentTime(a.api_getTrackPosition()),c.paused&&c.dispatchEvent("timeupdate")}),soundcloud.addEventListener("onPlayerError",function(a,b){var c=h[a.api_getFlashId()];c.dispatchEvent("error")})}),new a.soundcloud.init(b,c,d)},a.soundcloud.init=function(){function b(a){var b=a._options,c=a._container,d=c.getBoundingClientRect(),e,f;a.width=b.width||j(c,"width")||"100%",a.height=b.height||j(c,"height")||"81px",a.src=b.src,a.autoplay=b.autoplay,parseFloat(a.height,10)!==81&&(a.height="81px"),a.offsetLeft=d.left,a.offsetTop=d.top,a.offsetHeight=parseFloat(a.height,10),a.offsetWidth=parseFloat(a.width,10),/[\d]+%/.test(a.width)&&(e=j(c,"width"),a._container.style.width=a.width,a.offsetWidth=a._container.offsetWidth,a._container.style.width=e),/[\d]+%/.test(a.height)&&(e=j(c,"height"),a._container.style.height=a.height,a.offsetHeight=a._container.offsetHeight,a._container.style.height=e)}var c=function(c,d,e){if(!c)throw"Must supply an id!";if(!d)throw"Must supply a source!";if(/file/.test(location.protocol))throw"Must run from a web server!";var f=this._container=document.getElementById(c);if(!f)throw"Could not find that container in the DOM!";e=e||{},e.api=e.api||{},e.target=c,e.src=d,e.api.commentformat=e.api.commentformat||k,this._mediaId=0,this._listeners={},this._playerId=a.guid(e.target),this._containerId=e.target,this._options=e,this._comments=[],this._popcorn=null,b(this),this.duration=0,this.volume=1,this.currentTime=0,this.ended=0,this.paused=1,this.readyState=0,this.playbackRate=1,this.top=0,this.left=0,this.autoplay=null,this.played=0,this.addEventListener("load",function(){var a=this.getBoundingClientRect();this.top=a.top,this.left=a.left,this.offsetWidth=this.swfObj.offsetWidth,this.offsetHeight=this.swfObj.offsetHeight,this.offsetLeft=this.swfObj.offsetLeft,this.offsetTop=this.swfObj.offsetTop}),h[this._playerId]=this,l(this)};return c}(),a.soundcloud.init.prototype=a.soundcloud.prototype,a.extend(a.soundcloud.prototype,{setVolume:function(a){if(!a&&a!==0)return;a<0&&(a=-a),a>1&&(a%=1),this.volume=this.previousVolume=a,this.swfObj.api_setVolume(a*100),this.dispatchEvent("volumechange")},setCurrentTime:function(a){if(!a&&a!==0)return;this.currentTime=this.previousCurrentTime=a,this.ended=a>=this.duration,this.dispatchEvent("seeked")},play:function(){if(!this.swfObj){this.addEventListener("load",this.play);return}if(!this.paused)return;this.paused=0,this.swfObj.api_play()},pause:function(){if(!this.swfObj){this.addEventListener("load",this.pause);return}if(this.paused)return;this.paused=1,this.swfObj.api_pause()},mute:function(){if(!this.swfObj){this.addEventListener("load",this.mute);return}this.muted()?this.paused?this.setVolume(this.oldVol):this.volume=this.oldVol:(this.oldVol=this.volume,this.paused?this.setVolume(0):this.volume=0)},muted:function(){return this.volume===0},load:function(){if(!this.swfObj){this.addEventListener("load",this.load);return}this.play(),this.pause()},addEventListener:function(a,b){return this._listeners[a]||(this._listeners[a]=[]),this._listeners[a].push(b),b},dispatchEvent:function(b){var c=this,d=b.type||b;if(d==="play"&&this.paused||d==="pause"&&!this.paused){this[d]();return}a.forEach(this._listeners[d],function(a){a.call(c)})},timeupdate:function(){var a=this,b=this.swfObj.api_getVolume()/100,f=0;e(this.currentTime-this.previousCurrentTime)>d?(this.swfObj.api_seekTo(this.currentTime),f=1):this.previousCurrentTime=this.currentTime=this.swfObj.api_getTrackPosition(),b!==this.previousVolume?this.setVolume(b):this.volume!==this.previousVolume&&this.setVolume(this.volume),this.paused||this.dispatchEvent("timeupdate"),a.ended||setTimeout(function(){a.timeupdate.call(a)},c)},getBoundingClientRect:function(){var a,b=this;return this.swfObj?(a=this.swfObj.getBoundingClientRect(),{bottom:a.bottom,left:a.left,right:a.right,top:a.top,width:a.width||a.right-a.left,height:a.height||a.bottom-a.top}):(tmp=this._container.getBoundingClientRect(),{left:tmp.left,top:tmp.top,width:b.offsetWidth,height:b.offsetHeight,bottom:tmp.top+this.width,right:tmp.top+this.height})},registerPopcornWithPlayer:function(b){if(!this.swfObj){this.addEventListener("load",function(){this.registerPopcornWithPlayer(b)});return}this._popcorn=b;var c=this._options.api;if(c.key&&c.commentdiv){var d=this;a.xhr({url:"http://api.soundcloud.com/tracks/"+d._mediaId+"/comments.js?consumer_key="+c.key,success:function(b){a.forEach(b.json,function(a){d.addComment({start:a.timestamp/1e3,date:new Date(a.created_at),text:a.body,user:{name:a.user.username,profile:a.user.permalink_url,avatar:a.user.avatar_url}})})}})}}}),a.extend(a.soundcloud.prototype,{addComment:function(a,b){var c=this,d={start:a.start||0,date:a.date||new Date,text:a.text||"",user:{name:a.user.name||"",profile:a.user.profile||"",avatar:a.user.avatar||""},display:function(){return(b||c._options.api.commentformat)(d)}};this._comments.push(d);if(!this._popcorn)return;this._popcorn.subtitle({start:d.start,target:this._options.api.commentdiv,display:"inline",language:"en",text:d.display()})}})}(Popcorn,window),function(){vimeo_player_loaded=function(a){vimeo_player_loaded[a]&&vimeo_player_loaded[a]()},vimeo_player_loaded.seek={},vimeo_player_loaded.loadProgress={},vimeo_player_loaded.play={},vimeo_player_loaded.pause={},Popcorn.player("vimeo",{_setup:function(a){var b=this,c,d=document.createElement("div"),e=0,f=0,g=!1,h=!1,i=!1,j=0,k,l;d.id=b.id+Popcorn.guid(),b.appendChild(d),l=b.style.width?""+b.offsetWidth:"100%",k=b.style.height?""+b.offsetHeight:"100%";var m=function(){function r(a){if(!a)return;var b=/^http:\/\/player\.vimeo\.com\/video\/[\d]+/i,c=/vimeo\.com\/[\d]+/,d=a.match(b)?a.match(b)[0].substr(30):"";return d?d:a.match(c)?a.match(c)[0].substr(10):""}var h,m,n={},o=b.src,p=0,q=!1;vimeo_player_loaded[d.id]=function(){c=document.getElementById(d.id),vimeo_player_loaded.seek[d.id]=function(a){a!==e&&(e=a,b.dispatchEvent("seeked"),b.dispatchEvent("timeupdate"))},vimeo_player_loaded.play[d.id]=function(){b.paused&&(b.paused=!1,b.dispatchEvent("play"),b.dispatchEvent("playing"),a())},vimeo_player_loaded.pause[d.id]=function(){b.paused||(b.paused=!0,b.dispatchEvent("pause"))},vimeo_player_loaded.loadProgress[d.id]=function(a){q||(q=!0,b.dispatchEvent("loadstart")),a.percent===100&&b.dispatchEvent("canplaythrough")},c.api_addEventListener("seek","vimeo_player_loaded.seek."+d.id),c.api_addEventListener("loadProgress","vimeo_player_loaded.loadProgress."+d.id),c.api_addEventListener("play","vimeo_player_loaded.play."+d.id),c.api_addEventListener("pause","vimeo_player_loaded.pause."+d.id);var a=function(){b.paused||(e=c.api_getCurrentTime(),b.dispatchEvent("timeupdate"),setTimeout(a,10))},h=function(){return c.api_getVolume()===0},k=function(){var a=h(),d=c.api_getVolume();i!==a&&(i=a,b.dispatchEvent("volumechange")),j!==d&&(j=d,b.dispatchEvent("volumechange")),setTimeout(k,250)};b.play=function(){b.paused=!1,b.dispatchEvent("play"),b.dispatchEvent("playing"),a(),c.api_play()},b.pause=function(){b.paused||(b.paused=!0,b.dispatchEvent("pause"),c.api_pause())},Popcorn.player.defineProperty(b,"currentTime",{set:function(a){return a?(e=f=+a,g=!0,b.dispatchEvent("seeked"),b.dispatchEvent("timeupdate"),c.api_seekTo(e),e):e},get:function(){return e}}),Popcorn.player.defineProperty(b,"muted",{set:function(a){h()!==a&&(a?(p=c.api_getVolume(),c.api_setVolume(0)):c.api_setVolume(p))},get:function(){return h()}}),Popcorn.player.defineProperty(b,"volume",{set:function(a){return!a||typeof a!="number"||a<0||a>1?c.api_getVolume()/100:(c.api_getVolume()!==a&&(c.api_setVolume(a*100),j=c.api_getVolume(),b.dispatchEvent("volumechange")),c.api_getVolume()/100)},get:function(){return c.api_getVolume()/100}}),b.readyState=4,b.dispatchEvent("canplaythrough"),b.dispatchEvent("load"),b.duration=c.api_getDuration(),b.dispatchEvent("durationchange"),k(),b.dispatchEvent("loadeddata")};if(!(o=r(o)))throw"Invalid Video Id";h={clip_id:o,js_api:1,js_swf_id:d.id},Popcorn.extend(h,a),m={allowscriptaccess:"always",allowfullscreen:"true",wmode:"transparent"},swfobject.embedSWF("//vimeo.com/moogaloop.swf",d.id,l,k,"9.0.0","expressInstall.swf",h,m,n)};window.swfobject?m():Popcorn.getScript("//ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js",m)}})}(),onYouTubePlayerReady=function(a){console.log(a),onYouTubePlayerReady[a]&&onYouTubePlayerReady[a]()},stateChangeEventHandler=new Array,onErrorEventHandler=new Array,Popcorn.player("youtube",{_setup:function(a){var b=this,c,d=document.createElement("div"),e=0,f=0,g=!1,h=!1,i=!1,j=!1,k=0;d.id=b.id+Popcorn.guid(),youtubeId=Popcorn.guid(),b.youtubeId=Popcorn.guid(),b.appendChild(d),b.canPlay=0;var l=function(){var c,i,l,m,n,o,p;canPlay=0,onYouTubePlayerReady[d.id]=function(){b.youtubeObject=document.getElementById(d.id),stateChangeEventHandler[b.youtubeId]=function(c){if(c===1&&b.canPlay==0)b.canPlay=1,b.pause(),b.readyState=4,b.duration=b.youtubeObject.getDuration(),b.dispatchEvent("canplaythrough"),b.dispatchEvent("load"),b.dispatchEvent("durationchange"),b.dispatchEvent("loadeddata");else if(c===1)b.paused&&b.play();else if(c===2){if(g&&f===e&&Math.abs(parseFloat(f)-parseFloat(b.youtubeObject.getCurrentTime()))>2){b.youtubeObject.seekTo(e);return}if(g&&f===e&&Math.abs(parseFloat(f)-parseFloat(b.youtubeObject.getCurrentTime()))<2){g=!1,h=!0,e=b.youtubeObject.getCurrentTime(),b.dispatchEvent("timeupdate"),!b.paused&&b.pause();return}if(h){h=!1;return}e=b.youtubeObject.getCurrentTime(),b.dispatchEvent("timeupdate"),!b.paused&&b.pause(),console.log("setting the volume"),console.log(a.volume),b.youtubeObject.setVolume(a.volume)}},stateChangeEventHandler[Popcorn.guid()]=function(a){[2,100,101,150].indexOf(a)!==-1&&b.dispatchEvent("error")},b.youtubeObject.addEventListener("onStateChange","stateChangeEventHandler["+b.youtubeId+"]"),b.youtubeObject.addEventListener("onError","onErrorEventHandler["+b.youtubeId+"]");var c=function(){b.paused||(e=b.youtubeObject.getCurrentTime(),b.dispatchEvent("timeupdate"),setTimeout(c,10))},i=function(){b&&b.youtubeObject&&b.youtubeObject.isMuted()&&(j!==b.youtubeObject.isMuted()&&(j=b.youtubeObject.isMuted(),b.dispatchEvent("volumechange")),k!==b.youtubeObject.getVolume()&&(k=b.youtubeObject.getVolume(),b.dispatchEvent("volumechange")),setTimeout(i,250))};b.play=function(){b.paused=!1,b.dispatchEvent("play"),b.dispatchEvent("playing"),c(),b.youtubeObject.playVideo()},b.pause=function(){b.paused||(b.paused=!0,b.dispatchEvent("pause"),b.youtubeObject.pauseVideo())},Popcorn.player.defineProperty(b,"currentTime",{set:function(c){return c!=0||a.cue_in==0?(e=f=+c,g=!0,b.dispatchEvent("seeked"),b.dispatchEvent("timeupdate"),b.youtubeObject.seekTo(e)):c==0&&a.cue_in==0&&b.dispatchEvent("timeupdate"),e},get:function(){return e}}),Popcorn.player.defineProperty(b,"muted",{set:function(a){return b.youtubeObject.isMuted()!==a&&(a?b.youtubeObject.mute():b.youtubeObject.unMute(),j=b.youtubeObject.isMuted(),b.dispatchEvent("volumechange")),b.youtubeObject.isMuted()},get:function(){return b.youtubeObject.isMuted()}}),Popcorn.player.defineProperty(b,"volume",{set:function(a){return console.log(b.youtubeObject.getVolume()),console.log(a),b.youtubeObject.getVolume()/100!==a&&(b.youtubeObject.setVolume(a*100),console.log(a*100),k=b.youtubeObject.getVolume(),b.dispatchEvent("volumechange")),b.youtubeObject.getVolume()/100},get:function(){return b.youtubeObject.getVolume()/100}}),b.youtubeObject.loadVideoById(m,a.cue_in)},a.controls=+a.controls===0||+a.controls===1?a.controls:1,a.annotations=+a.annotations===1||+a.annotations===3?a.annotations:1,a.cue_in=a.cue_in||0,a.volume=a.volume||1,c={playerapiid:d.id},i={wmode:"opaque",disablekb:"1",allowScriptAccess:"always"},l={id:d.id},m=/^.*(?:\/|v=)(.{11})/.exec(b.src)[1],p=(b.src.split("?")[1]||"").replace(/v=.{11}/,""),n=b.style.width?""+b.offsetWidth:"560",o=b.style.height?""+b.offsetHeight:"315",console.log(youtubeId),swfobject.embedSWF("http://www.youtube.com/apiplayer?enablejsapi=1&version=3&key=AI39si7oX_eCGjrxs2lil28MMQdXn-ZWhzku8fGsRVhju-pziYgmI3EOt0o4GmEl00vGXsA_OGGEKwX-xAM0a5Gbsr8zgrGpyg&playerapiid="+d.id,d.id,"100%","100%","8",null,c,i,l),console.log(d.id)};window.swfobject?l():Popcorn.getScript("//ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js",l)}});var onPlayerLoaded=function(a){onPlayerLoaded[a]&&onPlayerLoaded[a]()},onLoading=function(a,b){onLoading[a]&&onLoading[a](b)},onStateChange=function(a,b,c){onStateChange[a]&&onStateChange[a](b,c)},onError=function(a,b){onError[a]&&onError[a](b)};Popcorn.player("flashvideo",{_setup:function(a){var b=this,c,d=document.createElement("div"),e=0,f=0,g=!1,h=!1,i=!1,j=100;d.id=b.id+Popcorn.guid(),b.appendChild(d);var k=function(){var a,h,i,j,k,l,m;onPlayerLoaded[d.id]=function(){console.log("player "+d.id+" has loaded"),c=document.getElementById(d.id),onLoading[d.id]=function(a){if(a==2)b.duration=c.sendToFlash("getEndTime","");else if(a==3){var d=function(){b.paused||(e=c.sendToFlash("getCurrentTime",""),b.dispatchEvent("timeupdate"),setTimeout(d,10))};d(),b.play=function(){b.paused=!1,b.dispatchEvent("play"),b.dispatchEvent("playing"),d(),c.sendToFlash("play","")},b.pause=function(){b.paused||(b.paused=!0,b.dispatchEvent("pause"),c.sendToFlash("pause",""))},Popcorn.player.defineProperty(b,"currentTime",{set:function(a){return e=f=+a,g=!0,b.dispatchEvent("seeked"),b.dispatchEvent("timeupdate"),c.sendToFlash("seek",e),e},get:function(){return e}}),b.readyState=4,b.dispatchEvent("canplaythrough"),b.dispatchEvent("load"),b.duration=c.sendToFlash("getEndTime",""),b.dispatchEvent("durationchange"),b.dispatchEvent("loadeddata")}},onError[d.id]=function(a,b){switch(b){case 1:console.log("onError - failed to load file");break;case 2:console.log("onError - wrong url or invalid file")}};var a="onLoading."+d.id;console.log("player "+d.id+" has loaded"),c.sendToFlash("load",j+",0")},a={vidId:d.id},h={wmode:"transparent",allowScriptAccess:"always",allownetworking:"all",bgcolor:"#000000"},i={id:d.id},j=/(http.*)/.exec(b.src)[1],swfobject.embedSWF("MediaPlayer.swf",d.id,"100%","100%","9.0.0",!1,a,h,i)};window.swfobject?k():Popcorn.getScript("//ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js",k)}}),function(a){var b=function(b,c){var d=0,e=0,f;a.forEach(c.classes,function(a,b){f=[],a==="parent"?f[0]=document.querySelectorAll("#"+c.target)[0].parentNode:f=document.querySelectorAll("#"+c.target+" "+a);for(d=0,e=f.length;d<e;d++)f[d].classList.toggle(b)})};a.compose("applyclass",{manifest:{about:{name:"Popcorn applyclass Effect",version:"0.1",author:"@scottdowne",website:"scottdowne.wordpress.com"},options:{}},_setup:function(a){a.classes={},a.applyclass=a.applyclass||"";var b=a.applyclass.replace(/\s/g,"").split(","),c=[],d=0,e=b.length;for(;d<e;d++)c=b[d].split(":"),c[0]&&(a.classes[c[0]]=c[1]||"")},start:b,end:b})}(Popcorn),define("web/js/lib/popcorn_flash",function(){}),function(a){a.Views.Controls=Backbone.View.extend({tagName:"li",className:"editor-layer",initialize:function(){this.initListeners(),this.attr=this.model.get("attr"),_.extend(this.events,this.eventTriggers),this.setBaseTemplate(),this.controls=this.$el.find("#controls"),this.$el.attr("id","layer-"+this.model.id),this.$el.attr("data-id",this.model.id),this.init()},drawDefaultControls:function(){$(this.el).find(".default-layer-controls").empty();var b=zeega.app.currentSequence.get("attr")?zeega.app.currentSequence.get("attr").persistLayers:{},c=_.include(b,parseInt(this.model.id)),d=new a.Views.Lib.ContinueLayer({model:this.model});$(this.el).find(".default-layer-controls").append(d.getControl());if(this.model.get("attr").linkable){var e=new a.Views.Lib.Link({model:this.model});$(this.el).find(".default-layer-controls").append(e.getControl())}},initListeners:function(){this.model.on("update",this.updateViewInPlace,this),this.model.player?(this.model.on("player_preload",this.private_onPreload,this),this.model.on("player_play",this.private_onPlay,this),this.model.on("player_exit",this.private_onExit,this),this.model.on("player_unrender",this.private_onUnrender,this)):(this.model.on("editor_layerEnter",this.private_onLayerEnter,this),this.model.on("editor_layerExit",this.private_onLayerExit,this),this.model.on("editor_controlsOpen",this.private_onControlsOpen,this),this.model.on("editor_controlsClosed",this.private_onControlsClosed,this),this.model.on("editor_removeLayerFromFrame",this.private_onRemoveLayerFromFrame,this))},init:function(){},onLayerEnter:function(){},onLayerExit:function(){},onControlsOpen:function(){},onControlsClosed:function(){},onPreload:function(){},onPlay:function(){},onExit:function(){},onUnrender:function(){},private_onLayerEnter:function(){console.log("	LAYER LIST enter"),this.model.defaultControls&&this.drawDefaultControls(),this.delegateEvents(),this.onLayerEnter()},private_onLayerExit:function(){console.log("	LAYER LIST EXIT"),this.undelegateEvents(),this.$el.find("#controls").empty(),this.onLayerExit()},private_onRemoveLayerFromFrame:function(){this.remove()},private_onControlsOpen:function(){this.onControlsOpen()},private_onControlsClosed:function(){this.onControlsClosed()},private_onPreload:function(){this.onPreload(),this.moveOffStage()},private_onPlay:function(){this.moveOnStage(),this.onPlay()},private_onExit:function(){this.moveOffStage(),this.onExit()},private_onUnrender:function(){this.remove(),this.onUnrender()},moveOnStage:function(){$(this.el).css({top:this.attr.top+"%",left:this.attr.left+"%"})},moveOffStage:function(){$(this.el).css({top:"-1000%",left:"-1000%"})},updateViewInPlace:function(){console.log("re render"),$(this.el).attr("data-id",this.model.id),$(this.el).find(".layer-title").html(this.model.get("attr").title)},events:{"click .delete-layer":"delete","click .layer-title":"expand","click .layer-icon":"hideShow","mouseenter .layer-icon":"onLayerIconEnter","mouseleave .layer-icon":"onLayerIconLeave","mouseenter .delete-layer":"onLayerTrashEnter","mouseleave .delete-layer":"onLayerTrashLeave"},eventTriggers:{},"delete":function(){confirm("Delete Layer?")&&(this.model.trigger("editor_removeLayerFromFrame",this.model),this.remove())},expand:function(){var a=this;return $(this.el).find(".layer-content").is(":hidden")?($(this.el).find(".layer-content").show("blind",{direction:"vertical"},function(){a.model.trigger("editor_controlsOpen"),$(this).removeClass("closed")}),this.visible=!0):($(this.el).find(".layer-content").hide("blind",{direction:"vertical"},function(){$(this).addClass("closed"),a.model.trigger("editor_controlsClosed")}),this.visible=!1),!1},hideShow:function(){var a=!this.model.get("visibleineditor");this.model.set({visibleineditor:a}),a?$(this.el).find(".asset-type-icon").addClass("orange"):$(this.el).find(".asset-type-icon").removeClass("orange")},onLayerIconEnter:function(){$(this.el).find(".asset-type-icon").addClass("zicon-visible")},onLayerIconLeave:function(){$(this.el).find(".asset-type-icon").removeClass("zicon-visible")},onLayerTrashEnter:function(){$(this.el).find(".delete-layer").addClass("orange zicon-trash-open")},onLayerTrashLeave:function(){$(this.el).find(".delete-layer").removeClass("orange zicon-trash-open")},setBaseTemplate:function(){var a=this.model.get("attr").title,b="",c="";if(_.isUndefined(this.model.get("attr").link_to)||this.model.get("attr").link_to=="")c="hidden";var d=c==""?this.model.get("attr").link_to:"",e={id:"layer-edit-"+this.model.id,type:this.model.get("type").toLowerCase(),layerName:a,persist:b,show_link:c,link_to:d};$(this.el).append(_.template(this.getBaseTemplate(),e))},getBaseTemplate:function(){var a='<div class="layer-uber-bar clearfix"><div class="layer-icon"><i class="zicon-<%= type %> orange"></i></div><div class="layer-title"><%= layerName %></div><div class="layer-uber-controls"><i class="zicon-trash-closed delete-layer"></i></div><div class="layer-drag-handle"><span class="zicon zicon-vert-drag"></span></div></div><div class="layer-content inset-tray dark tray closed"><div id="controls" class="clearfix"></div><div class="default-layer-controls clearfix"></div></div>';return a}})}(zeega.module("layer")),define("web/js/app/views/editor.layer/editor.view.layer.layer-list",function(){}),function(a){a.Views.Visual=Backbone.View.extend({className:"visual-element",layerClassName:"",draggable:!0,linkable:!0,initialize:function(){var a=this;_.extend(this.events,this.eventTriggers),this.initListeners(),this.attr=this.model.get("attr"),$(this.el).css({position:"absolute",overflow:"hidden",width:a.model.get("attr").width+"%",opacity:a.model.get("attr").opacity,top:this.model.player?"-1000%":a.model.get("attr").top+"%",left:this.model.player?"-1000%":a.model.get("attr").left+"%"}).addClass("layer-"+this.model.layerType.toLowerCase()).attr("id","layer-visual-"+this.model.id),$(this.el).addClass(this.layerClassName),this.init()},initListeners:function(){this.model.player?(this.model.on("player_preload",this.private_onPreload,this),this.model.on("player_play",this.private_onPlay,this),this.model.on("player_exit",this.private_onExit,this),this.model.on("player_unrender",this.private_onUnrender,this)):(this.model.on("editor_layerEnter",this.private_onLayerEnter,this),this.model.on("editor_layerExit editor_removeLayerFromFrame",this.private_onLayerExit,this),this.model.on("editor_controlsOpen",this.private_onControlsOpen,this),this.model.on("editor_controlsClosed",this.private_onControlsClosed,this))},events:{},eventTriggers:{},init:function(){},onLayerEnter:function(){},onLayerExit:function(){this.model.trigger("editor_readyToRemove")},onControlsOpen:function(){},onControlsClosed:function(){},onPreload:function(){var a=this;this.render(),this.attr.link&&$(this.el).click(function(){window.location="http://"+a.attr.link}).addClass("linked-layer"),this.model.trigger("ready",this.model.id)},onPlay:function(){},onExit:function(){},onUnrender:function(){},private_onLayerEnter:function(){this.draggable&&this.makeDraggable(),this.onLayerEnter()},private_onLayerExit:function(){this.model.on("editor_readyToRemove",this.remove,this),this.onLayerExit()},private_onControlsOpen:function(){this.onControlsOpen()},private_onControlsClosed:function(){this.onControlsClosed()},makeDraggable:function(){var a=this;$(this.el).draggable({start:function(a,b){},stop:function(b,c){var d=c.position.top/$(this).parent().height()*100,e=c.position.left/$(this).parent().width()*100;a.model.update({top:d,left:e})}})},private_onPreload:function(){this.render(),this.onPreload(),this.model.rendered=!0},private_onPlay:function(a){this.moveOnStage(),a&&this.updateZIndex(a),this.onPlay(),this.model.inFocus=!0;if(this.attr.link||this.model.get("type")=="Link"){var b=this;setTimeout(function(){$(b.el).addClass("link-blink")},250),setTimeout(function(){$(b.el).removeClass("link-blink")},2e3)}},private_onExit:function(){this.moveOffStage(),this.onExit(),this.model.inFocus=!1},private_onUnrender:function(){this.onUnrender(),this.model.inFocus=!1,this.model.rendered=!1,this.remove()},moveOnStage:function(){$(this.el).css({top:this.attr.top+"%",left:this.attr.left+"%"})},updateZIndex:function(a){$(this.el).css("z-index",a)},moveOffStage:function(){$(this.el).css({top:"-1000%",left:"-1000%"})}})}(zeega.module("layer")),define("web/js/app/views/editor.layer/editor.view.layer.visual-editor",function(){}),function(a){a.Model=Backbone.Model.extend({showControls:!0,player:!1,displayCitation:!0,visualLoaded:!1,defaultControls:!0,editorWindow:$("#visual-editor-workspace"),layerPanel:$("#layers-list-visual"),layerColor:["red","blue","yellow","green"],defaults:{attr:{},linkable:!0,thumbUpdate:!0},defaultAttributes:{},url:function(){return this.isNew()?zeega.app.url_prefix+"api/projects/"+zeega.app.project.id+"/layers":zeega.app.url_prefix+"layers/"+this.id},initialize:function(b,c){this.on("ready",function(){this.visualLoaded=!0}),this.on("refresh_view",this.refreshView,this),this.on("editor_layerRender",this.renderLayerInEditor,this),this.on("editor_destroyLayer editor_layerUnrender",this.unrenderLayerFromEditor,this),this.on("editor_controlsOpen",this.onControlsOpen,this),this.on("editor_controlsClosed",this.onControlsClosed,this),this.on("editor_destroyLayer",this.unrenderLayerFromEditor,this),c&&_.extend(this,c),_.isNull(this.layerType)?console.log("MISSING LAYER TYPE"):(this.set("type",this.layerType),this.set("attr",_.defaults(this.get("attr"),this.defaultAttributes)),this.visual=new a.Views.Visual[this.layerType]({model:this}),this.player||(this.controls=new a.Views.Controls[this.layerType]({model:this})),this.init())},generateNewViews:function(){_.isNull(this.layerType)||(this.visual=new a.Views.Visual[this.layerType]({model:this}),this.player||(this.controls=new a.Views.Controls[this.layerType]({model:this})))},init:function(){},onControlsOpen:function(){},onControlsClosed:function(){},renderLayerInEditor:function(a){this.visual.render().$el.css("zIndex",a+1),this.isNew()?(this.visual.render().$el.css("zIndex",1e3),this.editorWindow.append(this.visual.el)):this.editorWindow.append(this.visual.render().el),this.controls&&this.layerPanel.prepend(this.controls.render().el),this.trigger("editor_rendered editor_layerEnter")},unrenderLayerFromEditor:function(){this.hasChanged()&&this.save(),this.trigger("editor_layerExit")},refreshView:function(){console.log("	refresh view"),this.visual.$el.attr("id","layer-visual-"+this.id),this.controls&&this.controls.$el.attr("id","layer-"+this.id)},update:function(a,b){var c=this;_.extend(this.get("attr"),a),b||this.save({},{success:function(){c.trigger("update")}})},thumb:function(){var a=$("<img>").attr("src",this.attr.thumbnail_url).css({width:"100%"});this.thumbnail.append(a)},preload:function(){$("#zeega-player").trigger("ready",{id:this.id})},stash:function(){},playUnsupported:function(){},onExit:function(){},setIcon:function(){this.icon=!0},setZIndex:function(a){this.visualEditorElement.css("z-index",a)},onStateChange:function(){},onError:function(){},validate:function(a){a.title&&(a.title=a.title.replace(/(<([^>]+)>)/ig,""))}})}(zeega.module("layer")),define("web/js/app/models/editor.model.layer",function(){}),function(a){a.Video=a.Model.extend({layerType:"Video",defaultAttributes:{title:"Video Layer",url:"none",left:0,top:0,height:100,width:100,volume:.5,cue_in:0,cue_out:0,opacity:1,dimension:1.5,citation:!0},init:function(){console.log(this.get("attr")),console.log(this),this.video=new Plyr2({url:this.get("attr").attribution_uri,uri:this.get("attr").uri,id:this.id,cue_in:this.get("attr").cue_in,cue_out:this.get("attr").cue_out,volume:this.get("attr").volume})}}),a.Views.Controls.Video=a.Views.Controls.extend({render:function(){var b=new a.Views.Lib.Playback({model:this.model}),c=new a.Views.Lib.Slider({property:"volume",model:this.model,label:"Volume",min:0,max:1,step:.01,css:!1}),d=new a.Views.Lib.Slider({property:"width",model:this.model,label:"Width",suffix:"%",min:1,max:200}),e=new a.Views.Lib.Slider({property:"height",model:this.model,label:"Height",suffix:"%",min:1,max:200}),f=new a.Views.Lib.Slider({property:"opacity",model:this.model,label:"Opacity",step:.01,min:.05,max:1});return this.controls.append(b.getControl()).append(c.getControl()).append(d.getControl()).append(e.getControl()).append(f.getControl()),this}}),a.Views.Visual.Video=a.Views.Visual.extend({draggable:!0,linkable:!0,render:function(){var a=$("<img>").attr("id","video-player-"+this.model.id).attr("src",this.attr.thumbnail_url).css({width:"100%"});return $(this.el).html(a).css("height",this.attr.height+"%"),this},onLayerEnter:function(){this.model.controls.visible==1&&(this.$el.find("img").remove(),this.model.video.placeVideo(this.$el),this.model.loaded=!0)},onLayerExit:function(){this.model.video.isVideoLoaded&&this.model.video.destroy(),this.model.loaded=!1,this.model.trigger("editor_readyToRemove")},onControlsOpen:function(){console.log("video controls open : visual");var a=this;this.model.loaded?this.model.video.pop.pause():(this.model.video.on("video_canPlay",function(){a.model.trigger("video_ready",a.model.id)},this),this.model.video.placeVideo(this.$el),this.model.loaded=!0)},onControlsClosed:function(){this.model.video.pop.pause()},onPreload:function(){this.model.video.on("timeupdate",function(){Math.abs(a.model.video.pop.volume()-a.model.get("attr").volume)>.01&&a.model.video.pop.volume(a.model.get("attr").volume),a.model.get("attr").cue_out!=0&&a.model.video.pop.currentTime()>a.model.get("attr").cue_out&&(a.model.video.pop.currentTime(a.model.get("attr").cue_in),a.model.video.pop.pause(),a.model.trigger("playback_ended"),console.log("playback ended"))},this);var a=this;this.model.loaded?this.model.video.pop.pause():(this.model.video.placeVideo(this.$el),this.model.video.on("video_canPlay",function(){console.log("video ready player"),a.model.trigger("ready",a.model.id)},this),this.model.loaded=!0)},onPlay:function(){this.model.video.play()},onExit:function(){this.model.video.pause()},onUnrender:function(){this.model.video.pause()}}),a.Youtube=a.Video.extend(),a.Views.Controls.Youtube=a.Views.Controls.Video.extend(),a.Views.Visual.Youtube=a.Views.Visual.Video.extend(),a.Vimeo=a.Video.extend(),a.Views.Controls.Vimeo=a.Views.Controls.Video.extend(),a.Views.Visual.Vimeo=a.Views.Visual.Video.extend()}(zeega.module("layer")),define("web/js/plugins/layers/video/video",function(){}),function(a){a.Audio=a.Video.extend({layerType:"Audio",defaultAttributes:{title:"Audio Layer",url:"none",left:0,top:0,height:100,width:100,volume:.5,cue_in:0,cue_out:0,opacity:1,dimension:1.5,citation:!0}}),a.Views.Controls.Audio=a.Views.Controls.Video.extend({render:function(){var b=new a.Views.Lib.Playback({model:this.model}),c=new a.Views.Lib.Slider({property:"volume",model:this.model,label:"Volume",min:0,max:1,step:.01,css:!1});return this.controls.append(b.getControl()).append(c.getControl()),this}}),a.Views.Visual.Audio=a.Views.Visual.Video.extend({draggable:!1,linkable:!1,render:function(){return this}})}(zeega.module("layer")),define("web/js/plugins/layers/audio/audio",function(){}),function(a){a.Geo=a.Model.extend({layerType:"Geo",defaultAttributes:{title:"Streetview Layer",height:100,width:100,lat:42.3735626,lng:-71.1189639,zoom:10,streetZoom:1,heading:0,pitch:0,mapType:"satellite",url:"",left:0,top:0,height:100,width:100,opacity:1,aspect:1.33,citation:!0,linkable:!0}}),a.Views.Controls.Geo=a.Views.Controls.extend({render:function(){var b=new a.Views.Lib.Slider({property:"width",model:this.model,label:"Width",suffix:"%",min:1,max:200}),c=new a.Views.Lib.Slider({property:"height",model:this.model,label:"Height",suffix:"%",min:1,max:200}),d=new a.Views.Lib.Slider({property:"left",model:this.model,label:"Horizontal Position",suffix:"%",min:0,max:100}),e=new a.Views.Lib.Slider({property:"top",model:this.model,label:"Vertical Position",suffix:"%",min:0,max:100}),f=new a.Views.Lib.Slider({property:"opacity",model:this.model,label:"Opacity",step:.01,min:.05,max:1}),g=new a.Views.Lib.GoogleMaps({model:this.model});return $(this.controls).append(g.getControl()).append(b.getControl()).append(c.getControl()).append(d.getControl()).append(e.getControl()).append(f.getControl()),this}}),a.Views.Visual.Geo=a.Views.Visual.extend({draggable:!1,linkable:!0,init:function(){console.log("	GEO INIT");var a=this;this.model.on("update",this.updateVisual,this)},render:function(){var a=$('<div class="gmap-container">').css({width:"100%",height:"100%"});return $(this.el).html(a).css({height:this.attr.height+"%"}),this},updateVisual:function(){console.log("	update visual"),console.log(this);var a=new google.maps.LatLng(this.model.get("attr").lat,this.model.get("attr").lng),b={heading:this.model.get("attr").heading,pitch:this.model.get("attr").pitch,zoom:this.model.get("attr").streetZoom};this.streetview.setPosition(a),this.streetview.setPov(b)},onLayerEnter:function(){if(!this.isLoaded){console.log("geo layer enter");var a=new google.maps.LatLng(this.model.get("attr").lat,this.model.get("attr").lng),b={addressControl:!1,addressControlOptions:!1,clickToGo:!0,disableDoubleClickZoom:!1,enableCloseButton:!1,imageDateControl:!1,linksControl:!1,panControl:!0,panControlOptions:!0,position:a,visible:!0,zoomControl:!0,zoomControlOptions:!0,pov:{heading:this.model.get("attr").heading,pitch:this.model.get("attr").pitch,zoom:this.model.get("attr").streetZoom}};this.streetview=new google.maps.StreetViewPanorama($(this.el).find(".gmap-container")[0],b),this.initMapListeners(),this.isLoaded=!0}},initMapListeners:function(){var a=this;google.maps.event.addListener(this.streetview,"position_changed",function(){b()}),google.maps.event.addListener(this.streetview,"pov_changed",function(){b()});var b=_.debounce(function(){var b=a.model.get("attr");(b.heading!=a.streetview.getPov().heading||b.pitch!=a.streetview.getPov().pitch||b.streetZoom!=a.streetview.getPov().zoom||Math.floor(b.lat*1e3)!=Math.floor(a.streetview.getPosition().lat()*1e3)||Math.floor(b.lng*1e3)!=Math.floor(a.streetview.getPosition().lng()*1e3))&&a.model.update({heading:a.streetview.getPov().heading,pitch:a.streetview.getPov().pitch,streetZoom:Math.floor(a.streetview.getPov().zoom),lat:a.streetview.getPosition().lat(),lng:a.streetview.getPosition().lng()})},1e3)},onLayerExit:function(){this.map={},$(this.el).find(".gmap-container").hide(),this.isLoaded=!1},onPreload:function(){if(!this.isLoaded){var a=new google.maps.LatLng(this.model.get("attr").lat,this.model.get("attr").lng),b={addressControl:!1,addressControlOptions:!1,clickToGo:!0,disableDoubleClickZoom:!1,enableCloseButton:!1,imageDateControl:!1,linksControl:!1,panControl:!0,panControlOptions:!0,position:a,visible:!0,zoomControl:!0,zoomControlOptions:!0,pov:{heading:this.model.get("attr").heading,pitch:this.model.get("attr").pitch,zoom:this.model.get("attr").streetZoom}};this.streetview={},this.streetview=new google.maps.StreetViewPanorama($(this.el).find(".gmap-container")[0],b),this.isLoaded=!0}this.model.trigger("ready",this.model.id)}})}(zeega.module("layer")),define("web/js/plugins/layers/geo/geo",function(){}),function(a){a.Image=a.Model.extend({layerType:"Image",defaultAttributes:{title:"Image Layer",url:"none",left:0,top:0,height:100,width:100,opacity:1,aspect:1.33,citation:!0,linkable:!0}}),a.Views.Controls.Image=a.Views.Controls.extend({render:function(){var b=new a.Views.Lib.Slider({property:"width",model:this.model,label:"Scale",suffix:"%",min:1,max:200}),c=new a.Views.Lib.Slider({property:"opacity",model:this.model,label:"Opacity",step:.01,min:.05,max:1});return $(this.controls).append(b.getControl()).append(c.getControl()),this}}),a.Views.Visual.Image=a.Views.Visual.extend({draggable:!0,render:function(){var a=$("<img>").attr("src",this.attr.uri).css({width:"100%"});return $(this.el).html(a),this}})}(zeega.module("layer")),define("web/js/plugins/layers/image/image",function(){}),function(a){a.Mapbox=a.Model.extend({layerType:"Mapbox",defaultAttributes:{title:"Mapbox Layer",left:0,top:0,height:100,width:100,opacity:1,aspect:1.33,citation:!0,media_geo_latitude:40.7774,media_geo_longitude:-73.9606,attributes:{zoom:12,maxzoom:18,minzoom:0},zoomControl:12,interaction:!1}}),a.Views.Controls.Mapbox=a.Views.Controls.extend({render:function(){var b=new a.Views.Lib.Slider({property:"width",model:this.model,label:"Width",suffix:"%",min:1,max:200}),c=new a.Views.Lib.Slider({property:"height",model:this.model,label:"Height",suffix:"%",min:1,max:200}),d=new a.Views.Lib.Slider({property:"opacity",model:this.model,label:"Opacity",step:.01,min:.05,max:1}),e=new a.Views.Lib.Slider({property:"left",model:this.model,label:"Left",suffix:"%",step:1,min:0,max:100}),f=new a.Views.Lib.Slider({property:"top",model:this.model,label:"Top",step:1,suffix:"%",min:0,max:100});return this.controls.append(b.render().el).append(c.render().el).append(f.render().el).append(e.render().el).append(d.render().el),this}}),a.Views.Visual.Mapbox=a.Views.Visual.extend({draggable:!1,linkable:!0,render:function(){return this.tileUrl="http://{s}.tiles.mapbox.com/v3/"+this.attr.uri+"/{z}/{x}/{y}.png",this.tileLayer=new L.TileLayer(this.tileUrl,{minZoom:this.attr.attributes.minzoom,maxZoom:this.attr.attributes.maxzoom,attribution:""}),this.latlng=new L.LatLng(parseFloat(this.attr.media_geo_latitude),parseFloat(this.attr.media_geo_longitude)),$(this.el).css({width:this.attr.width+"%",height:this.attr.height+"%"}),$(this.el).html($("<div>").css({width:"100%",height:"100%"}).addClass("cloud-map")),this},onLayerEnter:function(){var a=$(this.el).find(".cloud-map").get(0),b={minZoom:this.attr.attributes.minzoom,maxZoom:this.attr.attributes.maxzoom,scrollWheelZoom:!1,zoomControl:!1,doubleClickZoom:!1};console.log(b),console.log(this.attr),this.map=new L.Map(a,b),console.log(this.attr),this.map.setView(this.latlng,this.attr.attributes.zoom).addLayer(this.tileLayer);var c=this;this.map.on("zoomend",function(a){c.model.update({attributes:{zoom:a.target.getZoom()}}),c.attr.attributes.zoom=a.target.getZoom()}),this.map.on("dragend",function(a){c.model.update({media_geo_latitude:a.target.getCenter().lat,media_geo_longitude:a.target.getCenter().lng}),c.latlng=a.target.getCenter()}),this.zoomControl=new L.Control.Zoom,this.map.addControl(this.zoomControl)},onPreload:function(){console.log("oh yeah"),console.log(this.el),console.log("oh yeah");var a=$(this.el).find(".cloud-map").get(0);console.log(this.el),this.map=new L.Map(a,{minZoom:this.attr.attributes.minzoom,maxZoom:this.attr.attributes.maxzoom,scrollWheelZoom:!1,zoomControl:!1,doubleClickZoom:!1}),this.map.setView(this.latlng,this.attr.attributes.zoom).addLayer(this.tileLayer);var b=this;this.map.on("zoomend",function(a){b.model.update({zoom:a.target.getZoom()})}),this.map.on("dragend",function(a){b.model.update({media_geo_latitude:a.target.getCenter().lat,media_geo_longitude:a.target.getCenter().lng})}),this.zoomControl=new L.Control.Zoom,this.map.addControl(this.zoomControl),this.model.trigger("ready",this.model.id)}})}(zeega.module("layer")),define("web/js/plugins/layers/mapbox/mapbox",function(){}),function(a){a.Text=a.Model.extend({layerType:"Text",displayCitation:!1,linkable:!0,defaultAttributes:{title:"Text Layer",content:"Text",left:0,top:0,color:"#ffffff",opacity:.9,fontSize:200,overflow:"visible",width:25,linkable:!0},updateContentInPlace:function(){this.visual.updateContentInPlace()},preload:function(a){},play:function(a){},stash:function(){this.display.css({top:"-1000%",left:"-1000%"})}}),a.Views.Controls.Text=a.Views.Controls.extend({render:function(){var b=new a.Views.Lib.ColorPicker({property:"color",color:this.model.get("attr").color,model:this.model,label:"Text Color",opacity:!0}),c=new a.Views.Lib.Slider({property:"fontSize",model:this.model,label:"Font Size",suffix:"%",min:100,max:1e3}),d=new a.Views.Lib.TextStyles({model:this.model}),e=new a.Views.Lib.FontChooser({model:this.model});return this.controls.append(d.getControl()).append(e.getControl()).append(b.getControl()).append(c.getControl()),this}}),a.Views.Visual.Text=a.Views.Visual.extend({draggable:!0,render:function(){var a="",b="";if(_.isObject(this.model.get("attr").color)){var c=this.model.get("attr").color;a=rgbToHex(c.r,c.g,c.b)}else a=this.model.get("attr").color;if(_.isObject(this.model.get("attr").backgroundColor)){var c=this.model.get("attr").backgroundColor;b=rgbToHex(c.r,c.g,c.b)}else b=this.model.get("attr").backgroundColor;var d={color:"rgba("+a.toRGB()+","+(this.model.get("attr").colorOpacity||1)+")",opacity:this.model.get("attr").opacity,fontSize:this.model.get("attr").fontSize<100?"200%":this.model.get("attr").fontSize+"%",width:this.model.get("attr").width+"%",overflow:"visible","line-height":"100%"};return $(this.el).html(_.template(this.getTemplate(),_.extend(this.model.get("attr"),{contentEditable:!this.model.player}))).css(d),this.model.player||$(this.el).addClass("text-non-editing"),this.model.trigger("ready",this.model.id),this},onLayerEnter:function(){var a=this;this.$el.find("#zedit-target").keyup(function(b){b.which==27&&$(this).blur(),a.lazySave()}).bind("paste",function(b){console.log("content pasted in!"),a.lazySave()}),this.$el.click(function(){a.$el.find("#zedit-target").focus(),a.$el.draggable("option","disabled",!0),a.$el.addClass("text-editing").removeClass("text-non-editing")}).focusout(function(){a.$el.draggable("option","disabled",!1),a.$el.removeClass("text-editing").addClass("text-non-editing"),a.lazySave()}),$(this.el).resizable({stop:function(b,c){$(this).css("height",""),a.model.update({width:$(this).width()/$(this).parent().width()*100})}})},lazySave:_.debounce(function(){var a=this.$el.find("#zedit-target").html(),b=this.cleanString(a);this.model.update({content:a,title:b})},1e3),cleanString:function(a){return a.replace(/(<([^>]+)>)/ig,"")},updateContentInPlace:function(){$(this.el).find("#zedit-target").html(this.model.get("attr").content)},getTemplate:function(){var a='<div id="zedit-target" class="inner" contenteditable="<%= contentEditable %>" ><%= content %></div>';return a}})}(zeega.module("layer")),define("web/js/plugins/layers/text/text",function(){}),function(a){a.GoogleBook=a.Model.extend({layerType:"GoogleBook",defaultAttributes:{title:"GoogleBook Layer",url:"none",left:0,top:0,height:100,width:100,opacity:1,aspect:1.33,citation:!0}}),a.Views.Controls.GoogleBook=a.Views.Controls.extend({render:function(){var b=new a.Views.Lib.Slider({property:"width",model:this.model,label:"Scale",suffix:"%",min:1,max:200}),c=new a.Views.Lib.Slider({property:"opacity",model:this.model,label:"Opacity",step:.01,min:.05,max:1});return this.controls.append(b.getControl()).append(c.getControl()),this}}),a.Views.Visual.GoogleBook=a.Views.Visual.extend({draggable:!0,linkable:!0,render:function(){console.log(this);var a=$("<img>").attr("src",this.attr.thumbnail_url).css({width:"100%"});return $(this.el).html(a),this}})}(zeega.module("layer")),define("web/js/plugins/layers/googlebook/googlebook",function(){}),function(a){a.Link=a.Model.extend({layerType:"Link",layerPanel:$("#links-list"),defaultControls:!1,defaultAttributes:{title:"Link Layer",to_sequence:null,from_sequence:null,to_frame:null,from_frame:null,left:25,top:25,height:50,width:50},init:function(a){},setToFrame:function(a,b){this.get("attr").to_sequence=a,this.get("attr").to_frame=b,this.get("attr").title="Link to sequence "+a,this.save()}}),a.Views.Controls.Link=a.Views.Controls.extend({onLayerEnter:function(){var a=this.model.layerIndex||this.model.layerColor.length;$(this.el).find(".zicon-link").css({"background-color":this.model.layerColor[a%this.model.layerColor.length]}),this.model.get("attr").to_frame==zeega.app.currentFrame.id&&this.remove()},render:function(){return this}}),a.Views.Visual.Link=a.Views.Visual.extend({preview:!1,init:function(){this.preview=zeega.app.previewMode},render:function(){var a=this,b={height:this.model.get("attr").height+"%",cursor:"pointer","z-index":100};if(!zeega.app.previewMode){var c=this.model.layerIndex||this.model.layerColor.length;_.extend(b,{border:"2px dashed "+this.model.layerColor[c%this.model.layerColor.length],"border-radius":"6px"}),this.model.get("attr").to_frame==zeega.app.currentFrame.id&&!zeega.app.previewMode&&this.remove()}else this.delegateEvents({click:"goClick"});return $(this.el).html(this.getTemplate()).css(b).addClass("linked-layer"),this},events:{"click .go-to-sequence":"goToSequenceFrame","click .delete-link":"deleteLink","mousedown .show-controls":"showControls"},goClick:function(){zeega.app.player.goToSequenceFrame(this.model.get("attr").to_sequence,this.model.get("attr").to_frame)},goToSequenceFrame:function(){zeega.app.previewMode?zeega.app.player.goToSequenceFrame(this.model.get("attr").to_sequence,this.model.get("attr").to_frame):zeega.app.router.navigate("editor/sequence/"+this.model.get("attr").to_sequence+"/frame/"+this.model.get("attr").to_frame,{trigger:!0})},deleteLink:function(a){confirm("delete link?")&&(this.model.trigger("editor_removeLayerFromFrame",this.model),this.remove())},showControls:function(a){},onLayerEnter:function(){this.render(),this.delegateEvents();if(this.model.get("attr").from_frame==zeega.app.currentFrame.id){var a=this;this.delegateEvents(),this.$el.resizable({stop:function(b,c){a.model.update({width:$(this).width()/$(this).parent().width()*100,height:$(this).height()/$(this).parent().height()*100})}})}},onPlay:function(){this.render(),this.model.get("attr").to_frame==zeega.app.player.currentFrame.id&&this.moveOffStage(),this.delegateEvents({click:"goClick"})},getTemplate:function(){var a="";return this.preview||(a+='<i class="icon-remove delete-link"></i>'),!this.preview&&!_.isNull(this.model.get("attr").to_sequence)&&(a+='<i class="icon-share go-to-sequence"></i>'),a}})}(zeega.module("layer")),define("web/js/plugins/layers/link/link",function(){}),function(a){a.Rectangle=a.Model.extend({layerType:"Rectangle",defaultAttributes:{title:"Color Layer",url:null,backgroundColor:"#ff00ff",left:0,top:0,height:100,width:100,opacity:.75,linkable:!0}}),a.Views.Controls.Rectangle=a.Views.Controls.extend({render:function(){var b=new a.Views.Lib.ColorPicker({property:"backgroundColor",color:this.attr.backgroundColor,model:this.model,label:"Color"}),c=new a.Views.Lib.Slider({property:"width",model:this.model,label:"Width",suffix:"%",min:1,max:200}),d=new a.Views.Lib.Slider({property:"height",model:this.model,label:"Height",suffix:"%",min:1,max:200}),e=new a.Views.Lib.Slider({property:"opacity",model:this.model,label:"Opacity",step:.01,min:0,max:1});return this.controls.append(b.getControl()).append(e.getControl()).append(c.getControl()).append(d.getControl()),this}}),a.Views.Visual.Rectangle=a.Views.Visual.extend({render:function(){var a={backgroundColor:this.attr.backgroundColor,height:this.model.get("attr").height+"%"};return $(this.el).css(a),this.model.trigger("ready",this.model.id),this}})}(zeega.module("layer")),define("web/js/plugins/layers/rectangle/rectangle",function(){}),function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(c){function g(){!a&&this.init&&this.init.apply(this,arguments)}var d=this.prototype;a=!0;var e=new this;a=!1;for(var f in c)e[f]=typeof c[f]=="function"&&typeof d[f]=="function"&&b.test(c[f])?function(a,b){return function(){var c=this._super;this._super=d[a];var e=b.apply(this,arguments);return this._super=c,e}}(f,c[f]):c[f];return g.prototype=e,g.prototype.constructor=g,g.extend=arguments.callee,g}}();var Plyr2=Backbone.Model.extend({defaults:{id:0,uri:"http://www.youtube.com/watch?v=dQw4w9WgXcQ&ob=av3e",control_mode:"standard",autoplay:!0,cue_in:0,cue_out:150,volume:.5,video_target:null,controls_target:null},initialize:function(a){this.set(a),console.log(this),this.set("format",this.getFormat(this.get("url")))},getFormat:function(a){var b="";return a.match(/^http:\/\/(?:www\.)?youtube.com\/watch\?(?=.*v=\w+)(?:\S+)?$/)?b="youtube":a.match(/^http:\/\/(?:www\.)?vimeo.com\/(.*)/)?b="vimeo":b="html5",navigator.userAgent.split(" ")[navigator.userAgent.split(" ").length-1].split("/")[0]=="Firefox"&&b=="html5"&&(b="flashvideo"),b},placeVideo:function(a){if(!this.isVideoLoaded){var b=this;a.empty().prepend(this.getVideoView().el);switch(this.get("format")){case"html5":this.pop=Popcorn("#zvideo-"+this.id),this.pop.listen("canplay",function(){b.get("cue_in")!=0?(b.pop.listen("seeked",function(){b.trigger("video_canPlay")}),b.pop.currentTime(b.get("cue_in")),console.log("seeking to: "+b.get("cue_in"))):b.trigger("video_canPlay"),b.pop.volume(b.get("volume"))});break;case"flashvideo":this.pop=Popcorn.flashvideo("#zvideo-"+this.id,this.get("uri")),this.pop.listen("loadeddata",function(){b.pop.volume(b.get("volume")),b.trigger("video_canPlay"),b.pop.currentTime(b.get("cue_in"))});break;case"youtube":console.log(b.get("volume")),this.pop=Popcorn.youtube("#zvideo-"+this.id,this.get("url"),{volume:this.get("volume"),cue_in:this.get("cue_in")}),this.pop.listen("canplaythrough",function(){console.log(b.get("volume")),b.pop.play(),b.pop.pause(),b.pop.volume(b.get("volume")),console.log(b.get("control_mode")),b.trigger("video_canPlay")});break;case"vimeo":this.pop=Popcorn.vimeo("#zvideo-"+this.id,this.get("url")),this.pop.listen("loadeddata",function(){b.trigger("video_canPlay"),b.pop.currentTime(b.get("cue_in"))});break;default:console.log("none set")}this.pop.listen("timeupdate",function(){b.trigger("timeupdate"),b.trigger("timeupdate_controls")}),this.isVideoLoaded=!0}},getVideoView:function(){var a=Backbone.View.extend({className:"plyr-video",initialize:function(){this.render()},render:function(){return this.model.get("format")=="html5"&&(this.el=$('<video class="'+this.className+'">')),this.model.get("format")=="html5"?$(this.el).attr({id:"zvideo-"+this.model.id,src:this.model.get("uri")}):$(this.el).attr("id","zvideo-"+this.model.id),$(this.el).css("position","absolute"),this}});return new a({model:this})},destroy:function(){this.isVideoLoaded=!1,this.pop.pause(),Popcorn.destroy(this.pop)},currentTime:function(){return this.pop.currentTime()},play:function(){this.pop&&this.pop.paused()&&this.pop.play()},pause:function(){this.pop&&!this.pop.paused()&&this.pop.pause()}}),Plyr=Class.extend({init:function(a,b){this.id=a,this.url=b.url,this.format=b.format,this.wrapper=$("#"+this.id),this.seeking=!1,"controls"in b?this.controls=b.controls:this.controls=1,"controlsType"in b?this.controlsType=b.controlsType:this.controlsType="standard","controlsId"in b?this.controlsWrapper=$("#"+b.controlsId):this.controlsWrapper=this.wrapper,"cueIn"in b?this.cueIn=b.cueIn:this.cueIn=50,"cueOut"in b?this.cueOut=b.cueOut:this.cueOut=150,"volume"in b?this.volume=b.volume:this.volume=1,this.controls==1&&(this.controlsType=="standard"?this.controlsWrapper.append($("<div>").attr("id","plyr-standard").append($("<div>").addClass("plyr-controls-wrapper").addClass("plyr-controls-wrapper").append($("<div>").addClass("plyr-controls").append($("<div>").addClass("plyr-button-wrapper").append($("<div>").addClass("plyr-button").addClass("plyr-play"))).append($("<div>").addClass("plyr-time")).append($("<div>").addClass("plyr-timeline").append($("<div>").addClass("plyr-scrubber")))))):this.controlsType=="editor"&&this.controlsWrapper.append($("<div>").attr({id:"plyr-editor"}).append($("<div>").addClass("plyr-controls-wrapper").append($("<div>").addClass("plyr-time-wrapper").append($("<div>").addClass("plyr-cuein-time")).append($("<div>").addClass("plyr-cueout-time"))).append($("<div>").addClass("plyr-timeline-wrapper").append($("<div>").addClass("plyr-button-wrapper").append($("<div>").addClass("plyr-button").addClass("plyr-play"))).append($("<div>").addClass("plyr-timeline").append($("<div>").addClass("plyr-cuein-bar").addClass("plyr-bar")).append($("<div>").addClass("plyr-time-bar").addClass("plyr-bar")).append($("<div>").addClass("plyr-cueout-bar").addClass("plyr-bar")).append($("<div>").addClass("plyr-cuein-scrubber").addClass("plyr-edit-scrubber").append($("<div>").addClass("plyr-scrubber-select")).append($("<div>").addClass("plyr-arrow-down-green"))).append($("<div>").addClass("plyr-scrubber").addClass("plyr-edit-scrubber").append($("<div>").addClass("plyr-hanging-box"))).append($("<div>").addClass("plyr-cueout-scrubber").addClass("plyr-edit-scrubber").append($("<div>").addClass("plyr-scrubber-select")).append($("<div>").addClass("plyr-arrow-down"))))).append($("<div>").addClass("plyr-time-wrapper").append($("<span>").addClass("plyr-time"))).append($("<div>").attr({id:"plyr-volume"})))));var c=this;this.url.match(/^http:\/\/(?:www\.)?youtube.com\/watch\?(?=.*v=\w+)(?:\S+)?$/)?this.format="youtube":this.url.match(/^http:\/\/(?:www\.)?vimeo.com\/(.*)/)?this.format="vimeo":this.format="html5",navigator.userAgent.split(" ")[navigator.userAgent.split(" ").length-1].split("/")[0]=="Firefox"&&this.format=="html5"&&(this.format="flashvideo");var c=this;this.displayControls=function(){this.cueOut==0&&(c.cueOut=c.pop.duration()),c.controlsWrapper.find(".plyr-cuein-scrubber").css({left:parseFloat(this.cueIn)*c.controlsWrapper.find(".plyr-timeline").width()/c.pop.duration()}),c.controlsWrapper.find(".plyr-cuein-bar").css({width:c.controlsWrapper.find(".plyr-cuein-scrubber").css("left")}),c.controlsWrapper.find(".plyr-cueout-scrubber").css({left:parseFloat(this.cueOut)*c.controlsWrapper.find(".plyr-timeline").width()/c.pop.duration()}),c.controlsWrapper.find(".plyr-cueout-bar").css({width:parseInt(c.controlsWrapper.find(".plyr-timeline").width())-parseInt(c.controlsWrapper.find(".plyr-cueout-scrubber").css("left"))}),c.controlsWrapper.find(".plyr-cuein-time").html(convertTime(c.cueIn,!0)),c.controlsWrapper.find(".plyr-cueout-time").html(convertTime(c.cueOut,!0)),c.controlsWrapper.find(".plyr-controls-wrapper").fadeIn()};switch(this.format){case"html5":this.wrapper.prepend($("<video>").addClass("plyr-video").attr({src:this.url,id:"z-"+this.id})),this.pop=Popcorn("#z-"+this.id),this.pop.listen("canplay",function(){c.controls==1&&c.displayControls()});break;case"flashvideo":this.wrapper.prepend($("<div>").addClass("plyr-video").attr({id:"z-"+this.id})),this.pop=Popcorn.flashvideo("#z-"+this.id,this.url),this.pop.listen("loadeddata",function(){c.controls==1&&c.displayControls()});break;case"youtube":this.wrapper.prepend($("<div>").addClass("plyr-video").attr({id:"z-"+this.id})),this.pop=Popcorn.youtube("#z-"+this.id,this.url),this.pop.listen("canplaythrough",function(){c.pop.play(),c.pop.pause(),c.controls==1&&c.displayControls()});break;case"vimeo":this.wrapper.prepend($("<div>").addClass("plyr-video").attr({id:"z-"+this.id})),this.pop=Popcorn.vimeo("#z-"+this.id,this.url),this.pop.listen("loadeddata",function(){c.controls==1&&c.displayControls()});break;default:console.log("none set")}this.controlsWrapper.find(".plyr-button").click(function(){c.pop.volume(parseInt(c.volume)),c.pop.paused()?c.pop.play():c.pop.pause()}),this.controlsType=="standard"?this.controlsWrapper.find(".plyr-scrubber").draggable({axis:"x",containment:"parent",stop:function(a,b){var d=Math.floor(parseFloat(c.controlsWrapper.find(".plyr-scrubber").css("left"))*c.pop.duration()/parseFloat(c.controlsWrapper.find(".plyr-timeline").width()));c.pop.trigger("timeupdate"),c.pop.currentTime(d)},start:function(){c.pop.pause()},drag:function(a,b){var d=Math.floor(parseFloat(b.position.left)*c.pop.duration()/parseFloat(c.controlsWrapper.find(".plyr-timeline").width()));c.controlsWrapper.find(".plyr-time").html(convertTime(d)+" / "+convertTime(c.pop.duration()))}}):this.controlsType=="editor"&&(this.controlsWrapper.find(".plyr-scrubber").draggable({axis:"x",containment:"parent",stop:function(a,b){var d=Math.floor(parseFloat(c.controlsWrapper.find(".plyr-scrubber").css("left"))*c.pop.duration()/parseFloat(c.controlsWrapper.find(".plyr-timeline").width()));d<c.cueIn?d=c.cueIn:d>c.cueOut&&(d=Math.max(parseFloat(c.cueIn),parseFloat(c.cueOut)-5)),c.pop.trigger("timeupdate"),c.pop.currentTime(d)},start:function(){c.pop.pause()},drag:function(a,b){var d=Math.floor(parseFloat(b.position.left)*c.pop.duration()/parseFloat(c.controlsWrapper.find(".plyr-timeline").width()));c.controlsWrapper.find(".plyr-time").html(convertTime(d)+" / "+convertTime(c.pop.duration()))}}),this.controlsWrapper.find(".plyr-cuein-scrubber").draggable({axis:"x",containment:"parent",stop:function(a,b){c.controlsWrapper.find(".plyr-cuein-bar").css({width:c.controlsWrapper.find(".plyr-cuein-scrubber").css("left")}),c.pop.currentTime(Math.floor(parseFloat(b.position.left)*c.pop.duration()/parseFloat(c.controlsWrapper.find(".plyr-timeline").width())));var d=parseFloat(c.pop.currentTime())/parseFloat(c.pop.duration())*100;c.controlsWrapper.find(".plyr-scrubber").css({left:d+"%"}),c.controlsWrapper.find(".plyr-time").html(convertTime(c.pop.currentTime())+" / "+convertTime(c.pop.duration())),c.controlsWrapper.find(".plyr-time-bar").css({width:d+"%"})},drag:function(a,b){c.cueIn=Math.floor(parseFloat(b.position.left)*c.pop.duration()/parseFloat(c.controlsWrapper.find(".plyr-timeline").width())),c.controlsWrapper.find(".plyr-cuein-time").html(convertTime(c.cueIn,!0))}}),this.controlsWrapper.find(".plyr-cueout-scrubber").draggable({axis:"x",containment:"parent",stop:function(a,b){c.controlsWrapper.find(".plyr-cueout-bar").css({width:parseInt(c.controlsWrapper.find(".plyr-timeline").width())-parseInt(c.controlsWrapper.find(".plyr-cueout-scrubber").css("left"))}),c.pop.currentTime(Math.max(parseFloat(c.cueIn),parseFloat(c.cueOut)-5))},start:function(){c.pop.pause()},drag:function(a,b){c.cueOut=Math.floor(parseFloat(b.position.left)*c.pop.duration()/parseFloat(c.controlsWrapper.find(".plyr-timeline").width())),c.controlsWrapper.find(".plyr-cueout-time").html(convertTime(c.cueOut,!0))}})),this.controlsWrapper.find("#plyr-volume").slider({min:0,max:1,value:c.volume,step:.1,slide:function(a,b){c.volume=b.value,c.pop.volume(c.volume)},stop:function(a,b){}}),this.pop.listen("loadedmetadata",function(){c.controlsWrapper.find(".plyr-time").html(convertTime(c.pop.currentTime())+" / "+convertTime(c.pop.duration()))}),this.pop.listen("timeupdate",function(){c.pop.currentTime()>c.cueOut&&(c.pop.pause(),c.pop.currentTime(c.cueIn));var a=parseFloat(c.pop.currentTime())/parseFloat(c.pop.duration())*100;c.controlsWrapper.find(".plyr-scrubber").css({left:a+"%"}),c.controlsWrapper.find(".plyr-time").html(convertTime(c.pop.currentTime())+" / "+convertTime(c.pop.duration())),c.controlsWrapper.find(".plyr-time-bar").css({width:a+"%"})}),this.pop.listen("pause",function(){c.controlsWrapper.find(".plyr-button").removeClass("plyr-pause").addClass("plyr-play")}),this.pop.listen("play",function(){c.controlsWrapper.find(".plyr-button").removeClass("plyr-play").addClass("plyr-pause")}),this.pop.listen("seeking",function(){}),this.pop.listen("seeked",function(){}),this.pop.listen("ended",function(){this.currentTime(0)}),this.pop.listen("loadeddata",function(){})},destroy:function(){Popcorn.destroy(this.pop)}});define("web/js/plugins/players/plyr",function(){}),require.config({baseUrl:sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"js/.js",paths:{order:sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"js/lib/order.js",text:sessionStorage.getItem("hostname")+sessionStorage.getItem("directory")+"js/lib/text"}}),require(["web/js/lib/underscore","web/js/lib/backbone","web/js/lib/leaflet/leaflet","web/js/app/zeega.project-viewer","web/js/app/zeega.player","web/js/helpers/zeega.helpers","web/js/helpers/zeega.extends","web/js/lib/spin","web/js/lib/jquery/plugins/spin","web/js/lib/popcorn_flash","web/js/app/views/editor.layer/editor.view.layer.layer-list","web/js/app/views/editor.layer/editor.view.layer.visual-editor","web/js/app/models/editor.model.layer","web/js/plugins/layers/video/video","web/js/plugins/layers/audio/audio","web/js/plugins/layers/geo/geo","web/js/plugins/layers/image/image","web/js/plugins/layers/mapbox/mapbox","web/js/plugins/layers/text/text","web/js/plugins/layers/googlebook/googlebook","web/js/plugins/layers/link/link","web/js/plugins/layers/rectangle/rectangle","web/js/plugins/players/plyr"],function(a){zeega.app.init();var b=window.location.hash.substr(15);console.log(b)}),define("web/js/loaders/standalone-player_min.js",function(){})